{"version":3,"sources":["Game/AbstractPlayer.ts","Game/constants.ts","Utils/Rng.ts","Game/GameRules.ts","Entities/Ordnance.ts","Entities/WorldObjects/Bases/AbstractMilitaryBase.ts","Data/AbmBaseNames.ts","Entities/WorldObjects/Bases/AbmBase.ts","Data/RadarBaseNames.ts","Entities/WorldObjects/Bases/RadarBase.ts","Data/MissileBaseNames.ts","Entities/WorldObjects/Bases/MissileBase.ts","Data/AirBaseNames.ts","Entities/WorldObjects/Bases/AirBase.ts","Data/ArmyBaseNames.ts","Entities/WorldObjects/Bases/ArmyBase.ts","Data/NavyBaseNames.ts","Entities/WorldObjects/Bases/NavyBase.ts","Factories/MilitaryBaseFactory.ts","Utils/MapUtils.ts","Game/GameLogic.ts","Entities/WorldObjects/PopulationCenters/AbstractPopulationArea.ts","Entities/WorldObjects/PopulationCenters/City.ts","Entities/WorldObjects/PopulationCenters/Rural.ts","Entities/WorldObjects/PopulationCenters/MajorTown.ts","Factories/PopulationAreaFactory.ts","Entities/MapObjects/MapLocation.ts","Entities/MapObjects/AbstractMapLocation.ts","Entities/WorldObjects/CountryMap.ts","Game/ComputerPlayer.ts","Game/HumanPlayer.ts","Data/ComputerNames.ts","Entities/gameEntity.ts","Components/TickerComponent.tsx","Components/GameHeaderComponent.tsx","Components/GameButton.tsx","Components/BuildManifestComponent.tsx","Components/MilitaryBaseComponents/AbmBaseComponent.tsx","Components/MilitaryBaseComponents/RadarBaseComponent.tsx","Components/OrdnanceTargetingComponent.tsx","Components/MilitaryBaseComponents/NavyBaseComponent.tsx","Components/MilitaryBaseComponents/MissileBaseComponent.tsx","Components/MilitaryBaseComponents/AirBaseComponent.tsx","Components/MilitaryBaseComponents/ArmyBaseComponent.tsx","Components/BaseActivatorComponent.tsx","Components/UserActionsComponent.tsx","Components/GameLogComponent.tsx","Components/MapComponents/MapItemComponent.tsx","Components/MapComponents/MapSummaryComponent.tsx","Components/MapComponents/MapItemHoverComponent.tsx","Components/MapComponents/MapComponent.tsx","Game/BuildVersion.ts","Components/Game.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["AbstractPlayer","args","Object","classCallCheck","this","isHuman","allTargetedOrdnanceItems","ordnanceItemsArrivingThisTick","Constants","GAME_VERSION","NOTIFY_BUILD_RESULT_CALLBACK_NAME","NOTIFY_TARGET_RESULT_CALLBACK_NAME","MIN_INITIAL_FIGHTERS","MAX_INITIAL_FIGHTERS","MIN_INITIAL_BOMBERS","MAX_INITIAL_BOMBERS","MIN_ICBMS","MAX_ICBMS","MIN_SUB_MISSILES","MAX_SUB_MISSILES","BUILD_DROP","TARGET_MISSILE_DROP","FIRST_STRIKE_POPULATION_HIT_PCT","SECOND_STRIKE_POPULATION_HIT_PCT","THIRD_STRIKE_POPULATION_HIT_PCT","PCT_VISIBLE_SENTIMENT_THRESHOLD","EXPECTED_BASE_COUNT_FACTOR","DROPTYPE","BASETYPE","MANIFESTINDEX","ARMY_BASELABEL","NAVY_BASELABEL","MISSILE_BASELABEL","ABM_BASELABEL","AIR_BASELABEL","MIN_INITIAL_CITIES","MAX_INITIAL_CITIES","Rng","createClass","key","value","Math","floor","random","hiNumberMinus1","sourceArray","length","throwDice","GameRules","atLocation","Contents","WorldObjectLabel","rNbr","basedOnStrategicChoice","popStrikePctLookup","popKilled","onMapLocation","Population","nuclearStrikes","round","peacetimeStrategicOptions","warTimeMoveOptions","pre1962TacticalOptions","post1962TacticalOptions","concat","warTimeTacticalOptions","game","Game","getInstance","currentPeacetimeTacticalOptions","gameYear","isPeacetime","strategicOptions","tacticalOptions","strikeCount","locationAttacked","populationKilled","getNuclearStrikePopulationKilled","attackingOrdnance","attackedBy","GameStartYear","Ordnance","myTarget","remainingTicksBeforeStriking","wasConsumed","myID","nextOrdnanceID","myBase","parentBase","wasIntercepted","myWorldLabel","AbstractMilitaryBase","Name","wasDestroyed","isReceivingOrders","myMapLocation","yearBuilt","AbmBaseNames","availableAbmBaseNames","getNameResult","GameLogic","getNameForNameableItem","fromNamesArr","allOtherNames","baseName","genericBaseCounter","AbmBase","_AbstractMilitaryBase","_this","possibleConstructorReturn","getPrototypeOf","call","getAbmBaseName","totalMissiles","isTracking","inherits","RadarBaseNames","getNameReslt","availableRadarBaseNames","RadarBase","modeOfOperation","getRadarBaseName","console","log","mode","MissileBaseNames","availableMissileBaseNames","MissileBase","public","getMissileBaseName","ordnance","some","m","activateMissileBase","forBase","AirBaseNames","availableAirBaseNames","AirBase","getAirBaseName","totalFighters","isFlying","activateAirBase","b","ArmyBaseNames","availableArmyBaseNames","ArmyBase","getArmyBaseName","isDecamped","NavyBaseNames","availableNavyBaseNames","gericBaseCounter","NavyBase","getNavyBaseName","activateNavyBase","MilitaryBaseFactory","msh","nextBaseID","newBaseProperties","baseType","instance","MapUtil","forMapLocation","i","map","j","xformFunc","summary","getMapSummary","forMap","allAbmBases","allAirBases","allArmyBases","allMissileBases","allNavyBases","allRadarBases","ttlTtO","base","filter","o","allTO","mu","addLocationToSummary","mapLoc","addToSummary","isAbmBase","totalAbmMissilesOnLine","isRadarBase","totalPassiveRadarStationsOnLine","loc","totalActiveRadarStationsOnLine","isActiveRader","isArmyBase","isAirBase","totalBombersInFlight","totalFightersOnPatrol","isMissileBase","totalICBMsOnLine","isNavyBase","totalSubMissilesOnLine","targetedMapLocations","isTargeted","totalPopulation","allIn","reduce","runningSummary","currentMapRow","s1","s2","prev","curr","initialSummary","runningPop","uniqueID","mLoc","onMap","createNewBase","rLoc","r","rLoc2","r2","bLoc","nLoc","n","aLoc","a","abmLoc","abm","placeItem","itemToPlace","isWO","l","which","gameStateWatchers","watcher","forEach","gsw","handleGamestateChange","details","notifyGamestateChange","changeLabel","miscDetails","currentPlayer","computerPlayer","playTurn","humanPlayer","relatedBase","targetingOrdnance","atMapLocation","getMissileArrivalTicks","attackingPlayer","relatedLocation","totalICBMs","forBaseType","totalBombers","isSleeping","setInterval","setTimeout","pulseClock","isWartime","resolveWartimeAttacks","tryAbmDefense","tryIntercept","defender","didShootDownOrdnance","nuclearOrdnance","abmBaseIndex","availableABMBases","defendingPlayer","getAllABMBases","tryAttack","ao","locationUnderAttack","getNextReadyOrdnance","foundAttackingOrdnance","ticks","defendingPlayerMapSummary","tryICBMAttack","tryBomberAttack","error","trySubmarineAttack","getLocationDamage","getUpdatedOrdnanceArrivalTicksForPlayer","p","objectSpread","hasOrdnanceStrikingThisTick","forPlayer","resolveAttacksOnPlayer","defendersMap","allTargetedLocations","locationsUnderAttackThisTick","aTargetedLocation","oiatt","attackedLocation","result","damageLocation","location","damage","myMap","owningPlayer","totalCausualties","isMilitaryBase","militaryBase","toLocaleString","isLiveOrdnance","forOrdnance","playerA","playerB","ato","declaringPlayer","declaredWar","playComputerTurn","turn","year","targetPlayer","allMilitaryBases","baseConcealmentFactor","baseSpyFactor","spyLevel","spyAmount","enemyVisibility","ceil","tryFindBase","pickRandomFromArray","selectedNameIdx","idx","AbstractPopulationArea","City","_AbstractPopulationAr","name","population","RuralArea","MajorTown","PopulationAreaFactory","nextPopulationAreaID","forPopulationArea","popAreaType","MapLocation","_AbstractMapLocation","nextID","_this2","ml","AbstractMapLocation","CountryMap","newRuralArea","createNewPopulationArea","newCity","sizeX","sizeY","owner","ownerLabel","initializeMap","table","x","push","y","mi","citiesToPlace","tryX","tryY","bases","mapRow","mapCell","baseLocationsInRow","apply","getAllMilitaryBases","ComputerPlayer","_AbstractPlayer","registerGamestateWatcher","assertThisInitialized","totalFunctionalActiveRadarStations","totalFunctionalPassiveRadarStations","createTestBases","sentimentMap","Map","set","percentBuildStart","percentSpyStart","percentDeclareWarStart","playPeacefulTurn","advanceTurn","playWarTurn","testGuard","radarTest","missileTest","airBaseTest","navyBaseTest","armyBaseTest","abmBaseTest","myMapSummary","abmbase1","activateAbmBase","armybase1","activateArmyBase","missile1","missile","handleMissileTargeted","getRandomLocation","fromMap","_this3","navyBase","_this4","airBase","radar1","setModeOfOperation","activateRadarBase","radar2","suspectedBasesCount","expectedBaseCount","sentiment","suspected","getAllowedMoves","calculateCurrentSentiment","sentimentTable","get","tablelookupVal","strategicChoice","spyOnPlayer","buildBases","numberToBuild","allowedBases","toBuild","logDetailedMapToConsole","randX","randY","HumanPlayer","GameData","allComputerNames","_AbstractGameEntity","getRandomComputerPlayerName","startClock","initializeGame","AbstractGameEntity","TickerComponent","_Component","props","state","forHtmLID","msgTextElem","document","getElementById","innerHTML","intervalHandler","tickerMessage","substring","tickerInterval","clearInterval","onRenderCompleteCallback","htmlID","nextHtmlID","showMessage","react_default","createElement","id","Component","GameHeaderComponent","yearMessage","forceUpdate","className","TickerComponent_TickerComponent","UIComponent","GameButton","withStyles","root","borderRadius","border","color","height","padding","boxShadow","label","textTransform","Button","BuildManifestComponent","uiIdx","uiKey","emptyManifestSelection","buildWhat","buildWhere","didBuild","buildResultText","buildManifest","setState","Array","totalAllowedToBuild","fill","manifestIndex","newBuildManfest","didSucceed","message","updatedManifest","allowedBaseMarkup","allowedBasesToBuild","allowedBase","draggable","onDragStart","e","dragEvent","ab","dataTransfer","setData","toString","window","handleDropResult","bind","dragStartMarkup","forManifestIndex","onDragEnd","individualAllowedBaseMarkup","title","baseTokenSrc","src","width","individualManifestChoiceMarkup","selection","Fragment","GameButton_UIComponent","onClick","finishHumanTurn","AbmBaseComponent","readyToActivateMarkup","isTrackingMarkup","isNotReceivingOrdersMarkup","wrapper","toWrap","wasDestroyedMarkup","RadarBaseComponent","didActivate","setMode","handleRaderPulser","isActivatedMarkup","mapLocElement","getMapLocationHtmlID","pulseUp","pulseDown","classList","remove","add","OrdnanceTargetingComponent","_React$Component","nextUIKey","ordnanceLabel","toTargetMarkup","missileIndex","forMissileIndex","consumedMarkup","targetedMarkup","currentPlayerType","targetedLocation","isAllOrdnanceTargeted","targetingCompleteCallback","React","NavyBaseComponent","isTargetingMissiles","isTargetingMarkup","OrdnanceTargetingComponent_OrdnanceTargetingComponent","allTargetedMarkup","MissileBaseComponent","AirBaseComponent","isTargetingBombers","isFlyingMarkup","ArmyBaseComponent","decampArmy","isDecampedMarkup","BaseActivatorComponent","uiKeyNbr","getBaseUI","AbmBaseComponent_AbmBaseComponent","ArmyBaseComponent_ArmyBaseComponent","AirBaseComponent_AirBaseComponent","MissileBaseComponent_MissileBaseComponent","NavyBaseComponent_NavyBaseComponent","RadarBaseComponent_RadarBaseComponent","isWaitingForSelection","activeBases","inactiveBases","destroyedBases","destroyedBases1","baseEntity","destroyedBases2","ib","activate","handleBaseActivatedAnimation","slice","registerForHumanPlayerMapClicks","ui","initializedBases","player","activeBase","inactiveBase","destroyedBase","UserActionsComponent","baseActivatorComponent","actionHandlers","actionHandler","handleFinishTurn","playerChoice","handleBuild","handleDeclareWar","handleActivate","handleSpy","notYetImplemented","isSelectingLocation","isMakingStrategicChoice","isMakingTacticalChoice","isBuilding","tacticalChoice","isWaitingForMyTurn","isActivating","handlePlayerMapClick","registerMapListener","forUserComponent","setInitialState","getMoveChoiceLabels","c","getChoiceButtonMarkup","forChoice","BuildManifestComponent_BuildManifestComponent","getTotalBasesAllowedToBuild","BaseActivatorComponent_BaseActivatorComponent","ah","err","msg","declareWar","GameLogComponent","nextUIKeyVal","queuedMessages","oldMessages","currentMessage","ignoreChangeLabels","shift","gsc","baseLabel","msgStart","igcl","loggableMessageFromGameStateChange","onTickerCompleted","MapItemComponent","mapItem","GetMapLocationSingleCharacterCode","nuclearDamageIndicator","MapSummaryComponent","summarizedMap","mapToSummarize","dashes","playerName","substr","playerNameMarkup","dist_default","format","duration","MapItemHoverComponent","handleMapLocationHover","hoverMapLocation","registerHoverListener","hoverListener","MapComponent","notifyMapLocationHoveredOver","MapSummaryComponent_MapSummaryComponent","countryMap","row","cell","onMouseOver","playerMapClickListener","onDrop","preventDefault","handleDrop","dropEvent","onDragLeave","handleLocationDragEvent","doLoc","eventType","onDragOver","MapItemComponent_MapItemComponent","MapItemHoverComponent_MapItemHoverComponent","handleLocationTargeted","handleBaseActivated","nukedLocation","handleLocationNuked","handleLocationDetargeted","detargetedLocation","event","getData","dropType","handleBuildDrop","handleTargetDrop","notifyDragResultCallack","parseInt","canPlaceItemAtMapLocation","itemToCheck","newBase","notifyNewBaseConstructed","BuildVersion","BUILD_VERSION","GameComponent","_getPrototypeOf2","_len","arguments","_key","userActionsComponent","startGame","gameEntity","index_es","container","alignContent","item","xs","GameHeaderComponent_GameHeaderComponent","MapComponent_MapComponent","UserActionsComponent_UserActionsComponent","mapClickListener","GameLogComponent_GameLogComponent","href","target","App","justify","Game_GameComponent","Boolean","hostname","match","ReactDOM","render","src_App_0","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.d6d456ff.chunk.js","sourcesContent":["import { CountryMap } from \"../Entities/WorldObjects/CountryMap\";\r\nimport { Ordnance } from \"../Entities/Ordnance\";\r\n\r\nexport abstract class AbstractPlayer {\r\n\r\n    abstract Name: string;\r\n    abstract map: CountryMap;\r\n    abstract declaredWar: boolean;\r\n    \r\n    abstract totalFunctionalPassiveRadarStations: number;\r\n    abstract totalFunctionalActiveRadarStations: number;\r\n    \r\n    abstract totalCausualties: number;\r\n\r\n    public allTargetedOrdnanceItems: Ordnance[];\r\n    public ordnanceItemsArrivingThisTick: Ordnance[];\r\n\r\n    public isHuman: boolean;\r\n\r\n    constructor(args: {isHuman: boolean}) {\r\n        this.isHuman = args.isHuman;\r\n        this.allTargetedOrdnanceItems = [];\r\n        this.ordnanceItemsArrivingThisTick = []; // these are arriving this tick\r\n    }\r\n}","export class Constants {\r\n\r\n    public static readonly GAME_VERSION = 0.1;\r\n    \r\n    public static readonly NOTIFY_BUILD_RESULT_CALLBACK_NAME = \"rpsn_notifyBuildDragResult\";\r\n    public static readonly NOTIFY_TARGET_RESULT_CALLBACK_NAME = \"rpsn_notifyTargetResult\";\r\n\r\n    public static readonly MIN_INITIAL_FIGHTERS = 1;\r\n    public static readonly MAX_INITIAL_FIGHTERS = 4;\r\n    public static readonly MIN_INITIAL_BOMBERS = 1;\r\n    public static readonly MAX_INITIAL_BOMBERS = 4;\r\n\r\n    public static readonly MIN_ICBMS = 1;\r\n    public static readonly MAX_ICBMS = 4;\r\n\r\n    public static readonly MIN_SUB_MISSILES = 1;\r\n    public static readonly MAX_SUB_MISSILES = 3;\r\n\r\n    public static readonly BUILD_DROP = \"build\";\r\n    public static readonly TARGET_MISSILE_DROP = \"target\";\r\n\r\n    // The theory is that first strike is devastating, second strike less so and by 3rd strike, survivors are spread out and more likely to survive\r\n    public static readonly FIRST_STRIKE_POPULATION_HIT_PCT = 0.90;\r\n    public static readonly SECOND_STRIKE_POPULATION_HIT_PCT = 0.50;\r\n    public static readonly THIRD_STRIKE_POPULATION_HIT_PCT = 0.25;\r\n\r\n    public static readonly PCT_VISIBLE_SENTIMENT_THRESHOLD = 20;\r\n    public static readonly EXPECTED_BASE_COUNT_FACTOR = 1.75;\r\n\r\n    // Supporting drag and drop on the screen.\r\n    public static readonly DROPTYPE = \"dropType\";\r\n    public static readonly BASETYPE = \"baseType\";\r\n    public static readonly MANIFESTINDEX = \"manifestIndex\";\r\n\r\n    // Base labels\r\n    public static readonly ARMY_BASELABEL = \"Army\";\r\n    public static readonly NAVY_BASELABEL = \"Navy\";\r\n    public static readonly MISSILE_BASELABEL = \"Missile\";\r\n    public static readonly ABM_BASELABEL = \"Abm\";\r\n    public static readonly AIR_BASELABEL = \"Air\";\r\n\r\n    public static readonly MIN_INITIAL_CITIES = 5;\r\n    public static readonly MAX_INITIAL_CITIES = 8;\r\n}\r\n\r\n","\r\nexport class Rng {\r\n\r\n    public static throwDice(args: {hiNumberMinus1: number}) {\r\n\r\n        //Math.floor(Math.random() * 10);     // returns a random integer from 0 to 9\r\n\r\n        return Math.floor(Math.random() * args.hiNumberMinus1);     \r\n\r\n    }\r\n\r\n    public static pickRandomFromArray(args: {sourceArray: any[]}) {\r\n\r\n        if (! args.sourceArray) throw \"Rng.ts: pickRandomFromArray: error, source array is null or undefined.\";\r\n        if (args.sourceArray.length === 0) throw \"Rng.ts: pickRandomFromArray: error, source array is empty.\";\r\n\r\n\r\n        return (args.sourceArray[this.throwDice({hiNumberMinus1: args.sourceArray.length})]);\r\n        \r\n    }\r\n}","import { Game } from \"../Entities/gameEntity\";\r\nimport { CountryMap } from \"../Entities/WorldObjects/CountryMap\";\r\nimport { MapLocation } from \"../Entities/MapObjects/MapLocation\";\r\nimport { PlaceableObjectLabels } from \"../Entities/MapObjects/PlaceableObjects\";\r\nimport { MilitaryBaseTypeLabels } from \"../Entities/WorldObjects/Bases/MilitaryBaseTypes\";\r\nimport { Ordnance } from \"../Entities/Ordnance\";\r\nimport { Constants } from \"./constants\";\r\nimport { Rng } from \"../Utils/Rng\";\r\n\r\nexport type strategicMoveOptions = \"Build\" | \"Spy\" | \"Declare War\" | \"Skip\" | \"Activate\" | \"Sue for Peace\" | \"Surrender\";\r\nexport type tacticalMoveOptions = MilitaryBaseTypeLabels | \"Activate Base\";\r\n\r\nexport interface allowedMoves {\r\n    strategicOptions: strategicMoveOptions[];\r\n    tacticalOptions: tacticalMoveOptions[];\r\n}\r\n\r\nexport interface nuclearStrikeDamage {\r\n    populationKilled: number;\r\n    strikeCount: number; // max of 3\r\n    attackingOrdnance: Ordnance;\r\n}\r\n\r\nexport class GameRules {\r\n\r\n    public static readonly GameStartYear = 1945;\r\n\r\n    public static canPlaceItemAtMapLocation(args: { map: CountryMap, atLocation: MapLocation, itemToCheck: PlaceableObjectLabels }): boolean {\r\n\r\n        if (args.atLocation.Contents) {\r\n            return args.atLocation.Contents.WorldObjectLabel === \"Rural\";\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    public static getMissileArrivalTicks() {\r\n        const rNbr = Rng.throwDice({hiNumberMinus1: 99});\r\n        if (rNbr < 33) return 1;\r\n        if (rNbr < 85) return 2;\r\n        return 3;\r\n    }\r\n\r\n    public static getTotalBasesAllowedToBuild(args: { basedOnStrategicChoice: strategicMoveOptions | null }): number {\r\n\r\n        if (args.basedOnStrategicChoice === \"Build\") return 2;\r\n        if (args.basedOnStrategicChoice === \"Spy\") return 1;\r\n\r\n        return 0;\r\n    }\r\n\r\n    public static getNuclearStrikePopulationKilled(args: { onMapLocation: MapLocation }): number {\r\n\r\n        const popStrikePctLookup: number[] = [Constants.FIRST_STRIKE_POPULATION_HIT_PCT, Constants.SECOND_STRIKE_POPULATION_HIT_PCT, Constants.THIRD_STRIKE_POPULATION_HIT_PCT];\r\n        const popKilled = args.onMapLocation.Contents ? args.onMapLocation.Contents.Population * popStrikePctLookup[args.onMapLocation.nuclearStrikes -1] : 0;\r\n\r\n        return Math.round(popKilled);\r\n    }\r\n\r\n    public static getAllowedMoves(): allowedMoves {\r\n\r\n        const peacetimeStrategicOptions: strategicMoveOptions[] = [\"Build\", \"Spy\", \"Declare War\", \"Skip\"];\r\n        const warTimeMoveOptions: strategicMoveOptions[] = [\"Activate\", \"Sue for Peace\", \"Surrender\"];\r\n        const pre1962TacticalOptions: tacticalMoveOptions[] = [\"Army\", \"Navy\", \"Air\", \"Missile\", \"Radar\", \"ABM\"];\r\n        const post1962TacticalOptions: tacticalMoveOptions[] = pre1962TacticalOptions.concat(\"ABM\");\r\n        const warTimeTacticalOptions: tacticalMoveOptions[] = [\"Activate Base\"];\r\n\r\n        const game = Game.getInstance();\r\n\r\n        const currentPeacetimeTacticalOptions = game.gameYear > 1962 ? post1962TacticalOptions : pre1962TacticalOptions;\r\n\r\n        const getPeaceTimeOptions = (): allowedMoves => (\r\n            {\r\n                strategicOptions: peacetimeStrategicOptions,\r\n                tacticalOptions: currentPeacetimeTacticalOptions\r\n            });\r\n\r\n        const getWartimeOptions = (): allowedMoves => (\r\n            {\r\n                strategicOptions: warTimeMoveOptions,\r\n                tacticalOptions: warTimeTacticalOptions\r\n            });\r\n\r\n        const result = game.isPeacetime ? getPeaceTimeOptions() : getWartimeOptions();\r\n\r\n        return result;\r\n\r\n    }\r\n\r\n    public static getLocationDamage(args: { attackedBy: Ordnance, locationAttacked: MapLocation }): nuclearStrikeDamage {\r\n\r\n        const result: nuclearStrikeDamage = {\r\n            strikeCount: args.locationAttacked.nuclearStrikes < 3 ? args.locationAttacked.nuclearStrikes += 1 : 3,\r\n            populationKilled: this.getNuclearStrikePopulationKilled({onMapLocation: args.locationAttacked}),\r\n            attackingOrdnance: args.attackedBy\r\n        }\r\n\r\n        return result;\r\n\r\n    }\r\n}","import { MapLocation } from \"./MapObjects/MapLocation\";\r\nimport { OrdnanceCarryingBase } from \"./WorldObjects/Bases/AbstractMilitaryBase\";\r\n\r\nexport type OrdnanceTypeLabels = \"ICBM\" | \"Submarine Missile\" | \"Bomber\";\r\n\r\nexport class Ordnance {\r\n\r\n    public myTarget: MapLocation | null;\r\n\r\n    public remainingTicksBeforeStriking: number;\r\n    public wasConsumed: boolean; \r\n    public static nextOrdnanceID: number = 0;\r\n    public myID: number;\r\n    public myBase: OrdnanceCarryingBase;\r\n    public myWorldLabel: OrdnanceTypeLabels;\r\n    public wasIntercepted: boolean;\r\n\r\n    constructor(args: {parentBase: OrdnanceCarryingBase}) {\r\n\r\n        this.myTarget = null;\r\n        this.remainingTicksBeforeStriking = 0;\r\n        this.wasConsumed = false;\r\n        this.myID = Ordnance.nextOrdnanceID++;\r\n        this.myBase = args.parentBase;\r\n        this.wasIntercepted = false;\r\n        \r\n        if (args.parentBase.WorldObjectLabel === \"Missile\") {\r\n            this.myWorldLabel = \"ICBM\";\r\n        }\r\n        else if (args.parentBase.WorldObjectLabel === \"Navy\") {\r\n            this.myWorldLabel = \"Submarine Missile\";\r\n        }\r\n        else {\r\n            this.myWorldLabel = \"Bomber\";\r\n        }\r\n    }\r\n}","\r\nimport { MilitaryBaseTypeLabels } from \"./MilitaryBaseTypes\";\r\nimport { Ordnance } from \"../../Ordnance\";\r\nimport { MapLocation } from \"../../MapObjects/MapLocation\";\r\nimport { Rng } from \"../../../Utils/Rng\";\r\n\r\nexport interface MilitaryBaseProperties {\r\n    Name: string;\r\n    WorldObjectLabel: MilitaryBaseTypeLabels;\r\n    isReceivingOrders: boolean;\r\n    myMapLocation: MapLocation;\r\n    yearBuilt: number;\r\n\r\n}\r\n\r\nexport interface MilitaryBaseActions {\r\n    activate: () => void;\r\n}\r\n\r\nexport interface OrdnanceCarryingBase {\r\n    ordnance: Ordnance[];\r\n    WorldObjectLabel: MilitaryBaseTypeLabels;\r\n}\r\n\r\nexport abstract class AbstractMilitaryBase implements MilitaryBaseProperties, MilitaryBaseActions\r\n{\r\n\r\n    public Name: string = \"\";\r\n    public isReceivingOrders: boolean;\r\n    public myMapLocation: MapLocation;\r\n    public Population: number = Rng.throwDice({hiNumberMinus1: 10000}) + 10000;\r\n    public wasDestroyed: boolean = false;\r\n    public yearBuilt: number;\r\n\r\n\r\n    // Having a \"BaseType\" label here helps some code work a little more generically since \"typeof [any base object]\" returns \"object\"\r\n    // This gives us a shot at treating bases a little more generically. Look at MilitaryBaseFactory.ts for an example.\r\n    public abstract WorldObjectLabel: MilitaryBaseTypeLabels;\r\n\r\n    public activate() {\r\n        this.isReceivingOrders = true;\r\n    };\r\n\r\n    constructor(args: {atLocation: MapLocation, yearBuilt: number}) {\r\n        this.isReceivingOrders = false;\r\n        this.myMapLocation = args.atLocation;\r\n        this.yearBuilt = args.yearBuilt;\r\n    }\r\n    \r\n}\r\n","import { GameLogic } from \"../Game/GameLogic\";\r\n\r\nexport class AbmBaseNames {\r\n\r\n    static genericBaseCounter: number = 0;\r\n\r\n    static availableAbmBaseNames: string[] = [\r\n    ];\r\n\r\n    public static getAbmBaseName(): string {\r\n        \r\n        if (AbmBaseNames.availableAbmBaseNames.length > 0) {\r\n            const getNameResult = GameLogic.getNameForNameableItem({ fromNamesArr: AbmBaseNames.availableAbmBaseNames });\r\n            AbmBaseNames.availableAbmBaseNames = getNameResult.allOtherNames;\r\n            return getNameResult.baseName;\r\n        }\r\n        else {\r\n            return `Abm Base ${++AbmBaseNames.genericBaseCounter}`;\r\n        }\r\n    }\r\n\r\n}\r\n","import { AbstractMilitaryBase } from \"./AbstractMilitaryBase\";\r\nimport { MilitaryBaseTypeLabels } from \"./MilitaryBaseTypes\";\r\nimport { MapLocation } from \"../../MapObjects/MapLocation\";\r\nimport { AbmBaseNames } from \"../../../Data/AbmBaseNames\";\r\n\r\nexport class AbmBase extends AbstractMilitaryBase {\r\n\r\n    public readonly WorldObjectLabel: MilitaryBaseTypeLabels = \"ABM\";\r\n\r\n    public totalMissiles: number;\r\n    public isTracking: boolean;\r\n\r\n    constructor(args: {atLocation: MapLocation, yearBuilt: number}) {\r\n        super(args);\r\n\r\n        this.Name = AbmBaseNames.getAbmBaseName();\r\n        this.totalMissiles = 0;\r\n        this.isTracking = false;\r\n        this.isReceivingOrders = false;\r\n    }\r\n\r\n}","import { GameLogic } from \"../Game/GameLogic\";\r\n\r\nexport class RadarBaseNames {\r\n\r\n    private static availableRadarBaseNames: string[] = [\r\n        \"Hertz\",\r\n        \"Maxwell\",\r\n        \"Hülsmeyer\",\r\n        \"Marconi\",\r\n        \"Franklin\",\r\n        \"Watt\",\r\n        \"Tizard\",\r\n        \"Wimperis\",\r\n        \"Wilkins\",\r\n        \"Bowan\",\r\n        \"Rowe\",\r\n        \"Lindemann\",\r\n        \"Dowding\",\r\n        \"Randall\",\r\n        \"Boot\",\r\n        \"Lewis\",\r\n        \"Butement\",\r\n        \"Pollard\",\r\n        \"Worlledge\",\r\n        \"Paris\",\r\n        \"Erbslöh\",\r\n        \"Willisen\",\r\n        \"Hollmann\",\r\n        \"Schultes\",\r\n        \"Taylor\",\r\n        \"Young\",\r\n        \"Hyland\",\r\n        \"Breit\",\r\n        \"Tuve\",\r\n        \"Page\",\r\n        \"Popov\",\r\n        \"Oshchepkov\",\r\n        \"Lobanov\"\r\n    ];\r\n\r\n    public static getRadarBaseName(): string {\r\n\r\n        const getNameReslt = GameLogic.getNameForNameableItem({fromNamesArr: this.availableRadarBaseNames});\r\n        this.availableRadarBaseNames = getNameReslt.allOtherNames;\r\n        return getNameReslt.baseName;\r\n    }\r\n\r\n}\r\n ","import { AbstractMilitaryBase } from \"./AbstractMilitaryBase\";\r\nimport { MilitaryBaseTypeLabels } from \"./MilitaryBaseTypes\";\r\nimport { MapLocation } from \"../../MapObjects/MapLocation\";\r\nimport { nameableGAmeObject } from \"../../nameableGameObject\";\r\nimport { GameLogComponent } from \"../../../Components/GameLogComponent\";\r\nimport { GameLogic } from \"../../../Game/GameLogic\";\r\nimport { RadarBaseNames } from \"../../../Data/RadarBaseNames\";\r\n\r\nexport class RadarBase extends AbstractMilitaryBase implements nameableGAmeObject {\r\n \r\n    public readonly WorldObjectLabel: MilitaryBaseTypeLabels = \"Radar\";\r\n\r\n    public modeOfOperation: \"Inactive\" | \"Active\" | \"Passive\";\r\n\r\n    constructor(args: {atLocation: MapLocation, yearBuilt: number}) {\r\n        super(args);\r\n\r\n        this.modeOfOperation = \"Inactive\";\r\n\r\n        this.Name = RadarBaseNames.getRadarBaseName();\r\n        console.log(\"RadarBase.ts: ctor: got a radar base name:\", this.Name)\r\n    }\r\n\r\n    public setModeOfOperation(args: {mode: \"Active\" | \"Passive\"}) {\r\n        this.modeOfOperation = args.mode;\r\n    }\r\n}","import { GameLogic } from \"../Game/GameLogic\";\r\n\r\nexport class MissileBaseNames {\r\n\r\n    static genericBaseCounter: number = 0;\r\n\r\n    static availableMissileBaseNames: string[] = [\r\n        \"Wernher von Braun\",\r\n        \"Armstrong\",\r\n        \"Musk\",\r\n        \"Cayley\",\r\n        \"Goddard\",\r\n        \"Korolev\",\r\n        \"Chawla\",\r\n        \"Wallis\",\r\n        \"Ohain\",\r\n        \"Mitchell\",\r\n        \"Crawford Johnson\",\r\n        \"Amrutkar-Pate\",\r\n        \"Manypu\",\r\n        \"Arnold\",\r\n        \"Korolyov\",\r\n        \"Gagarin\",\r\n        \"Ramo\",\r\n        \"Kryukov\",\r\n        \"Barmin\",\r\n        \"Coandă\",\r\n        \"Heinkel\",\r\n        \"Horikoshi\",\r\n        \"Nadiradze\",\r\n        \"Popov\",\r\n        \"Rich\",\r\n        \"Walter\",\r\n        \"Wendt\",\r\n        \"Whittle\",\r\n        \"Wright\",\r\n        \"Oppenheimer\",\r\n        \"Einstein\",\r\n        \"Curie\",\r\n        \"Rutherford\",\r\n        \"Soddy\",\r\n        \"Leó Szilárd\",\r\n        \"Joliot-Curie\",\r\n        \"Strassmann\",\r\n        \"Hahn\",\r\n        \"Sengier\",\r\n        \"Bethe\"\r\n    ];\r\n\r\n    public static getMissileBaseName(): string {\r\n        \r\n        if (MissileBaseNames.availableMissileBaseNames.length > 0) {\r\n            const getNameResult = GameLogic.getNameForNameableItem({ fromNamesArr: MissileBaseNames.availableMissileBaseNames });\r\n            MissileBaseNames.availableMissileBaseNames = getNameResult.allOtherNames;\r\n            return getNameResult.baseName;\r\n        }\r\n        else {\r\n            return `Missile Base ${++MissileBaseNames.genericBaseCounter}`;\r\n        }\r\n    }\r\n\r\n}\r\n","import { AbstractMilitaryBase, OrdnanceCarryingBase } from \"./AbstractMilitaryBase\";\r\nimport { MilitaryBaseTypeLabels } from \"./MilitaryBaseTypes\";\r\nimport { GameLogic } from \"../../../Game/GameLogic\";\r\nimport { Ordnance } from \"../../Ordnance\";\r\nimport { MapLocation } from \"../../MapObjects/MapLocation\";\r\nimport { MissileBaseNames } from \"../../../Data/MissileBaseNames\";\r\n\r\nexport class MissileBase extends AbstractMilitaryBase implements OrdnanceCarryingBase {\r\n\r\n    public readonly WorldObjectLabel: MilitaryBaseTypeLabels = \"Missile\";\r\n    public : number = 1;\r\n\r\n    public ordnance: Ordnance[];\r\n    \r\n    constructor(args: {atLocation: MapLocation, yearBuilt: number}) {\r\n        super(args);\r\n\r\n        this.Name = MissileBaseNames.getMissileBaseName();\r\n        this.ordnance = [];\r\n\r\n        this.isReceivingOrders = false;\r\n    }\r\n\r\n    public isAllOrdnanceTargeted(): boolean {\r\n        return ! this.ordnance.some(m => m.myTarget === null);\r\n    }\r\n \r\n    public activate() {\r\n        GameLogic.activateMissileBase({forBase: this});\r\n    }\r\n    \r\n}","import { GameLogic } from \"../Game/GameLogic\";\r\n\r\nexport class AirBaseNames {\r\n\r\n    static genericBaseCounter: number = 0;\r\n\r\n    static availableAirBaseNames: string[] = [\r\n    ];\r\n\r\n    public static getAirBaseName(): string {\r\n        \r\n        if (AirBaseNames.availableAirBaseNames.length > 0) {\r\n            const getNameResult = GameLogic.getNameForNameableItem({ fromNamesArr: AirBaseNames.availableAirBaseNames });\r\n            AirBaseNames.availableAirBaseNames = getNameResult.allOtherNames;\r\n            return getNameResult.baseName;\r\n        }\r\n        else {\r\n            return `Air Base ${++AirBaseNames.genericBaseCounter}`;\r\n        }\r\n    }\r\n\r\n}\r\n","import { AbstractMilitaryBase, OrdnanceCarryingBase } from \"./AbstractMilitaryBase\";\r\nimport { MilitaryBaseTypeLabels } from \"./MilitaryBaseTypes\";\r\nimport { Constants } from \"../../../Game/constants\";\r\nimport { Rng } from \"../../../Utils/Rng\";\r\nimport { Ordnance } from \"../../Ordnance\";\r\nimport { GameLogic } from \"../../../Game/GameLogic\";\r\nimport { MapLocation } from \"../../MapObjects/MapLocation\";\r\nimport { AirBaseNames } from \"../../../Data/AirBaseNames\";\r\n\r\nexport class AirBase extends AbstractMilitaryBase implements OrdnanceCarryingBase{\r\n\r\n    public readonly WorldObjectLabel: MilitaryBaseTypeLabels = \"Air\";\r\n\r\n    public ordnance: Ordnance[];\r\n    public totalFighters: number;\r\n\r\n    public isFlying: boolean;\r\n\r\n    constructor(args: {atLocation: MapLocation, yearBuilt: number}) {\r\n        super(args);\r\n\r\n        this.Name = AirBaseNames.getAirBaseName();\r\n        this.ordnance = [];\r\n        this.totalFighters = 0;\r\n        this.isFlying = false;\r\n    }\r\n\r\n    public activate(): void {\r\n\r\n        console.log(`AirBase.ts: activate: entering.`);\r\n        \r\n        GameLogic.activateAirBase({forBase: this});\r\n\r\n    }\r\n\r\n\r\n    public isAllOrdnanceTargeted(): boolean {\r\n        return ! this.ordnance.some(b => b.myTarget === null);\r\n    }\r\n \r\n\r\n\r\n}","import { GameLogic } from \"../Game/GameLogic\";\r\n\r\nexport class ArmyBaseNames {\r\n\r\n    static genericBaseCounter: number = 0;\r\n\r\n    static availableArmyBaseNames: string[] = [\r\n    ];\r\n\r\n    public static getArmyBaseName(): string {\r\n        \r\n        if (ArmyBaseNames.availableArmyBaseNames.length > 0) {\r\n            const getNameResult = GameLogic.getNameForNameableItem({ fromNamesArr: ArmyBaseNames.availableArmyBaseNames });\r\n            ArmyBaseNames.availableArmyBaseNames = getNameResult.allOtherNames;\r\n            return getNameResult.baseName;\r\n        }\r\n        else {\r\n            return `Army Base ${++ArmyBaseNames.genericBaseCounter}`;\r\n        }\r\n    }\r\n\r\n}\r\n","import { AbstractMilitaryBase } from \"./AbstractMilitaryBase\";\r\nimport { MilitaryBaseTypeLabels } from \"./MilitaryBaseTypes\";\r\nimport { MapLocation } from \"../../MapObjects/MapLocation\";\r\nimport { ArmyBaseNames } from \"../../../Data/ArmyBaseNames\";\r\n\r\nexport class ArmyBase extends AbstractMilitaryBase {\r\n\r\n    public readonly WorldObjectLabel: MilitaryBaseTypeLabels = \"Army\";\r\n    public isDecamped: boolean;\r\n\r\n    constructor(args: {atLocation: MapLocation, yearBuilt: number}) {\r\n    \r\n        super(args);\r\n\r\n        this.Name = ArmyBaseNames.getArmyBaseName();\r\n        this.isReceivingOrders = false;\r\n        this.isDecamped = false;\r\n    \r\n    }\r\n\r\n}","import { GameLogic } from \"../Game/GameLogic\";\r\n\r\nexport class NavyBaseNames {\r\n\r\n    static gericBaseCounter: number = 0;\r\n\r\n    static availableNavyBaseNames: string[] = [\r\n\r\n        \"Wahoo\",\r\n        \"Triton\",\r\n        \"George Washington\",\r\n        \"Ethan Allen\",\r\n        \"Nautilus\",\r\n        \"Turtle\",\r\n        \"Plongeur\",\r\n        \"Drebbel\",\r\n        \"Das Boot\",\r\n        \"Red October\",\r\n        \"Yellow\",\r\n        \"Seaview\",\r\n        \"SHADO\",\r\n        \"Cetacean\",\r\n        \"seaQuest\",\r\n        \"Sword\",\r\n        \"Iron Fish\",\r\n        \"Hydronaut\",\r\n        \"Supercar\",\r\n        \"Stingray\",\r\n        \"Thunderbird\",\r\n        \"Leif Eriskson\",\r\n        \"Sea Tiger\",\r\n        \"Blue Sumbarine No 6\",\r\n        \"Proteus\",\r\n        \"Wonder\",\r\n        \"Jetmarine\",\r\n        \"Fenian Ram S1881\",\r\n        \"Gotengo\",\r\n        \"Voyager\",\r\n        \"Rorqual Maaru\",\r\n        \"Sea Trench\",\r\n        \"Ulysses\",\r\n        \"UX\",\r\n        \"Vorpal Blade\",\r\n        \"I-507\"\r\n    ];\r\n\r\n    public static getNavyBaseName(): string {\r\n\r\n        if (NavyBaseNames.availableNavyBaseNames.length > 0) {\r\n            const getNameResult = GameLogic.getNameForNameableItem({ fromNamesArr: NavyBaseNames.availableNavyBaseNames });\r\n            NavyBaseNames.availableNavyBaseNames = getNameResult.allOtherNames;\r\n            return getNameResult.baseName;\r\n        }\r\n        else {\r\n            return `Generic Navy Base ${++NavyBaseNames.gericBaseCounter}`;\r\n        }\r\n    }\r\n\r\n}\r\n","import { AbstractMilitaryBase, OrdnanceCarryingBase } from \"./AbstractMilitaryBase\";\r\nimport { MilitaryBaseTypeLabels } from \"./MilitaryBaseTypes\";\r\nimport { GameLogic } from \"../../../Game/GameLogic\";\r\nimport { Ordnance } from \"../../Ordnance\";\r\nimport { MapLocation } from \"../../MapObjects/MapLocation\";\r\nimport { Rng } from \"../../../Utils/Rng\";\r\nimport { NavyBaseNames } from \"../../../Data/NavyBaseNames\";\r\n\r\nexport class NavyBase extends AbstractMilitaryBase implements OrdnanceCarryingBase {\r\n\r\n    public readonly WorldObjectLabel: MilitaryBaseTypeLabels = \"Navy\";\r\n\r\n    public ordnance: Ordnance[];\r\n\r\n    constructor(args: {atLocation: MapLocation, yearBuilt: number}) {\r\n        super(args);\r\n        this.isReceivingOrders = false;\r\n        this.Name = NavyBaseNames.getNavyBaseName();\r\n        this.ordnance = [];\r\n    }\r\n\r\n    public isAllOrdnanceTargeted(): boolean {\r\n        return ! this.ordnance.some(m => m.myTarget === null);\r\n    }\r\n \r\n    public activate() {\r\n        GameLogic.activateNavyBase({forBase: this});\r\n    }\r\n    \r\n\r\n}","import { MilitaryBaseTypeLabels } from \"../Entities/WorldObjects/Bases/MilitaryBaseTypes\";\r\nimport { AbmBase } from \"../Entities/WorldObjects/Bases/AbmBase\";\r\nimport { RadarBase } from \"../Entities/WorldObjects/Bases/RadarBase\";\r\nimport { MissileBase } from \"../Entities/WorldObjects/Bases/MissileBase\";\r\nimport { AirBase } from \"../Entities/WorldObjects/Bases/AirBase\";\r\nimport { ArmyBase } from \"../Entities/WorldObjects/Bases/ArmyBase\";\r\nimport { AbstractMilitaryBase } from \"../Entities/WorldObjects/Bases/AbstractMilitaryBase\";\r\nimport { NavyBase } from \"../Entities/WorldObjects/Bases/NavyBase\";\r\nimport { MapLocation } from \"../Entities/MapObjects/MapLocation\";\r\nimport { Game } from \"../Entities/gameEntity\";\r\n\r\nexport interface MilitaryBaseProperties {\r\n\r\n}\r\nexport class MilitaryBaseFactory {\r\n\r\n    private static instance: MilitaryBaseFactory;\r\n\r\n    private readonly msh = \"MilitaryBaseFactory: \";\r\n\r\n    private nextBaseID: number = 0;\r\n\r\n    constructor() {\r\n        \r\n    }\r\n\r\n    public static getInstance() : MilitaryBaseFactory {\r\n\r\n        if (!this.instance) {\r\n            this.instance = new MilitaryBaseFactory();\r\n        }\r\n\r\n        return this.instance;\r\n    }\r\n\r\n    // private newName(args: {forBase: AbstractMilitaryBase}) {\r\n    //     // console.log(`${this.msh}: newName: typeof base:`, args.forBase.WorldObjectLabel);\r\n    //     return 'xyzzy';\r\n    // }\r\n\r\n    public createNewBase(args: {baseType: MilitaryBaseTypeLabels, atLocation: MapLocation}) {\r\n\r\n        console.log(`MilitaryBaseFactory: createNewBase: entering with args:`, {args: args});\r\n        \r\n        const game = Game.getInstance();\r\n\r\n        const newBaseProperties = {atLocation: args.atLocation, yearBuilt: game.gameYear};\r\n\r\n        switch(args.baseType) {\r\n\r\n            case \"ABM\": {\r\n                const newBase = new AbmBase(newBaseProperties);\r\n                // newBase.Name = this.newName({forBase: newBase});\r\n                return newBase;\r\n            }\r\n            case \"Radar\": {\r\n                const newBase = new RadarBase(newBaseProperties);\r\n                // newBase.Name = this.newName({forBase: newBase});\r\n                return newBase;\r\n            }\r\n            case \"Navy\": {\r\n                const newBase = new NavyBase(newBaseProperties);\r\n                // newBase.Name = this.newName({forBase: newBase});\r\n                return newBase;\r\n            }\r\n            case \"Missile\": {\r\n                const newBase = new MissileBase(newBaseProperties);\r\n                // newBase.Name = this.newName({forBase: newBase});\r\n                return newBase;\r\n            }\r\n            case \"Air\": {\r\n                const newBase = new AirBase(newBaseProperties);\r\n                // newBase.Name = this.newName({forBase: newBase});\r\n                return newBase;\r\n            }\r\n            case \"Army\": {\r\n                const newBase = new ArmyBase(newBaseProperties);\r\n                // newBase.Name = this.newName({forBase: newBase});\r\n                return newBase;\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n}","import { MapLocation } from \"../Entities/MapObjects/MapLocation\";\r\nimport { CountryMap } from \"../Entities/WorldObjects/CountryMap\";\r\nimport { AbmBase } from \"../Entities/WorldObjects/Bases/AbmBase\";\r\nimport { MissileBase } from \"../Entities/WorldObjects/Bases/MissileBase\";\r\nimport { NavyBase } from \"../Entities/WorldObjects/Bases/NavyBase\";\r\nimport { RadarBase } from \"../Entities/WorldObjects/Bases/RadarBase\";\r\nimport { MilitaryBaseTypeLabels, MilitaryBaseTypes, NonNullMilitaryBaseTypes } from \"../Entities/WorldObjects/Bases/MilitaryBaseTypes\";\r\nimport { AirBase } from \"../Entities/WorldObjects/Bases/AirBase\";\r\nimport { OrdnanceCarryingBase, AbstractMilitaryBase } from \"../Entities/WorldObjects/Bases/AbstractMilitaryBase\";\r\nimport { ArmyBase } from \"../Entities/WorldObjects/Bases/ArmyBase\";\r\nimport { MilitaryBaseFactory } from \"../Factories/MilitaryBaseFactory\";\r\n\r\nexport interface countrySummary {\r\n    allAbmBases: AbmBase[];\r\n    allRadarBases: RadarBase[];\r\n    allArmyBases: ArmyBase[];\r\n    allNavyBases: NavyBase[];\r\n    allAirBases: AirBase[];\r\n    allMissileBases: MissileBase[];\r\n    targetedMapLocations: MapLocation[];\r\n    totalAbmMissilesOnLine: number;\r\n    totalICBMsOnLine: number;\r\n    totalSubMissilesOnLine: number;\r\n    totalPassiveRadarStationsOnLine: number;\r\n    totalActiveRadarStationsOnLine: number;\r\n    totalBombersInFlight: number;\r\n    totalFightersOnPatrol: number;\r\n    totalPopulation: number;\r\n}\r\n\r\nexport class MapUtil {\r\n\r\n    public static readonly initialSummary: countrySummary = {\r\n        allAbmBases: [],\r\n        allRadarBases: [],\r\n        allAirBases: [],\r\n        allArmyBases: [],\r\n        allNavyBases: [],\r\n        allMissileBases: [],\r\n        targetedMapLocations: [],\r\n        totalAbmMissilesOnLine: 0,\r\n        totalICBMsOnLine: 0,\r\n        totalSubMissilesOnLine: 0,\r\n        totalPassiveRadarStationsOnLine: 0,\r\n        totalActiveRadarStationsOnLine: 0,\r\n        totalBombersInFlight: 0,\r\n        totalFightersOnPatrol: 0,\r\n        totalPopulation: 0\r\n        }\r\n\r\n\r\n    public static GetMapLocationSingleCharacterCode(args: { forMapLocation: MapLocation }) {\r\n\r\n        if (args.forMapLocation.Contents === null) {\r\n            return \"Empty\";\r\n        }\r\n\r\n        switch (args.forMapLocation.Contents.WorldObjectLabel) {\r\n            case \"ABM\": return \"A\";\r\n            case \"Air\": return \"B\";\r\n            case \"Army\": return \"T\";\r\n            case \"City\": return \"C\";\r\n            case \"Missile\": return \"M\";\r\n            case \"Navy\": return \"S\";\r\n            case \"Radar\": return \"R\";\r\n            case \"Rural\": return \"•\";\r\n            case \"Town\": return \"T\";\r\n       }\r\n\r\n        return \"empty\";\r\n    }\r\n\r\n    public static isWO = (l: MapLocation, which: MilitaryBaseTypeLabels) => l.Contents && l.Contents.WorldObjectLabel === which;\r\n    public static isAirBase = (l: MapLocation) => MapUtil.isWO(l, \"Air\");\r\n    public static isArmyBase = (l: MapLocation) => MapUtil.isWO(l, \"Army\");\r\n    public static isMissileBase = (l: MapLocation) => MapUtil.isWO(l, \"Missile\");\r\n    public static isNavyBase = (l: MapLocation) => MapUtil.isWO(l, \"Navy\");\r\n    public static isRadarBase = (l: MapLocation) => MapUtil.isWO(l, \"Radar\");\r\n    public static isAbmBase = (l: MapLocation) => MapUtil.isWO(l, \"ABM\");\r\n\r\n    public static applyFunctionToCountryMap<T>(args: {map: CountryMap, xformFunc: (ml : MapLocation) => void}) {\r\n\r\n        for (let i = 0; i < args.map.map.length; i++) {\r\n            for (let j = 0; j < args.map.map[i].length;j++) {\r\n                args.xformFunc(args.map.map[i][j]);\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    public static allMilitaryBases(args: {forMap: CountryMap}): NonNullMilitaryBaseTypes[] {\r\n\r\n        const summary = this.getMapSummary({forMap: args.forMap});\r\n\r\n        const onlyMilitaryBases = ([] as NonNullMilitaryBaseTypes[]).concat(\r\n            summary.allAbmBases,\r\n            summary.allAirBases,\r\n            summary.allArmyBases,\r\n            summary.allMissileBases,\r\n            summary.allNavyBases,\r\n            summary.allRadarBases\r\n            );\r\n\r\n        return onlyMilitaryBases;\r\n\r\n    }\r\n\r\n    public static getMapSummary(args: { forMap: CountryMap }): countrySummary {\r\n\r\n        const isPassiveRader = (loc: MapLocation) => MapUtil.isRadarBase(loc) && (loc.Contents as RadarBase).modeOfOperation === \"Passive\";\r\n        const isActiveRader = (loc: MapLocation) => MapUtil.isRadarBase(loc) && (loc.Contents as RadarBase).modeOfOperation === \"Active\";\r\n\r\n        // function to,  = \"allTO\" = \"all tageted ordnance\"\r\n        const allTO = (base: OrdnanceCarryingBase) => base.ordnance.filter(o => o.myTarget && o.wasConsumed === false);\r\n        const ttlTtO = (base: OrdnanceCarryingBase) => allTO(base).length;\r\n\r\n        const mu = MapUtil;\r\n\r\n        const addLocationToSummary = (mapLoc: MapLocation, addToSummary: countrySummary) =>\r\n            mapLoc.Contents\r\n                ? (\r\n                    {\r\n                        allAbmBases: mu.isAbmBase(mapLoc) ? addToSummary.allAbmBases.concat(mapLoc.Contents as AbmBase) : addToSummary.allAbmBases,\r\n                        totalAbmMissilesOnLine: mu.isAbmBase(mapLoc) ? addToSummary.totalAbmMissilesOnLine += (mapLoc.Contents as AbmBase).totalMissiles : addToSummary.totalAbmMissilesOnLine,\r\n                        allRadarBases: mu.isRadarBase(mapLoc) ? addToSummary.allRadarBases.concat(mapLoc.Contents as RadarBase) : addToSummary.allRadarBases,\r\n                        totalPassiveRadarStationsOnLine: isPassiveRader(mapLoc) ? addToSummary.totalPassiveRadarStationsOnLine += 1 : addToSummary.totalPassiveRadarStationsOnLine,\r\n                        totalActiveRadarStationsOnLine: isActiveRader(mapLoc) ? addToSummary.totalActiveRadarStationsOnLine += 1 : addToSummary.totalActiveRadarStationsOnLine,\r\n                        allArmyBases: mu.isArmyBase(mapLoc) ? addToSummary.allArmyBases.concat(mapLoc.Contents as ArmyBase) : addToSummary.allArmyBases,\r\n                        allAirBases: mu.isAirBase(mapLoc) ? addToSummary.allAirBases.concat(mapLoc.Contents as AirBase) : addToSummary.allAirBases,\r\n                        totalBombersInFlight: mu.isAirBase(mapLoc) ? addToSummary.totalBombersInFlight += ttlTtO(mapLoc.Contents as AirBase) : addToSummary.totalBombersInFlight,\r\n                        totalFightersOnPatrol: mu.isAirBase(mapLoc) ? addToSummary.totalFightersOnPatrol += (mapLoc.Contents as AirBase).totalFighters : addToSummary.totalFightersOnPatrol,\r\n                        allMissileBases: mu.isMissileBase(mapLoc) ? addToSummary.allMissileBases.concat(mapLoc.Contents as MissileBase) : addToSummary.allMissileBases,\r\n                        totalICBMsOnLine: mu.isMissileBase(mapLoc) ? addToSummary.totalICBMsOnLine += ttlTtO(mapLoc.Contents as MissileBase) : addToSummary.totalICBMsOnLine,\r\n                        allNavyBases: mu.isNavyBase(mapLoc) ? addToSummary.allNavyBases.concat(mapLoc.Contents as NavyBase) : addToSummary.allNavyBases,\r\n                        totalSubMissilesOnLine: mu.isNavyBase(mapLoc) ? addToSummary.totalSubMissilesOnLine += ttlTtO(mapLoc.Contents as NavyBase) : addToSummary.totalSubMissilesOnLine,\r\n                        targetedMapLocations: mapLoc.isTargeted ? addToSummary.targetedMapLocations.concat(mapLoc) : addToSummary.targetedMapLocations,\r\n                        totalPopulation: addToSummary.totalPopulation += mapLoc.Contents.Population\r\n                    } as countrySummary\r\n                )\r\n                : addToSummary\r\n            ;\r\n\r\n        const mapRowSummary = (row: MapLocation[]) =>\r\n            row.reduce((prev, curr) => addLocationToSummary(curr, prev), this.initialSummary);\r\n\r\n        const addTwoSummaries = (s1: countrySummary, s2: countrySummary) => (\r\n            {\r\n                allAbmBases: s1.allAbmBases.concat(s2.allAbmBases),\r\n                totalAbmMissilesOnLine: s1.totalAbmMissilesOnLine + s2.totalAbmMissilesOnLine,\r\n                allRadarBases: s1.allRadarBases.concat(s2.allRadarBases),\r\n                allAirBases: s1.allAirBases.concat(s2.allAirBases),\r\n                allArmyBases: s1.allArmyBases.concat(s2.allArmyBases),\r\n                allMissileBases: s1.allMissileBases.concat(s2.allMissileBases),\r\n                allNavyBases: s1.allNavyBases.concat(s2.allNavyBases),\r\n                targetedMapLocations: s1.targetedMapLocations.concat(s2.targetedMapLocations),\r\n                totalICBMsOnLine: s1.totalICBMsOnLine + s2.totalICBMsOnLine,\r\n                totalSubMissilesOnLine: s1.totalSubMissilesOnLine + s2.totalSubMissilesOnLine,\r\n                totalPassiveRadarStationsOnLine: s1.totalPassiveRadarStationsOnLine + s2.totalPassiveRadarStationsOnLine,\r\n                totalActiveRadarStationsOnLine: s1.totalActiveRadarStationsOnLine + s2.totalActiveRadarStationsOnLine,\r\n                totalBombersInFlight: s1.totalBombersInFlight + s2.totalBombersInFlight,\r\n                totalFightersOnPatrol: s1.totalFightersOnPatrol + s2.totalFightersOnPatrol,\r\n                totalPopulation: s1.totalPopulation + s2.totalPopulation\r\n            } as countrySummary\r\n        );\r\n\r\n        const allIn = args.forMap.map.reduce(\r\n            (runningSummary, currentMapRow) => addTwoSummaries(runningSummary, mapRowSummary(currentMapRow)), this.initialSummary\r\n        );\r\n\r\n        // somehow, the reduce stuff up above is over-calculating the population.\r\n        let runningPop = 0;\r\n        for (let i = 0; i < args.forMap.map.length; i++) {\r\n            for (let j = 0; j < args.forMap.map[i].length; j++) {\r\n                const {Contents} = args.forMap.map[i][j];\r\n                if (Contents !== null) {\r\n                    runningPop += (Contents.Population);\r\n                    }\r\n                // console.log(`[${i}] [${j}]: pop: ${runningPop}`);\r\n            }\r\n        }\r\n        allIn.totalPopulation = runningPop;\r\n\r\n        // console.log(`MapUtils: getMapSummary: allIn:`, { map: args.forMap, allIn: allIn, population: allIn.totalPopulation, name: args.forMap.owner });\r\n\r\n        return allIn;\r\n    }\r\n\r\n    public static getMapLocationHtmlID(forMapLocation: MapLocation) {\r\n        return `MapLocation_${forMapLocation.uniqueID}`;\r\n    }\r\n \r\n    public static createTestBases(args: {onMap: CountryMap}) {\r\n\r\n        const mLoc = args.onMap.map[0][7];\r\n        const m = MilitaryBaseFactory.getInstance().createNewBase({baseType: \"Missile\", atLocation: mLoc});\r\n        const rLoc = args.onMap.map[0][1];\r\n        const r = MilitaryBaseFactory.getInstance().createNewBase({baseType: \"Radar\", atLocation: rLoc});\r\n        const rLoc2 = args.onMap.map[0][2];\r\n        const r2 = MilitaryBaseFactory.getInstance().createNewBase({baseType: \"Radar\", atLocation: rLoc2});\r\n        const bLoc = args.onMap.map[0][3];\r\n        const b = MilitaryBaseFactory.getInstance().createNewBase({baseType: \"Air\", atLocation: bLoc});\r\n        const nLoc = args.onMap.map[0][4];\r\n        const n = MilitaryBaseFactory.getInstance().createNewBase({baseType: \"Navy\", atLocation: nLoc});\r\n        const aLoc = args.onMap.map[0][5];\r\n        const a = MilitaryBaseFactory.getInstance().createNewBase({baseType: \"Army\", atLocation: aLoc});\r\n        const abmLoc = args.onMap.map[0][6];\r\n        const abm = MilitaryBaseFactory.getInstance().createNewBase({baseType: \"ABM\", atLocation: abmLoc});\r\n\r\n        if (m) {mLoc.placeItem({itemToPlace: m});}\r\n        if (r) {rLoc.placeItem({itemToPlace: r});}\r\n        if (r2) {rLoc2.placeItem({itemToPlace: r2});}\r\n        if (b) {bLoc.placeItem({itemToPlace: b});}\r\n        if (n) {nLoc.placeItem({itemToPlace: n});}\r\n        if (a) {aLoc.placeItem({itemToPlace: a});}\r\n        if (abm) {abmLoc.placeItem({itemToPlace: abm});}\r\n\r\n\r\n    }\r\n}","\r\nimport { Game } from \"../Entities/gameEntity\";\r\nimport { AbstractPlayer } from \"./AbstractPlayer\";\r\nimport { AbmBase } from \"../Entities/WorldObjects/Bases/AbmBase\";\r\nimport { GameRules, nuclearStrikeDamage } from \"./GameRules\";\r\nimport { Rng } from \"../Utils/Rng\";\r\nimport { ArmyBase } from \"../Entities/WorldObjects/Bases/ArmyBase\";\r\nimport { MissileBase } from \"../Entities/WorldObjects/Bases/MissileBase\";\r\nimport { Constants } from \"./constants\";\r\nimport { NavyBase } from \"../Entities/WorldObjects/Bases/NavyBase\";\r\nimport { Ordnance } from \"../Entities/Ordnance\";\r\nimport { MapLocation } from \"../Entities/MapObjects/MapLocation\";\r\nimport { AirBase } from \"../Entities/WorldObjects/Bases/AirBase\";\r\nimport { MapUtil } from \"../Utils/MapUtils\";\r\nimport { RadarBase } from \"../Entities/WorldObjects/Bases/RadarBase\";\r\nimport { MilitaryBaseTypes, NonNullMilitaryBaseTypes } from \"../Entities/WorldObjects/Bases/MilitaryBaseTypes\";\r\nimport { getNameProcessResult } from \"../Entities/nameableGameObject\";\r\n\r\nexport type gameStateChangeType =\r\n    \"Advance Turn\" |\r\n    \"Base Activated\" |\r\n    \"Bomber was shot down by ABM\" |\r\n    \"Bomber was shot down by Fighter\" |\r\n    \"Computer Finished Its Turn\" |\r\n    \"Computer Playing Its Turn\" |\r\n    \"ICBM Intercepted\" |\r\n    \"Location Nuked\" |\r\n    \"Map Location Targeted\" |\r\n    \"New base constructed\" |\r\n    \"no change\" |\r\n    \"Submarine Missile Shot Down By ABM\" |\r\n    \"Tick\" |\r\n    \"War Declared\";\r\n\r\nexport interface gameStateChangeDetails {\r\n    changeLabel: gameStateChangeType;\r\n    relatedLocation?: MapLocation;\r\n    relatedBase?: Exclude<MilitaryBaseTypes,null>;\r\n    miscDetails?: string;\r\n}\r\n\r\nexport interface GamestateWatcher {\r\n    handleGamestateChange: (args: { details: gameStateChangeDetails }) => void;\r\n}\r\n\r\n\r\n\r\nexport class GameLogic {\r\n\r\n    private static gameStateWatchers: GamestateWatcher[] = [];\r\n\r\n    public static registerGamestateWatcher(args: { watcher: GamestateWatcher }) {\r\n        this.gameStateWatchers = this.gameStateWatchers.concat(args.watcher);\r\n    }\r\n\r\n    private static notifyGamestateChange(args: { details: gameStateChangeDetails }) {\r\n\r\n        // console.log(`GameLogic: notifyGamestateChange(): notifying watchers:`, { watchers: this.gameStateWatchers });\r\n\r\n        this.gameStateWatchers.forEach(gsw => gsw.handleGamestateChange({ details: args.details }));\r\n    }\r\n\r\n    public static playComputerTurn(): void {\r\n\r\n        const game = Game.getInstance();\r\n\r\n        this.notifyGamestateChange({ details: { changeLabel: \"Computer Playing Its Turn\", miscDetails: game.currentPlayer.Name } })\r\n\r\n        game.currentPlayer = game.computerPlayer;\r\n\r\n        game.computerPlayer.playTurn();\r\n\r\n        game.currentPlayer = game.humanPlayer;\r\n\r\n    }\r\n\r\n    public static activateAbmBase(args: { forBase: AbmBase }) {\r\n\r\n        const { forBase } = args;\r\n\r\n        forBase.totalMissiles = Rng.throwDice({ hiNumberMinus1: 5 }) + 1;\r\n        forBase.isTracking = true;\r\n        forBase.isReceivingOrders = true;\r\n\r\n        this.notifyGamestateChange({ details: { changeLabel: \"Base Activated\", relatedBase: forBase } });\r\n\r\n        return;\r\n\r\n    }\r\n\r\n    public static handleMissileTargeted(args: { attackingPlayer: AbstractPlayer, atMapLocation: MapLocation, targetingOrdnance: Ordnance }) {\r\n\r\n        const {targetingOrdnance} = args;\r\n\r\n        args.atMapLocation.isTargeted = true;\r\n\r\n        targetingOrdnance.myTarget = args.atMapLocation;\r\n        targetingOrdnance.remainingTicksBeforeStriking = GameRules.getMissileArrivalTicks();\r\n        console.log(`GameLogic: handleMissileTargeted: A missile will land in [${targetingOrdnance.remainingTicksBeforeStriking}] ticks.`);\r\n\r\n        args.attackingPlayer.allTargetedOrdnanceItems = args.attackingPlayer.allTargetedOrdnanceItems.concat(args.targetingOrdnance);\r\n                \r\n        this.notifyGamestateChange({ details: { changeLabel: \"Map Location Targeted\", relatedLocation: args.atMapLocation } })\r\n    }\r\n\r\n    public static activateMissileBase(args: { forBase: MissileBase }) {\r\n\r\n        const {forBase} = args;\r\n\r\n        forBase.isReceivingOrders = true;\r\n\r\n        this.notifyGamestateChange({ details: { relatedBase: args.forBase, changeLabel: \"Base Activated\" } });\r\n\r\n        const totalICBMs = Rng.throwDice({ hiNumberMinus1: Constants.MAX_ICBMS - 1 }) + Constants.MIN_ICBMS;\r\n\r\n        forBase.ordnance = [];\r\n\r\n        for (let i = 0; i < totalICBMs; i++) {\r\n            forBase.ordnance = forBase.ordnance.concat(new Ordnance({ parentBase: forBase }));\r\n        }\r\n\r\n    }\r\n\r\n    public static notifyNewBaseConstructed(args: {forBaseType: MilitaryBaseTypes}) {\r\n\r\n        this.notifyGamestateChange({details: {changeLabel: \"New base constructed\", relatedBase: args.forBaseType}});\r\n\r\n    }\r\n\r\n    public static activateAirBase(args: { forBase: AirBase }) {\r\n\r\n        console.log(`GameLogic: activateAirBase: Entering:`, args);\r\n\r\n        args.forBase.isReceivingOrders = true;\r\n\r\n        this.notifyGamestateChange({ details: { relatedBase: args.forBase, changeLabel: \"Base Activated\" } });\r\n\r\n        const totalFighters = Constants.MAX_INITIAL_FIGHTERS + Rng.throwDice({ hiNumberMinus1: Constants.MAX_INITIAL_FIGHTERS - 1 });\r\n        args.forBase.totalFighters = totalFighters;\r\n\r\n        const totalBombers = Rng.throwDice({ hiNumberMinus1: Constants.MAX_ICBMS - 1 }) + Constants.MIN_ICBMS;\r\n\r\n        for (let i = 0; i < totalBombers; i++) {\r\n            args.forBase.ordnance = args.forBase.ordnance.concat(new Ordnance({ parentBase: args.forBase }));\r\n        }\r\n    }\r\n\r\n    public static activateNavyBase(args: { forBase: NavyBase }) {\r\n\r\n        args.forBase.isReceivingOrders = true;\r\n\r\n        this.notifyGamestateChange({ details: { relatedBase: args.forBase, changeLabel: \"Base Activated\" } });\r\n\r\n        const totalMissiles = Rng.throwDice({ hiNumberMinus1: Constants.MIN_SUB_MISSILES - 1 }) + Constants.MAX_SUB_MISSILES;\r\n\r\n        for (let i = 0; i < totalMissiles; i++) {\r\n            args.forBase.ordnance = args.forBase.ordnance.concat(new Ordnance({ parentBase: args.forBase }));\r\n        }\r\n    }\r\n\r\n    public static activateArmyBase(args: { forBase: ArmyBase }) {\r\n\r\n        this.notifyGamestateChange({ details: { relatedBase: args.forBase, changeLabel: \"Base Activated\" } });\r\n\r\n        args.forBase.isDecamped = true;\r\n\r\n        return;\r\n\r\n    }\r\n\r\n    public static activateRadarBase(args: { forBase: RadarBase }) {\r\n\r\n        this.notifyGamestateChange({ details: { relatedBase: args.forBase, changeLabel: \"Base Activated\" } });\r\n\r\n    }\r\n\r\n    public static startClock() {\r\n\r\n        let isSleeping: boolean = false;\r\n        const oneSecond = 1000;\r\n\r\n        setInterval(() => {\r\n\r\n            if (isSleeping) {\r\n                // do nothing\r\n            }\r\n            else {\r\n\r\n                const timeout = 3000; // 3 seconds\r\n\r\n                isSleeping = true;\r\n\r\n                setTimeout(() => {\r\n                    // console.log(`GameLogic.ts: startClock: broadcasting a game tick.`);\r\n                    GameLogic.pulseClock();\r\n                    isSleeping = false;\r\n                }, timeout);\r\n            }\r\n\r\n        }, oneSecond);\r\n\r\n    }\r\n\r\n    private static pulseClock() {\r\n\r\n        this.notifyGamestateChange({ details: { changeLabel: \"Tick\" } });\r\n\r\n        if (Game.getInstance().isWartime) {\r\n            this.resolveWartimeAttacks();\r\n            Game.getInstance().computerPlayer.playTurn();\r\n        }\r\n\r\n    }\r\n\r\n    private static resolveWartimeAttacks() {\r\n\r\n        const tryAbmDefense = (args: { nuclearOrdnance: Ordnance, defendingPlayer: AbstractPlayer }): \"succeeded\" | \"failed\" => {\r\n\r\n            console.log(`GameLogic.ts: tryAbmDefense: Entering.`);\r\n\r\n            const tryIntercept = (args: { nuclearOrdnance: Ordnance, defender: AbmBase }): \"succeeded\" | \"failed\" => {\r\n\r\n                console.log(`GameLogic.ts: tryAbmDefense: tryIntercept: Entering, ABM Base:`, {base: args.defender});\r\n\r\n                if (! args.defender) { return \"failed\" }; // there is no ABM base on line to defend this attack against.\r\n                if (args.defender.totalMissiles < 1) { return \"failed\" }\r\n\r\n                const didShootDownOrdnance = Rng.throwDice({ hiNumberMinus1: 100 }) < 50;\r\n\r\n                console.log(`GameLogic.ts: tryAbmDefense: tryIntercept: did shoot down?`, didShootDownOrdnance);\r\n\r\n                // consume an abm missile.\r\n                args.defender.totalMissiles--;\r\n\r\n                if (didShootDownOrdnance) {\r\n\r\n                    console.log(`GameLogic.ts: tryAbmDefense: tryIntercept: Successfully intercepted.`);\r\n\r\n                    args.nuclearOrdnance.wasConsumed = true;\r\n                    args.nuclearOrdnance.wasIntercepted = true;\r\n                    return \"succeeded\";\r\n                }\r\n                else {\r\n                    return \"failed\";\r\n                }\r\n            }\r\n\r\n            let abmBaseIndex = 0;\r\n\r\n            const availableABMBases = args.defendingPlayer.map.getAllABMBases();\r\n\r\n            // If no ABM bases, then the user can't defend.\r\n            if (availableABMBases.length < 1) {\r\n                console.log(`GameLogic.ts: tryAbmDefense: player has no ABMs, no defense possible.`);\r\n                return \"failed\" \r\n            };\r\n\r\n            // We get one try against ICBMs and Submarine missiles. We get two tries against bombers.\r\n            const firstTry = tryIntercept({ nuclearOrdnance: args.nuclearOrdnance, defender: availableABMBases[abmBaseIndex] });\r\n            if (firstTry === \"succeeded\") { return \"succeeded\"};\r\n            \r\n            if (args.nuclearOrdnance.myWorldLabel === \"ICBM\" || args.nuclearOrdnance.myWorldLabel === \"Submarine Missile\") {\r\n                return \"failed\";\r\n            }\r\n\r\n            // If we get here, it's a bomber. We get a second chance to shoot it down if there are any more ABMs available.\r\n            abmBaseIndex = -1;\r\n            if (availableABMBases[0].totalMissiles > 0) { abmBaseIndex = 0 }\r\n            if (availableABMBases[0].totalMissiles < 1 && availableABMBases.length > 1) { abmBaseIndex = 1 }\r\n\r\n            const secondTry = tryIntercept({ nuclearOrdnance: args.nuclearOrdnance, defender: availableABMBases[abmBaseIndex] });\r\n\r\n            if (secondTry === \"succeeded\")  {\r\n                return \"succeeded\";\r\n            }\r\n\r\n            console.log(`GameLogic.ts: tryAbmDefense: tryIntercept: Failed to intercept.`);\r\n\r\n            return \"failed\";\r\n\r\n        }\r\n\r\n        const tryICBMAttack = (args: {attackingOrdnance: Ordnance, defendingPlayer: AbstractPlayer,locationUnderAttack: MapLocation}): \"succeeded\" | \"failed\" => {\r\n\r\n            const abmDefenseAttempt = tryAbmDefense({defendingPlayer: args.defendingPlayer, nuclearOrdnance: args.attackingOrdnance })\r\n\r\n            if (abmDefenseAttempt === \"succeeded\") {\r\n                console.log(`resolveWartimeAttacks: tryICBMAttack: attacking player's ICBM was shot down by an ABM.`,\r\n                    {\r\n                        defendingPlayer: args.defendingPlayer,\r\n                        locationAttacked: args.locationUnderAttack\r\n                    });\r\n\r\n                this.notifyGamestateChange({ details: { changeLabel: \"ICBM Intercepted\", relatedLocation: args.locationUnderAttack } });\r\n\r\n                return \"failed\";\r\n            }\r\n\r\n            console.log(`resolveWartimeAttacks: tryAttack: Missile successfully hit target.`);\r\n            return \"succeeded\";\r\n        }\r\n\r\n        const tryBomberAttack = (args: {attackingOrdnance: Ordnance, defendingPlayer: AbstractPlayer,locationUnderAttack: MapLocation}): \"succeeded\" | \"failed\" => {\r\n\r\n            const abmDefenseAttempt = tryAbmDefense({defendingPlayer: args.defendingPlayer, nuclearOrdnance: args.attackingOrdnance })\r\n\r\n            if (abmDefenseAttempt === \"succeeded\") {\r\n                console.log(`resolveWartimeAttacks: tryBomberAttack: attacking player's bomber was shot down by an ABM.`,\r\n                    {\r\n                        defendingPlayer: args.defendingPlayer,\r\n                        locationAttacked: args.locationUnderAttack\r\n                    });\r\n\r\n                this.notifyGamestateChange({ details: { changeLabel: \"Bomber was shot down by ABM\", relatedLocation: args.locationUnderAttack } });\r\n\r\n                return \"failed\";\r\n            }\r\n\r\n            console.log(`resolveWartimeAttacks: tryBomberAttack: Bomber successfully hit target.`);\r\n            return \"succeeded\";\r\n        }\r\n\r\n        const trySubmarineAttack = (args: {attackingOrdnance: Ordnance, defendingPlayer: AbstractPlayer,locationUnderAttack: MapLocation}): \"succeeded\" | \"failed\" => {\r\n\r\n            const abmDefenseAttempt = tryAbmDefense({defendingPlayer: args.defendingPlayer, nuclearOrdnance: args.attackingOrdnance })\r\n\r\n            if (abmDefenseAttempt === \"succeeded\") {\r\n                console.log(`resolveWartimeAttacks: trySubmarineAttack: attacking player's submarine missile was shot down by an ABM.`,\r\n                    {\r\n                        defendingPlayer: args.defendingPlayer,\r\n                        locationAttacked: args.locationUnderAttack\r\n                    });\r\n\r\n                this.notifyGamestateChange({ details: { changeLabel: \"Submarine Missile Shot Down By ABM\", relatedLocation: args.locationUnderAttack } });\r\n\r\n                return \"failed\";\r\n            }\r\n\r\n            console.log(`resolveWartimeAttacks: tryBomberAttack: Bomber successfully hit target.`);\r\n            return \"succeeded\";\r\n        }\r\n\r\n        const getNextReadyOrdnance = (args: {attackingPlayer: AbstractPlayer, locationUnderAttack: MapLocation}) => {\r\n            const attackingOrdnance = args.attackingPlayer.ordnanceItemsArrivingThisTick.filter((ao) => {\r\n                if (ao.myTarget === null) return false;\r\n                if (ao.wasConsumed) return false;\r\n                if (ao.remainingTicksBeforeStriking > 0) return false;\r\n                return (ao.myTarget.uniqueID === args.locationUnderAttack.uniqueID);\r\n            })[0];\r\n\r\n            return attackingOrdnance;\r\n        }\r\n\r\n        const tryAttack = (args: { attackingPlayer: AbstractPlayer, defendingPlayer: AbstractPlayer, locationUnderAttack: MapLocation }): nuclearStrikeDamage | \"failed\" => {\r\n\r\n            console.log(`resolveWartimeAttacks: tryAttack: entering, args:`, { args: args });\r\n\r\n            // return nothing if there is no ordnance ready this turn.\r\n            const attackingOrdnance = getNextReadyOrdnance({attackingPlayer: args.attackingPlayer, locationUnderAttack: args.locationUnderAttack});\r\n\r\n            console.log(`resolveWartimeAttacks: tryAttack: found ordnance:`, { \r\n                foundAttackingOrdnance: attackingOrdnance, ticks: attackingOrdnance ? attackingOrdnance.remainingTicksBeforeStriking : \"na\" });\r\n\r\n            if (attackingOrdnance) {\r\n\r\n                attackingOrdnance.wasConsumed = true;\r\n\r\n                const defendingPlayerMapSummary = MapUtil.getMapSummary({ forMap: args.defendingPlayer.map });\r\n\r\n                console.log(`resolveWartimeAttacks: tryAttack: player is defending attack:`, {\r\n                    attackingOrdnance: attackingOrdnance,\r\n                    defendingPlayerMapSummary: defendingPlayerMapSummary\r\n                });\r\n\r\n                if (attackingOrdnance.myWorldLabel === \"ICBM\") {\r\n                    const icbmAttackResult = tryICBMAttack({attackingOrdnance: attackingOrdnance, defendingPlayer: args.defendingPlayer, locationUnderAttack: args.locationUnderAttack});\r\n                    if (icbmAttackResult === \"failed\") return \"failed\";\r\n                }\r\n                else if (attackingOrdnance.myWorldLabel === \"Bomber\") {\r\n                    const bomberAttackResult = tryBomberAttack({attackingOrdnance: attackingOrdnance, defendingPlayer: args.defendingPlayer, locationUnderAttack: args.locationUnderAttack});\r\n                    if (bomberAttackResult === \"failed\") return \"failed\";\r\n                }\r\n                else if (attackingOrdnance.myWorldLabel === \"Submarine Missile\") {\r\n                    const subMissileAttackResult = trySubmarineAttack({attackingOrdnance: attackingOrdnance, defendingPlayer: args.defendingPlayer, locationUnderAttack: args.locationUnderAttack});\r\n                    if (subMissileAttackResult === \"failed\") return \"failed\";\r\n                }\r\n                else {\r\n                    console.error(`GameLogic.ts: tryAttack: Error: tried to attack with unknown ordnance type:`, attackingOrdnance);\r\n                    return \"failed\";\r\n                }\r\n\r\n                const nukeDamage = GameRules.getLocationDamage(\r\n                    {\r\n                        attackedBy: attackingOrdnance,\r\n                        locationAttacked: args.locationUnderAttack,\r\n                    });\r\n\r\n                return nukeDamage;\r\n            }\r\n            else {\r\n                console.error(`resolveWartimeAttack: resolveAttack: there was no ordnance to attack with.`);\r\n                return \"failed\";\r\n            }\r\n        }\r\n\r\n        const getUpdatedOrdnanceArrivalTicksForPlayer = (args: {p: AbstractPlayer}) => {\r\n            return args.p.allTargetedOrdnanceItems = args.p.allTargetedOrdnanceItems\r\n                .map (ao => ao.remainingTicksBeforeStriking < 1 ? ao : {...ao, remainingTicksBeforeStriking: ao.remainingTicksBeforeStriking -1})\r\n        }\r\n\r\n        const hasOrdnanceStrikingThisTick = (args: {forPlayer: AbstractPlayer}) => {\r\n            return (\r\n                args.forPlayer.ordnanceItemsArrivingThisTick.some(\r\n                    o => \r\n                        o.remainingTicksBeforeStriking < 1 && \r\n                        o.wasConsumed === false && \r\n                        o.wasIntercepted === false\r\n                )\r\n            );\r\n        }\r\n\r\n        const resolveAttacksOnPlayer = (args: { attackingPlayer: AbstractPlayer, defendingPlayer: AbstractPlayer }) => {\r\n\r\n            const defendersMap = args.defendingPlayer.map;\r\n\r\n            const allTargetedLocations = MapUtil.getMapSummary({ forMap: defendersMap }).targetedMapLocations;\r\n\r\n            const locationsUnderAttackThisTick =\r\n                allTargetedLocations.filter(\r\n                    aTargetedLocation => args.attackingPlayer.ordnanceItemsArrivingThisTick.filter(\r\n                        oiatt => (\r\n                            oiatt.wasConsumed === false &&\r\n                            oiatt.wasIntercepted === false &&\r\n                            oiatt.myTarget && \r\n                            oiatt.myTarget.uniqueID === aTargetedLocation.uniqueID)\r\n                    ).length > 0\r\n                )\r\n\r\n            console.log(`GameLogic: resolveAttacksOnPlayer: player locations under attack this tick:`, {allTargetedLocations: allTargetedLocations, locationsUnderAttackThisTick});\r\n\r\n            for (let i = 0; i < locationsUnderAttackThisTick.length; i++) {\r\n\r\n                const { Contents } = locationsUnderAttackThisTick[i];\r\n\r\n                const attackedLocation = locationsUnderAttackThisTick[i];\r\n\r\n                if (!Contents) continue;\r\n\r\n                const result = tryAttack({ attackingPlayer: args.attackingPlayer, defendingPlayer: args.defendingPlayer, locationUnderAttack: attackedLocation });\r\n\r\n                if (result === \"failed\") {\r\n                    this.notifyGamestateChange({ details: { changeLabel: \"ICBM Intercepted\", relatedLocation: attackedLocation } });\r\n                }\r\n                else {\r\n                    damageLocation({location: locationsUnderAttackThisTick[i], damage: result});\r\n                }\r\n\r\n            }\r\n        };\r\n\r\n        const damageLocation = (args: {location: MapLocation, damage: nuclearStrikeDamage}) => {\r\n\r\n            args.location.nuclearStrikes = args.damage.strikeCount;\r\n            if (args.location.Contents) {args.location.Contents.Population -= args.damage.populationKilled};\r\n            args.location.myMap.owningPlayer.totalCausualties += args.damage.populationKilled;\r\n\r\n            if (args.location.isMilitaryBase()) {\r\n                const militaryBase = args.location.Contents as Exclude<MilitaryBaseTypes,null>;\r\n                militaryBase.wasDestroyed = militaryBase.wasDestroyed || Rng.throwDice({hiNumberMinus1: 100}) < 97;\r\n                militaryBase.isReceivingOrders = militaryBase.isReceivingOrders || (militaryBase.isReceivingOrders && ! militaryBase.wasDestroyed);\r\n\r\n                this.notifyGamestateChange({ \r\n                    details: { \r\n                        changeLabel: \"Location Nuked\", \r\n                        relatedLocation: args.location, \r\n                        relatedBase: militaryBase, \r\n                        miscDetails: `${ args.damage.populationKilled.toLocaleString()}` // citizens were killed. The ${militaryBase.WorldObjectLabel} base there (${militaryBase.Name}) ${militaryBase.wasDestroyed ? \"was\" : \"was not\"} destroyed.` \r\n                    } \r\n                });\r\n            }\r\n            else {\r\n                this.notifyGamestateChange({ \r\n                    details: { \r\n                        changeLabel: \"Location Nuked\", \r\n                        relatedLocation: args.location, \r\n                        miscDetails: `${args.damage.populationKilled.toLocaleString()}` \r\n                    } \r\n                });\r\n            }\r\n        }\r\n        \r\n        const isLiveOrdnance = (forOrdnance: Ordnance) => ! forOrdnance.wasIntercepted && ! forOrdnance.wasConsumed;\r\n\r\n        console.log(`GameLogic: resolveWartimeAttacks: Entering.`);\r\n\r\n        const game = Game.getInstance();\r\n\r\n        const playerA = game.currentPlayer;\r\n        const playerB = game.currentPlayer.isHuman ? game.computerPlayer : game.humanPlayer;\r\n\r\n        playerA.allTargetedOrdnanceItems = getUpdatedOrdnanceArrivalTicksForPlayer({p: playerA});\r\n        playerB.allTargetedOrdnanceItems = getUpdatedOrdnanceArrivalTicksForPlayer({p: playerB});\r\n        playerA.ordnanceItemsArrivingThisTick = playerA.allTargetedOrdnanceItems.filter(ato => isLiveOrdnance(ato) && ato.remainingTicksBeforeStriking < 1);\r\n        playerB.ordnanceItemsArrivingThisTick = playerB.allTargetedOrdnanceItems.filter(ato => isLiveOrdnance(ato) && ato.remainingTicksBeforeStriking < 1);\r\n\r\n        if (hasOrdnanceStrikingThisTick({forPlayer: playerA})) {\r\n            console.log(`GameLogic: resolveWartimeAttacks Player A (${playerA.Name}) has ordnance ready this tick:`, playerA.ordnanceItemsArrivingThisTick);\r\n            resolveAttacksOnPlayer({ attackingPlayer: playerA, defendingPlayer: playerB });\r\n        }\r\n        else {\r\n            console.log(`GameLogic: resolveWartimeAttacks Player A (${playerA.Name}) does not have ordnance ready this tick.`);\r\n        }\r\n\r\n        if (hasOrdnanceStrikingThisTick({forPlayer: playerB})) {\r\n            console.log(`GameLogic: resolveWartimeAttacks Player B (${playerB.Name}) has ordnance ready this tick:`, playerB.ordnanceItemsArrivingThisTick);\r\n            resolveAttacksOnPlayer({ attackingPlayer: playerB, defendingPlayer: playerA });\r\n        }\r\n        else {\r\n            console.log(`GameLogic: resolveWartimeAttacks Player B (${playerB.Name}) does not have ordnance ready this tick.`);\r\n        }\r\n\r\n\r\n        // debugger;\r\n    }\r\n\r\n    public static declareWar(args: { declaringPlayer: AbstractPlayer }) {\r\n\r\n        console.log(`GameLogic.ts: declareWar: A player declared war:`, { declaringPlayer: args.declaringPlayer });\r\n\r\n        args.declaringPlayer.declaredWar = true; // Gives a first-strike bonus but world opinion takes a  hit\r\n\r\n        Game.getInstance().isPeacetime = false;\r\n        Game.getInstance().isWartime = true;\r\n\r\n        this.notifyGamestateChange({ details: { changeLabel: \"War Declared\" } });\r\n\r\n    }\r\n\r\n    public static finishHumanTurn(): void {\r\n        Game.getInstance().currentPlayer = Game.getInstance().computerPlayer;\r\n        this.playComputerTurn();\r\n        Game.getInstance().currentPlayer = Game.getInstance().humanPlayer;\r\n    }\r\n\r\n    public static finishComputerTurn(): void {\r\n        Game.getInstance().currentPlayer = Game.getInstance().humanPlayer;\r\n        this.notifyGamestateChange({ details: { changeLabel: \"Advance Turn\" } });\r\n    }\r\n\r\n    public static advanceTurn(): void {\r\n\r\n        const game = Game.getInstance();\r\n\r\n        game.turn++;\r\n\r\n        console.log(`GameLogic.ts: advanceTurn: new game turn / year:`, { turn: game.turn, year: game.gameYear });\r\n\r\n        this.notifyGamestateChange({ details: { changeLabel: \"Advance Turn\" } });\r\n\r\n        return;\r\n\r\n    }\r\n\r\n    public static spyOnPlayer(args: {targetPlayer: AbstractPlayer, spyLevel: 1 | 2}) {\r\n\r\n        console.log(`Gamelogic: spyOnPlayer: entering, target:`, args.targetPlayer);\r\n\r\n        /*\r\n            Principles:\r\n            - Tech (concealment and discovery) improves all the time\r\n            - Older bases are less easy to conceal\r\n            - Newer bases are easier to conceal\r\n            - When spying in 1990, it's easier to find opponent's bases then it is in 1945\r\n            - Towns and cities are never hidden\r\n\r\n            On any given turn, you can discover up to two bases depending on spy level.\r\n        */\r\n\r\n        const allMilitaryBases = MapUtil.allMilitaryBases({forMap: args.targetPlayer.map});\r\n\r\n        const game = Game.getInstance();\r\n\r\n        for (let i = 0; i < allMilitaryBases.length; i++) {\r\n            \r\n            const base = allMilitaryBases[i];\r\n\r\n            console.log(`GameLogic: spyOnPlayer: spying on a base:`, {base: base});\r\n\r\n            // New bases are harder to find.\r\n            const baseConcealmentFactor = base.yearBuilt - GameRules.GameStartYear; // gives a value like: 1950 - 1945 = 5\r\n            \r\n            // If this turn is a spying turn, you get a bonus..\r\n            const baseSpyFactor = args.spyLevel === 1 ? 1.1 : 1.25; \r\n\r\n            // As time goes on, you get better at spying at baseline.\r\n            const spyTechnologyFactor = (game.gameYear - GameRules.GameStartYear) * baseSpyFactor; // ex: (1950 - 1945) * 1.1 = 5.5\r\n            \r\n            const spyAmount = spyTechnologyFactor - baseConcealmentFactor; // 5.5 - 5 = 0.5\r\n\r\n            allMilitaryBases[i].myMapLocation.enemyVisibility += Math.ceil(spyAmount);\r\n\r\n        }\r\n\r\n        const tryFindBase = (forBase: NonNullMilitaryBaseTypes) => {\r\n            const didFind = Rng.throwDice({hiNumberMinus1: 100}) < forBase.myMapLocation.enemyVisibility;\r\n            if (didFind) { forBase.myMapLocation.enemyVisibility =100 }\r\n        }\r\n\r\n        tryFindBase(Rng.pickRandomFromArray({sourceArray: allMilitaryBases}));\r\n\r\n        if (args.spyLevel > 1) {\r\n            tryFindBase(Rng.pickRandomFromArray({sourceArray: allMilitaryBases}));\r\n        }\r\n        \r\n    }\r\n\r\n    public static getNameForNameableItem(args: {fromNamesArr: string[]}): getNameProcessResult {\r\n\r\n        const selectedNameIdx = Rng.throwDice({hiNumberMinus1: args.fromNamesArr.length});\r\n        \r\n        const emptyProcessResult: getNameProcessResult = \r\n        {\r\n            allOtherNames: [], \r\n            baseName: \"\"\r\n        };\r\n        \r\n        const processedResult = args.fromNamesArr.reduce ((prev: getNameProcessResult, curr, idx) => {\r\n            \r\n            if (idx === selectedNameIdx) return {allOtherNames: prev.allOtherNames, baseName: curr} as getNameProcessResult;\r\n\r\n            return {\r\n                allOtherNames: prev.allOtherNames.concat(curr),\r\n                baseName: prev.baseName\r\n            } as getNameProcessResult;\r\n        }, emptyProcessResult);\r\n\r\n        return processedResult;\r\n    }\r\n}","import { PopulationAreaTypeLabels } from \"./PopulationAreaTypes\";\r\n\r\nexport interface PopulationAreaProperties {\r\n    Name: string;\r\n    Population: number;\r\n    WorldObjectLabel: PopulationAreaTypeLabels;\r\n}\r\n\r\nexport abstract class AbstractPopulationArea implements PopulationAreaProperties {\r\n\r\n    public Name: string;\r\n    public Population: number;\r\n    abstract WorldObjectLabel: PopulationAreaTypeLabels;\r\n\r\n    constructor() {\r\n        this.Name = \"\";\r\n        this.Population = 0;\r\n    }\r\n\r\n}","import { AbstractPopulationArea } from \"./AbstractPopulationArea\";\r\nimport { PopulationAreaTypeLabels } from \"./PopulationAreaTypes\";\r\n\r\nexport class City extends AbstractPopulationArea {\r\n\r\n    public readonly WorldObjectLabel: PopulationAreaTypeLabels = \"City\";\r\n\r\n    constructor(args: {name: string, population: number}) {\r\n        super();\r\n\r\n        this.Name = args.name;\r\n        this.Population = args.population;\r\n    }\r\n}\r\n","import { AbstractPopulationArea } from \"./AbstractPopulationArea\";\r\nimport { PopulationAreaTypeLabels } from \"./PopulationAreaTypes\";\r\n\r\nexport class RuralArea extends AbstractPopulationArea {\r\n\r\n    public readonly WorldObjectLabel: PopulationAreaTypeLabels = \"Rural\";\r\n\r\n    constructor(args: {name: string, population: number}) {\r\n        super();\r\n\r\n        this.Name = args.name;\r\n        this.Population = args.population;\r\n    }\r\n}\r\n","import { AbstractPopulationArea } from \"./AbstractPopulationArea\";\r\nimport { PopulationAreaTypeLabels } from \"./PopulationAreaTypes\";\r\n\r\nexport class MajorTown extends AbstractPopulationArea {\r\n\r\n    public readonly WorldObjectLabel: PopulationAreaTypeLabels = \"Town\";\r\n\r\n    constructor(args: {name: string, population: number}) {\r\n        super();\r\n\r\n        this.Name = args.name;\r\n        this.Population = args.population;\r\n    }\r\n}\r\n","import { AbstractPopulationArea } from \"../Entities/WorldObjects/PopulationCenters/AbstractPopulationArea\";\r\nimport { PopulationAreaTypeLabels } from \"../Entities/WorldObjects/PopulationCenters/PopulationAreaTypes\";\r\nimport { City } from \"../Entities/WorldObjects/PopulationCenters/City\";\r\nimport { RuralArea } from \"../Entities/WorldObjects/PopulationCenters/Rural\";\r\nimport { MajorTown } from \"../Entities/WorldObjects/PopulationCenters/MajorTown\";\r\nimport { Rng } from \"../Utils/Rng\";\r\n\r\nexport class PopulationAreaFactory {\r\n\r\n    private static instance: PopulationAreaFactory;\r\n\r\n    private readonly msh = \"PopulationAreaFactory: \";\r\n\r\n    private nextPopulationAreaID: number = 0;\r\n\r\n    constructor() {\r\n        \r\n    }\r\n\r\n    public static getInstance() : PopulationAreaFactory {\r\n\r\n        if (!this.instance) {\r\n            this.instance = new PopulationAreaFactory();\r\n        }\r\n\r\n        return this.instance;\r\n    }\r\n\r\n    private newName(args: {forPopulationArea: AbstractPopulationArea}) {\r\n        console.log(`${this.msh}: newName: typeof base:`, args.forPopulationArea.WorldObjectLabel);\r\n        return 'xyzzy';\r\n    }\r\n\r\n    public createNewPopulationArea(args: {popAreaType: PopulationAreaTypeLabels}) {\r\n\r\n        // console.log(`PopulationAreaFactory: Entering, creating a pop area:`, args.popAreaType);\r\n        \r\n        switch(args.popAreaType) {\r\n\r\n            case \"City\": {\r\n                const newPopulationArea = new City({\r\n                    name: \"xyzzy\",\r\n                    population: Rng.throwDice({hiNumberMinus1: 6500000}) + 6000000\r\n                });\r\n                return newPopulationArea;\r\n            }\r\n            \r\n            case \"Rural\": {\r\n                const newPopulationArea = new RuralArea({\r\n                    name: \"xyzzy\",\r\n                    population: Rng.throwDice({hiNumberMinus1: 1000}) + 1000\r\n                });\r\n                return newPopulationArea;\r\n            }\r\n            \r\n            case \"Town\": {\r\n                const newPopulationArea = new MajorTown({\r\n                    name: \"xyzzy\",\r\n                    population: Rng.throwDice({hiNumberMinus1: 50000}) + 10000\r\n                });\r\n                return newPopulationArea;\r\n            }\r\n            \r\n        }\r\n\r\n        return new RuralArea({name: \"Error\", population: -1})\r\n    }\r\n\r\n}","import { AbstractMapLocation } from \"./AbstractMapLocation\";\r\nimport { PlaceableObject } from \"./PlaceableObjects\";\r\nimport { RuralArea } from \"../WorldObjects/PopulationCenters/Rural\";\r\nimport { MilitaryBaseTypeLabels, MilitaryBaseTypes } from \"../WorldObjects/Bases/MilitaryBaseTypes\";\r\nimport { PopulationAreaTypes } from \"../WorldObjects/PopulationCenters/PopulationAreaTypes\";\r\nimport { CountryMap } from \"../WorldObjects/CountryMap\";\r\n\r\nexport class MapLocation extends AbstractMapLocation {\r\n \r\n    public Contents!: MilitaryBaseTypes | PopulationAreaTypes;\r\n    public uniqueID: number = 0;\r\n    \r\n    public nuclearStrikes: number;\r\n    public myMap: CountryMap;\r\n    private static nextID: number = 1;\r\n    public population: number;\r\n\r\n    constructor(args: {onMap: CountryMap}) {\r\n        super();\r\n        this.Contents = new RuralArea({name: \"Empty\", population: 0});\r\n        this.uniqueID = MapLocation.nextID++;\r\n        this.isTargeted = false;\r\n        this.nuclearStrikes = 0;\r\n        this.myMap = args.onMap;\r\n        this.population = 0;\r\n    }\r\n\r\n    public placeItem(args: {itemToPlace: PlaceableObject}): void {\r\n        this.Contents = args.itemToPlace;\r\n        \r\n        const {itemToPlace} = args;\r\n\r\n        if (itemToPlace && \r\n                (itemToPlace.WorldObjectLabel === \"City\" || \r\n                 itemToPlace.WorldObjectLabel === \"Town\"))\r\n        {\r\n            this.enemyVisibility = 100;\r\n        }\r\n\r\n    }\r\n    \r\n    public isMilitaryBase() {\r\n\r\n        const militaryLabels: MilitaryBaseTypeLabels[] = [\r\n            \"ABM\", \"Air\", \"Army\", \"Missile\", \"Navy\", \"Radar\"\r\n        ];\r\n\r\n        return militaryLabels.filter(ml => this.Contents !== null &&  ml === this.Contents.WorldObjectLabel).length > 0;\r\n    }\r\n}","import { MilitaryBaseTypes } from \"../WorldObjects/Bases/MilitaryBaseTypes\";\r\nimport { PopulationAreaTypes } from \"../WorldObjects/PopulationCenters/PopulationAreaTypes\";\r\nimport { CountryMap } from \"../WorldObjects/CountryMap\";\r\n\r\nexport abstract class AbstractMapLocation {\r\n    \r\n    abstract Contents: MilitaryBaseTypes | PopulationAreaTypes;\r\n    \r\n    public isTargeted: boolean = false;\r\n    abstract myMap: CountryMap;\r\n    abstract population: number;\r\n\r\n    public enemyVisibility: number;\r\n\r\n    constructor() {\r\n        // this.Contents = null;\r\n        this.enemyVisibility = 0;\r\n    }\r\n}\r\n","import { PopulationAreaFactory } from \"../../Factories/PopulationAreaFactory\";\r\nimport { MapLocation } from \"../MapObjects/MapLocation\";\r\nimport { MilitaryBaseTypes } from \"./Bases/MilitaryBaseTypes\";\r\nimport { AbstractPlayer } from \"../../Game/AbstractPlayer\";\r\nimport { AbmBase } from \"./Bases/AbmBase\";\r\nimport { Rng } from \"../../Utils/Rng\";\r\nimport { Constants } from \"../../Game/constants\";\r\nimport { constants } from \"os\";\r\n\r\nexport class CountryMap {\r\n\r\n    private sizeX: number;\r\n    private sizeY: number;\r\n    public owner: \"Computer\" | \"Human\";\r\n    public map: MapLocation[][]\r\n    public owningPlayer: AbstractPlayer;\r\n\r\n    private readonly newRuralArea = () => PopulationAreaFactory.getInstance().createNewPopulationArea({popAreaType: \"Rural\"});\r\n    private readonly newCity = () => PopulationAreaFactory.getInstance().createNewPopulationArea({popAreaType: \"City\"});\r\n\r\n    constructor(args: {sizeX: number, sizeY: number, ownerLabel: \"Computer\" | \"Human\", owningPlayer: AbstractPlayer}) {\r\n\r\n        this.sizeX = args.sizeX;\r\n        this.sizeY = args.sizeY;\r\n        this.map = [[]];\r\n        this.owner = args.ownerLabel;\r\n        this.owningPlayer = args.owningPlayer;\r\n\r\n        this.initializeMap();\r\n\r\n    }\r\n\r\n    public logDetailedMapToConsole() {\r\n\r\n        console.log(`WorldMap.ts: logSelfToConsole: logging map:`, {map: this.map});\r\n        \r\n        for (let i = 0; i < this.map.length; i++) {\r\n            console.table(this.map[i]);\r\n        }\r\n    }\r\n\r\n    private initializeMap() {\r\n\r\n        console.log(`CountryMap: initializeMap: Entering, my sizex/sizey:`, this.sizeX, this.sizeY, this.owner);\r\n\r\n        // First, create sizeX by sizeY  collection of negligble population centers\r\n        for (let x = 0; x < this.sizeX; x++) {\r\n\r\n            this.map.push([]);\r\n\r\n            for (let y = 0; y < this.sizeY; y++) {\r\n\r\n                const mi = new MapLocation({onMap: this});\r\n                mi.Contents = this.newRuralArea();\r\n\r\n                this.map[x].push(mi);\r\n            }\r\n        }\r\n\r\n        // Place cities.\r\n        let citiesToPlace: number = Rng.throwDice({hiNumberMinus1: Constants.MAX_INITIAL_CITIES - Constants.MIN_INITIAL_CITIES}) + Constants.MIN_INITIAL_CITIES;\r\n\r\n        while (citiesToPlace > 0) {\r\n\r\n            const tryX = Rng.throwDice({hiNumberMinus1: this.sizeX - 1});\r\n            const tryY = Rng.throwDice({hiNumberMinus1: this.sizeY - 1});\r\n\r\n            const mi: MapLocation = this.map[tryX][tryY];\r\n\r\n            if (mi.Contents.WorldObjectLabel === \"Rural\") {\r\n                citiesToPlace --;\r\n                mi.Contents = this.newCity();\r\n            }\r\n\r\n        }\r\n\r\n        \r\n    }\r\n\r\n    public getAllMilitaryBases(): Exclude<MilitaryBaseTypes, null>[] {\r\n        \r\n        const baseLocationsInRow = (mapRow: MapLocation[]) => mapRow.filter(mapCell => mapCell.isMilitaryBase());\r\n\r\n        const bases = this.map.map(mapRow => baseLocationsInRow(mapRow).map(mapRow => mapRow.Contents) as MilitaryBaseTypes[]);\r\n\r\n        var flattendedBases = [].concat.apply([], bases) as Exclude<MilitaryBaseTypes, null>[];\r\n\r\n        return flattendedBases;\r\n\r\n    }\r\n\r\n    public getAllABMBases(): AbmBase[] {\r\n        return this.getAllMilitaryBases().filter(b => b.WorldObjectLabel === \"ABM\") as AbmBase[];\r\n    }\r\n\r\n    public getRandomLocation() {\r\n        const x = Rng.throwDice({hiNumberMinus1: this.map.length - 1});\r\n        const y = Rng.throwDice({hiNumberMinus1: this.map.length - 1});\r\n\r\n        return (\r\n            this.map[x][y]\r\n         );\r\n    }\r\n}","import { AbstractPlayer } from \"./AbstractPlayer\";\r\nimport { GameRules, strategicMoveOptions, tacticalMoveOptions } from \"./GameRules\";\r\nimport { GamestateWatcher, gameStateChangeDetails, GameLogic } from \"./GameLogic\";\r\nimport { CountryMap } from \"../Entities/WorldObjects/CountryMap\";\r\nimport { Rng } from \"../Utils/Rng\";\r\nimport { MilitaryBaseFactory } from \"../Factories/MilitaryBaseFactory\";\r\nimport { Game } from \"../Entities/gameEntity\";\r\nimport { MapUtil } from \"../Utils/MapUtils\";\r\nimport { Constants } from \"./constants\";\r\n\r\ninterface peaceTimeSentimentMapping {\r\n    percentBuildStart: number,\r\n    percentDeclareWarStart: number,\r\n    percentSpyStart: number;\r\n}\r\n\r\n/*\r\n    Underinformed: doesn't know enough about enemy map\r\n    Falling Behind: doesn't think it has enough bases\r\n    Confident: feels good about the mix of things.\r\n*/\r\ntype sentiments =  \"Underinformed\" | \"Falling Behind\" | \"Confident\";\r\n\r\nexport class ComputerPlayer extends AbstractPlayer implements GamestateWatcher {\r\n\r\n    public totalFunctionalPassiveRadarStations: number;\r\n    public totalFunctionalActiveRadarStations: number;\r\n\r\n    public declaredWar: boolean;\r\n    public Name: string;\r\n    public map: CountryMap;\r\n    public totalCausualties: number = 0;\r\n\r\n    private sentimentMap: Map<sentiments,peaceTimeSentimentMapping>;\r\n\r\n    constructor() {\r\n\r\n        super({ isHuman: false });\r\n\r\n        GameLogic.registerGamestateWatcher({ watcher: this });\r\n\r\n        this.map = new CountryMap({ sizeX: 10, sizeY: 10, ownerLabel: \"Computer\", owningPlayer: this});\r\n        this.Name = \"Computer\";\r\n        this.declaredWar = false;\r\n        this.totalFunctionalActiveRadarStations = 0;\r\n        this.totalFunctionalPassiveRadarStations = 0;\r\n        this.totalCausualties = 0;\r\n\r\n        MapUtil.createTestBases({ onMap: this.map });\r\n\r\n        this.sentimentMap = new Map<sentiments, peaceTimeSentimentMapping>();\r\n        this.sentimentMap.set(\"Underinformed\", {percentBuildStart: 25, percentSpyStart: 26, percentDeclareWarStart: 99});\r\n        this.sentimentMap.set(\"Falling Behind\", {percentBuildStart: 75, percentSpyStart: 76, percentDeclareWarStart: 99});\r\n        this.sentimentMap.set(\"Confident\", {percentBuildStart: 49, percentSpyStart: 50, percentDeclareWarStart: 98});\r\n        \r\n    }\r\n\r\n    public handleGamestateChange(args: { details: gameStateChangeDetails }) {\r\n\r\n        // console.log(`ComputerPlayer.ts: handleGamestateChange: Got a game state change:`, {details: args.details});\r\n\r\n    }\r\n\r\n    public playTurn() {\r\n\r\n        const game = Game.getInstance();\r\n\r\n        if (game.isPeacetime) {\r\n            this.playPeacefulTurn();\r\n            setTimeout(() => {\r\n                GameLogic.advanceTurn();\r\n            }, 500);\r\n        }\r\n\r\n        if (game.isWartime) {\r\n            this.playWarTurn();\r\n        }\r\n\r\n    }\r\n\r\n    private static testGuard: boolean = false;\r\n\r\n    private playWarTurn() {\r\n\r\n        if (ComputerPlayer.testGuard) { return; }\r\n\r\n        console.log(`ComputerPlayer: playWarTurn: Entering.`);\r\n\r\n        ComputerPlayer.testGuard = true;\r\n\r\n        // tests\r\n        this.radarTest();\r\n\r\n        this.missileTest();\r\n\r\n        this.airBaseTest();\r\n\r\n        this.navyBaseTest();\r\n\r\n        this.armyBaseTest();\r\n\r\n        this.abmBaseTest();\r\n    }\r\n\r\n    private abmBaseTest() {\r\n\r\n        console.log(`ComputerPlayer.ts: abmBaseTest: entering.`);\r\n\r\n        const myMapSummary = MapUtil.getMapSummary({ forMap: this.map });\r\n\r\n        if (myMapSummary.allAbmBases.length < 1) { return; }\r\n\r\n        console.log(`ComputerPlayer.ts: abmBaseTest: testing abm base:`, myMapSummary.allAbmBases[0]);\r\n\r\n        const abmbase1 = myMapSummary.allAbmBases[0];\r\n        GameLogic.activateAbmBase({ forBase: abmbase1 });\r\n\r\n    }\r\n\r\n    private armyBaseTest() {\r\n\r\n        console.log(`ComputerPlayer.ts: armyBaseTest: entering.`);\r\n\r\n        const myMapSummary = MapUtil.getMapSummary({ forMap: this.map });\r\n\r\n        if (myMapSummary.allArmyBases.length < 1) { return; }\r\n\r\n        console.log(`ComputerPlayer.ts: armyBaseTest: testing army base:`, myMapSummary.allArmyBases[0]);\r\n\r\n        const armybase1 = myMapSummary.allArmyBases[0];\r\n        GameLogic.activateArmyBase({ forBase: armybase1 });\r\n\r\n    }\r\n\r\n    private missileTest() {\r\n        const myMapSummary = MapUtil.getMapSummary({ forMap: this.map });\r\n\r\n        if (myMapSummary.allMissileBases.length < 1) { return; }\r\n\r\n        const missile1 = myMapSummary.allMissileBases[0];\r\n\r\n        GameLogic.activateMissileBase({ forBase: missile1 });\r\n\r\n        console.log(`ComputerPlayer.ts: missileTest: Activated a missile:`, { missile: missile1 });\r\n\r\n        missile1.ordnance.forEach((o) => {\r\n            GameLogic.handleMissileTargeted(\r\n                {\r\n                    attackingPlayer: this,\r\n                    atMapLocation: this.getRandomLocation({ fromMap: Game.getInstance().humanPlayer.map }),\r\n                    targetingOrdnance: o\r\n                });\r\n\r\n            console.log(`ComputerPlayer.ts: missileTest: targeted missile ordnance:`, o);\r\n        })\r\n\r\n    }\r\n\r\n    private navyBaseTest() {\r\n        const myMapSummary = MapUtil.getMapSummary({ forMap: this.map });\r\n\r\n        if (myMapSummary.allNavyBases.length < 1) { return; }\r\n\r\n        const navyBase = myMapSummary.allNavyBases[0];\r\n\r\n        GameLogic.activateNavyBase({ forBase: navyBase });\r\n\r\n        console.log(`ComputerPlayer.ts: navyBaseTest: Activated a Navy base:`, { base: navyBase });\r\n\r\n        navyBase.ordnance.forEach((o) => {\r\n            GameLogic.handleMissileTargeted(\r\n                {\r\n                    attackingPlayer: this,\r\n                    atMapLocation: this.getRandomLocation({ fromMap: Game.getInstance().humanPlayer.map }),\r\n                    targetingOrdnance: o\r\n                });\r\n        })\r\n    }\r\n\r\n    private airBaseTest() {\r\n        const myMapSummary = MapUtil.getMapSummary({ forMap: this.map });\r\n\r\n        if (myMapSummary.allAirBases.length < 1) { return; }\r\n\r\n        const airBase = myMapSummary.allAirBases[0];\r\n\r\n        GameLogic.activateAirBase({ forBase: airBase });\r\n\r\n        console.log(`ComputerPlayer.ts: airBaseTest: Activated an air base:`, { base: airBase });\r\n\r\n        airBase.ordnance.forEach((o) => {\r\n            GameLogic.handleMissileTargeted(\r\n                {\r\n                    attackingPlayer: this,\r\n                    atMapLocation: this.getRandomLocation({ fromMap: Game.getInstance().humanPlayer.map }),\r\n                    targetingOrdnance: o\r\n                });\r\n        })\r\n    }\r\n\r\n    private radarTest() {\r\n\r\n        console.log(`ComputerPlayer.ts: radarTest: entering.`);\r\n\r\n        const myMapSummary = MapUtil.getMapSummary({ forMap: this.map });\r\n\r\n        if (myMapSummary.allRadarBases.length < 1) { return; }\r\n\r\n        console.log(`ComputerPlayer.ts: radarTest: testing radar1.`);\r\n\r\n        const radar1 = myMapSummary.allRadarBases[0];\r\n        radar1.setModeOfOperation({ mode: \"Active\" });\r\n        GameLogic.activateRadarBase({ forBase: radar1 });\r\n\r\n        if (myMapSummary.allRadarBases.length < 2) { return; }\r\n\r\n        console.log(`ComputerPlayer.ts: radarTest: testing radar2.`);\r\n\r\n        const radar2 = myMapSummary.allRadarBases[1];\r\n        radar2.setModeOfOperation({ mode: \"Passive\" });\r\n        GameLogic.activateRadarBase({ forBase: radar2 });\r\n\r\n    }\r\n\r\n    private calculateCurrentSentiment(): sentiments {\r\n\r\n        const game = Game.getInstance();\r\n\r\n        const opm = game.humanPlayer.map;\r\n\r\n        // Figure out how many known/suspected bases there are.\r\n        const suspectedBasesCount = opm.getAllMilitaryBases().filter(b => b.myMapLocation.enemyVisibility > Constants.PCT_VISIBLE_SENTIMENT_THRESHOLD).length;\r\n\r\n        const expectedBaseCount = Math.ceil( (game.gameYear - GameRules.GameStartYear) * Constants.EXPECTED_BASE_COUNT_FACTOR);\r\n\r\n        let result: sentiments;\r\n\r\n        // If we expect [x] bases but there are more than that many suspected then we're falling behind.\r\n        if (expectedBaseCount > (suspectedBasesCount * 2)) result = \"Falling Behind\";\r\n        else if (expectedBaseCount > (suspectedBasesCount * 3)) result = \"Underinformed\";\r\n        else result = \"Confident\";\r\n\r\n        console.log(`ComputerPlayer.ts: calculateCurrentSentiment: suspected bases, expected bases:`, {sentiment: result, expectedBaseCount: expectedBaseCount, suspected: suspectedBasesCount});\r\n\r\n        return result;\r\n     }\r\n\r\n    private playPeacefulTurn() {\r\n\r\n        /*\r\n            Principles:\r\n\r\n            At a high level, computer should:\r\n                - Declare war if it's feeling very confident or at a significant disadvantage\r\n                - It should spy if it feels like it doesn't have enough information about the other player\r\n                - It should build if it feels \"OK\"\r\n\r\n            So, it knows that at most, there are going to be 2x bases times game years.\r\n            It can assess where it stands on that number over time and aim to be at like 1.5 or 1.75 total bases per game year\r\n\r\n            It can look at what it \"knows\" about the opponent and if doesn't know enough, it gets nervous.\r\n                - Make a \"target knowns\" per year\r\n                - Later years, it expects to know about [x] amount of bases that the user has\r\n\r\n            Idea:\r\n            - determine current sentiment\r\n            - get a lookup table based on sentiment\r\n            - pick a random number and looku up a choice based on that.\r\n\r\n        */\r\n        const availableStrategicChoices = GameRules.getAllowedMoves().strategicOptions;\r\n\r\n        const sentiment = this.calculateCurrentSentiment();\r\n\r\n        const sentimentTable: Exclude<peaceTimeSentimentMapping,undefined> = <Exclude<peaceTimeSentimentMapping,undefined>>this.sentimentMap.get(sentiment);\r\n\r\n        const tablelookupVal = Rng.throwDice({hiNumberMinus1: 99});\r\n\r\n        const strategicChoice: strategicMoveOptions = \r\n           tablelookupVal >= sentimentTable.percentDeclareWarStart \r\n            ? \"Declare War\" \r\n            : tablelookupVal >= sentimentTable.percentSpyStart\r\n                ? \"Spy\"\r\n                : \"Build\";\r\n\r\n        // Need to pick a strategic choice\r\n        // const choice = <strategicMoveOptions>Rng.pickRandomFromArray({ sourceArray: availableStrategicChoices });\r\n\r\n        console.log(`ComputerPlayer: playTurn: my strategic choice is:`, strategicChoice);\r\n\r\n        if (strategicChoice === \"Build\") {\r\n            GameLogic.spyOnPlayer({targetPlayer: Game.getInstance().humanPlayer, spyLevel: 1})\r\n            this.buildBases({ numberToBuild: 2, allowedBases: GameRules.getAllowedMoves().tacticalOptions });\r\n        }\r\n\r\n        else if (strategicChoice === \"Spy\") {\r\n            GameLogic.spyOnPlayer({targetPlayer: Game.getInstance().humanPlayer, spyLevel: 2})\r\n            this.buildBases({ numberToBuild: 1, allowedBases: GameRules.getAllowedMoves().tacticalOptions });\r\n        }\r\n\r\n        else if (strategicChoice === \"Declare War\") {\r\n            console.log(`ComputerPlayer.ts: playTurn: Declaring war!`);\r\n        }\r\n        else {\r\n            console.log(`ComputerPlayer.ts: playTurn: skipping my turn.`);\r\n        }\r\n\r\n    }\r\n\r\n    private buildBases(args: { numberToBuild: number, allowedBases: tacticalMoveOptions[] }) {\r\n\r\n        console.log(`ComputerPlayer.ts: buildBases: Entering, will build ${args.numberToBuild} bases.`);\r\n\r\n        for (let i = 0; i < args.numberToBuild; i++) {\r\n\r\n            const toBuild = Rng.pickRandomFromArray({ sourceArray: args.allowedBases });\r\n            console.log(`ComputerPlayer.ts: buildBases: Entering, will build base:`, toBuild);\r\n\r\n            const mapLoc = this.getRandomLocation({ fromMap: this.map });\r\n\r\n            // const randX = Rng.throwDice({ hiNumberMinus1: 9 });\r\n            // const randY = Rng.throwDice({ hiNumberMinus1: 9 });\r\n\r\n            // const mapLoc = this.map.map[randX][randY];\r\n\r\n            const base = MilitaryBaseFactory.getInstance().createNewBase({ baseType: toBuild, atLocation: mapLoc });\r\n\r\n            if (base) { mapLoc.placeItem({ itemToPlace: base }); }\r\n        }\r\n\r\n        this.map.logDetailedMapToConsole();\r\n\r\n    }\r\n\r\n    private getRandomLocation(args: { fromMap: CountryMap }) {\r\n        const randX = Rng.throwDice({ hiNumberMinus1: 9 });\r\n        const randY = Rng.throwDice({ hiNumberMinus1: 9 });\r\n\r\n        return args.fromMap.map[randX][randY];\r\n    }\r\n}","import { AbstractPlayer } from \"./AbstractPlayer\";\r\nimport { CountryMap } from \"../Entities/WorldObjects/CountryMap\";\r\nimport { MapUtil } from \"../Utils/MapUtils\";\r\n\r\nexport class HumanPlayer extends AbstractPlayer  {\r\n    \r\n    public totalFunctionalPassiveRadarStations: number;\r\n    public totalFunctionalActiveRadarStations: number;\r\n    \r\n    public declaredWar: boolean;\r\n    public Name: string;\r\n    public map: CountryMap;\r\n    public totalCausualties: number = 0;\r\n\r\n     constructor() {\r\n        super({isHuman: true});\r\n\r\n        this.map = new CountryMap({sizeX: 10, sizeY: 10, ownerLabel: \"Human\", owningPlayer: this});\r\n        this.Name = \"Human\";\r\n        this.declaredWar = false;\r\n        this.totalFunctionalActiveRadarStations = 0;\r\n        this.totalFunctionalPassiveRadarStations = 0;\r\n        this.totalCausualties = 0;\r\n\r\n        MapUtil.createTestBases({onMap: this.map});\r\n    }\r\n\r\n}","import { Rng } from \"../Utils/Rng\";\r\n\r\nexport class GameData {\r\n\r\n\r\n    private static readonly allComputerNames = [\r\n        \"The Engine\",\r\n        \"Games Machine\",\r\n        \"Joe\",\r\n        \"MARAX\",\r\n        \"EPICAC\",\r\n        \"EMSIAC\",\r\n        \"The Prime Radiant\",\r\n        \"Mark V\",\r\n        \"Karl\",\r\n        \"Mimi\",\r\n        \"Gold\",\r\n        \"Bossy\",\r\n        \"The City Fathers\",\r\n        \"Multivac\",\r\n        \"The Central Computer\",\r\n        \"Vulcan 2\",\r\n        \"Vulcan 3\",\r\n        \"Great Coordinator\",\r\n        \"Merlin\",\r\n        \"GENiE\",\r\n        \"Colossus\",\r\n        \"Guardian\",\r\n        \"Frost\",\r\n        \"The Ox\",\r\n        \"Supreme\",\r\n        \"ZORAC\",\r\n        \"Deep Thought\",\r\n        \"Ghostwheel\",\r\n        \"Com Pewter\",\r\n        \"Mother\",\r\n        \"C Cube\",\r\n        \"Glooper\",\r\n        \"Lobsang\",\r\n        \"Hal\"\r\n    ];\r\n\r\n    \r\n    public static getRandomComputerPlayerName(): string {\r\n        return Rng.pickRandomFromArray({ sourceArray: this.allComputerNames });\r\n    }\r\n\r\n}","import { ComputerPlayer } from \"../Game/ComputerPlayer\";\r\nimport { HumanPlayer } from \"../Game/HumanPlayer\";\r\nimport { GameLogic } from \"../Game/GameLogic\";\r\nimport { AbstractPlayer } from \"../Game/AbstractPlayer\";\r\nimport { GameData } from \"../Data/ComputerNames\";\r\nimport { GameRules } from \"../Game/GameRules\";\r\n\r\nexport interface GameEntity {\r\n    gameYear: number;\r\n}\r\n\r\nexport abstract class AbstractGameEntity implements GameEntity {\r\n    abstract gameYear: number;\r\n}\r\n\r\nexport class Game extends AbstractGameEntity {\r\n\r\n    private static instance: Game;\r\n\r\n    public isPeacetime: boolean = true;\r\n    public isWartime: boolean = false;\r\n    \r\n    public turn: number = 0;\r\n    public get gameYear() { return this.turn + GameRules.GameStartYear;}\r\n    \r\n    public computerPlayer!: ComputerPlayer;\r\n    public humanPlayer!: HumanPlayer;\r\n    public currentPlayer!: AbstractPlayer;\r\n\r\n    private constructor() {\r\n        super();\r\n\r\n    }\r\n\r\n    private initializeGame() {\r\n        this.computerPlayer = new ComputerPlayer();\r\n        this.computerPlayer.Name = GameData.getRandomComputerPlayerName();\r\n        this.humanPlayer = new HumanPlayer();\r\n        this.currentPlayer = this.humanPlayer;\r\n    }\r\n\r\n    public static getInstance() {\r\n        \r\n        if (! this.instance) {\r\n            this.instance = new Game();\r\n            this.instance.initializeGame();\r\n        }\r\n\r\n        return this.instance;\r\n    }\r\n\r\n    public startGame() {\r\n        \r\n        GameLogic.startClock();\r\n    }\r\n}","import React, { Component } from 'react';\r\n\r\ninterface props {\r\n    tickerMessage: string;\r\n    tickerInterval: number;\r\n    onRenderCompleteCallback?: () => void;\r\n}\r\n\r\ninterface state {\r\n}\r\n\r\nexport class TickerComponent extends Component<props, state> {\r\n\r\n    private idx: number = 0;\r\n    private static nextHtmlID: number = 0;\r\n\r\n    constructor(props: props, state: state) {\r\n        super(props, state);\r\n    }\r\n\r\n    showMessage(forHtmLID: string) {\r\n\r\n        const msgTextElem = document.getElementById(forHtmLID);\r\n        if (msgTextElem) {\r\n            msgTextElem.innerHTML = \"&nbsp;\";\r\n        }\r\n\r\n        this.idx = 0;\r\n\r\n        const intervalHandler = setInterval(() => {\r\n            if (msgTextElem) {\r\n                msgTextElem.innerHTML = this.props.tickerMessage.substring(0, this.idx++) + \"█\";\r\n            }\r\n        }, this.props.tickerInterval);\r\n\r\n        setTimeout(() => {\r\n            // console.log(\"clearing\");\r\n            clearInterval(intervalHandler);\r\n            if (msgTextElem) {\r\n                msgTextElem.innerHTML = this.props.tickerMessage;\r\n            }\r\n            if (this.props.onRenderCompleteCallback) {this.props.onRenderCompleteCallback()};\r\n\r\n        }, this.props.tickerInterval * this.props.tickerMessage.length + this.props.tickerInterval * 3);\r\n\r\n    }\r\n\r\n    render() {\r\n\r\n        const htmlID = `ticker_${TickerComponent.nextHtmlID++}`;\r\n        // console.log(`TickerComponent: render: Entering.`);\r\n\r\n        // Give the ticker a moment to get started.\r\n        setTimeout(() => {\r\n            this.showMessage(htmlID);\r\n        }, 50);\r\n\r\n        return (\r\n            <span id={htmlID}></span>\r\n        );\r\n\r\n    }\r\n}\r\n","import React, { Component } from 'react';\r\nimport { Game } from '../Entities/gameEntity';\r\nimport { GamestateWatcher, GameLogic, gameStateChangeDetails } from '../Game/GameLogic';\r\nimport { TickerComponent } from './TickerComponent';\r\nimport { Constants } from '../Game/constants';\r\nimport { BuildVersion } from '../Game/BuildVersion';\r\n\r\ninterface state {\r\n    yearMessage: string,\r\n}\r\n\r\ninterface props { }\r\n\r\nexport class GameHeaderComponent extends Component<props, state> implements GamestateWatcher {\r\n\r\n    constructor(props: props, state: state) {\r\n        super(props, state);\r\n\r\n        this.state = {\r\n            yearMessage: \"\",\r\n        }\r\n\r\n        // Tell the game logic guy that I want to know when impotant things change to game state.\r\n        GameLogic.registerGamestateWatcher({ watcher: this });\r\n    }\r\n\r\n    public handleGamestateChange(args: { details: gameStateChangeDetails }) {\r\n \r\n        // console.log(`GameHeaderComponent: handleGamestateChange: Got a game state change.`);\r\n\r\n        if (args.details.changeLabel === \"Advance Turn\" || args.details.changeLabel === \"War Declared\") {\r\n            this.forceUpdate();\r\n        }\r\n    }\r\n \r\n    render() {\r\n\r\n        console.log(`GameHeaderComponent: render: Entering.`);\r\n        const game: Game = Game.getInstance();\r\n\r\n        return (\r\n            <div className=\"gameYearContainer\">\r\n                {\r\n                    game.isPeacetime \r\n                        ? <TickerComponent tickerInterval={29} tickerMessage={`The year was ${game.gameYear}, a time of ${game.isPeacetime ? \"peace\" : \"war!\"}`} />\r\n                        : <TickerComponent tickerInterval={25} tickerMessage={`The year was ${game.gameYear}, where a state of WAR existed in the world.`} />\r\n\r\n                }\r\n            </div>\r\n        );\r\n\r\n    }\r\n}\r\n","import { withStyles, Button } from \"@material-ui/core\";\r\n\r\nexport class UIComponent {\r\n\r\npublic static GameButton = withStyles({\r\n    root: {\r\n    //   background: 'linear-gradient(45deg, #FE6B8B 30%, #FF8E53 90%)',\r\n      borderRadius: 3,\r\n      border: 0,\r\n      color: '#FFB000',\r\n      height: 48,\r\n      padding: '0 30px',\r\n      boxShadow: '0 3px 5px 2px rgba(255, 105, 135, .3)',\r\n    },\r\n    label: {\r\n      textTransform: 'capitalize',\r\n    },\r\n  })(Button);\r\n  \r\n}\r\n","import React, { Component, SyntheticEvent } from 'react';\r\nimport { tacticalMoveOptions } from '../Game/GameRules';\r\nimport { MilitaryBaseTypes } from '../Entities/WorldObjects/Bases/MilitaryBaseTypes';\r\nimport { MapLocation } from '../Entities/MapObjects/MapLocation';\r\nimport { TickerComponent } from './TickerComponent';\r\nimport { GamestateWatcher, gameStateChangeDetails, GameLogic } from '../Game/GameLogic';\r\nimport { Constants } from '../Game/constants';\r\nimport { Button } from '@material-ui/core';\r\nimport { buildBaseResult } from './MapComponents/MapComponent';\r\nimport { UIComponent } from './GameButton';\r\nimport { constants } from 'os';\r\n\r\ninterface props {\r\n    allowedBasesToBuild: tacticalMoveOptions[],\r\n    totalAllowedToBuild: number;\r\n}\r\n\r\ninterface buildSelection {\r\n    buildWhat: MilitaryBaseTypes | null;\r\n    buildWhere: MapLocation | null;\r\n    didBuild: boolean;\r\n    buildResultText: string | null;\r\n}\r\n\r\ninterface state {\r\n    buildManifest: buildSelection[];\r\n}\r\n\r\nexport class BuildManifestComponent extends Component<props, state> implements GamestateWatcher {\r\n\r\n    private uiIdx: number = 0;\r\n    private readonly uiKey = () => this.uiIdx++;\r\n    private readonly emptyManifestSelection: buildSelection = { buildWhat: null, buildWhere: null, didBuild: false, buildResultText: null };\r\n\r\n    constructor(props: props, state: state) {\r\n        super(props, state);\r\n\r\n        this.state = {\r\n            buildManifest: []\r\n        }\r\n\r\n        // Tell the game logic guy that I want to know when impotant things change to game state.\r\n        GameLogic.registerGamestateWatcher({ watcher: this });\r\n\r\n    }\r\n\r\n    public handleGamestateChange(args: { details: gameStateChangeDetails }) {\r\n        // console.log(`BuildManifestComponent.ts: handleGamestateChange: Got a game state change:`, {details: args.details});\r\n    }\r\n\r\n    componentDidMount() {\r\n\r\n        // console.log(`BuildManifestComponent: componentDidMount: state and props:`, { state: this.state, props: this.props});\r\n\r\n        this.setState({\r\n            buildManifest: new Array(this.props.totalAllowedToBuild).fill(this.emptyManifestSelection)\r\n        });\r\n\r\n    }\r\n\r\n    private handleDropResult(args: {result: buildBaseResult}) {\r\n        console.log(`BuidManifestComponent: handleDropResult: drop finished, result:`, args.result);\r\n        \r\n        this.setState({\r\n            buildManifest: this.state.buildManifest.reduce( (prev, curr, idx) => {\r\n\r\n                if (idx === args.result.manifestIndex) {\r\n                    const newBuildManfest: buildSelection = {\r\n                        buildWhat: null,\r\n                        buildWhere: null,\r\n                        didBuild: args.result.didSucceed,\r\n                        buildResultText: args.result.message\r\n                    }\r\n\r\n                    console.log(`BuidManifestComponent: handleDropResult: updated manifest:`, {updatedManifest: newBuildManfest});\r\n\r\n                    return prev.concat(newBuildManfest);\r\n                }\r\n                else {\r\n                    return prev.concat(curr);\r\n                }\r\n\r\n            }, [] as buildSelection[])\r\n        })\r\n    }\r\n\r\n    render() {\r\n\r\n        console.log(`BuildManifestComponent: render: Entering with props and state:`, {props: this.props, state: this.state});\r\n\r\n        const buildManifestCompletedMarkup = () => {\r\n            return (\r\n                <div>\r\n                    All base assignments complete.\r\n                    <UIComponent.GameButton onClick={\r\n                        () => {\r\n                            //console.log(`BuildManifestComponent: render: manifestCompleteMarkup: finish turn.`)\r\n                            GameLogic.finishHumanTurn();\r\n                        }}>\r\n                        Finish Turn</UIComponent.GameButton>\r\n                </div>\r\n            )\r\n        }\r\n\r\n        const dragStartMarkup = (args: {dragEvent: React.DragEvent, baseType: tacticalMoveOptions, manifestIndex: number}) => {\r\n            console.log(`BuildManifestComponent: tacticalOptionsMarkup: onDragStart: e, ab:`, \r\n            { \r\n                e: args.dragEvent, \r\n                ab: args.baseType,\r\n                manifestIndex: args.manifestIndex\r\n            });\r\n\r\n            args.dragEvent.dataTransfer.setData(Constants.DROPTYPE, Constants.BUILD_DROP);\r\n            args.dragEvent.dataTransfer.setData(Constants.BASETYPE, args.baseType as string);\r\n            args.dragEvent.dataTransfer.setData(Constants.MANIFESTINDEX, args.manifestIndex.toString());\r\n            \r\n            (window as any)[Constants.NOTIFY_BUILD_RESULT_CALLBACK_NAME] = this.handleDropResult.bind(this);\r\n        }\r\n\r\n        const allowedBaseMarkup = (args: {forManifestIndex: number}) => {\r\n            return (\r\n                this.props.allowedBasesToBuild.map((allowedBase, idx) => (\r\n                    <span key={this.uiKey()}\r\n                        draggable\r\n                        onDragStart={(e) => dragStartMarkup({baseType:allowedBase, dragEvent: e, manifestIndex: args.forManifestIndex})}\r\n                        onDragEnd={\r\n                            (e) => {\r\n                                console.log(`BuildManifestComponent: tacticalOptionsMarkup: onDragEnd: e, ab:`,\r\n                                    { e, ab: allowedBase }\r\n                                )\r\n                            }\r\n                        }\r\n                    >\r\n                        {individualAllowedBaseMarkup({forBaseType: allowedBase as string})}\r\n                </span>\r\n                )))\r\n        };\r\n\r\n        const individualAllowedBaseMarkup = (args: {forBaseType: string}) => {\r\n\r\n            const title = `${args.forBaseType} base`;\r\n            const baseTokenSrc = `images/baseTokens/${args.forBaseType}base.png`\r\n            return (<span className=\"allowedBase\" ><img src={baseTokenSrc} width=\"20\" height=\"20\" title={title}/> {args.forBaseType}</span>);\r\n        }   \r\n\r\n        const qtyMessage = () => {\r\n            return (\r\n                this.props.totalAllowedToBuild > 1\r\n                    ? <div>\r\n                        <TickerComponent tickerInterval={20} tickerMessage={`You are allowed to build ${this.props.totalAllowedToBuild} ${this.props.totalAllowedToBuild == 1 ? \"base\" : \"bases\"}.`} /></div>\r\n                    : <div>{`You are allowed to build 1 base.`}</div>\r\n            );\r\n        };\r\n\r\n        const manifestMarkup = () => {\r\n\r\n            console.log(`BuildManifestComponent: manifestMarkup: building up a selection:`, this.state.buildManifest);\r\n\r\n            return (<ol> { this.state.buildManifest.map((selection, idx) => individualManifestChoiceMarkup(selection, idx)) }</ol>)\r\n        }\r\n\r\n        const individualManifestChoiceMarkup = (selection: buildSelection, idx: number) => {\r\n\r\n            return (\r\n                <li key={this.uiKey()}>\r\n                {selection.didBuild ? selection.buildResultText : allowedBaseMarkup({forManifestIndex: idx})}\r\n                {/* Did Build? {selection.didBuild ? \"Yes\" : \"No\"} */}\r\n                {\r\n                    (selection.buildResultText && ! selection.didBuild) ? selection.buildResultText : null\r\n                }\r\n            </li>\r\n    );\r\n        }\r\n\r\n        const toRender = (\r\n            <React.Fragment>\r\n\r\n                {qtyMessage()}\r\n\r\n                {\r\n                    <div>\r\n                        <h5><TickerComponent tickerInterval={25} tickerMessage=\"Build manifest:\"/></h5>\r\n                        {manifestMarkup()}\r\n                    </div>\r\n                }\r\n\r\n                {\r\n                    this.state.buildManifest.filter(m => m.didBuild).length === this.state.buildManifest.length\r\n                        ? buildManifestCompletedMarkup()\r\n                        : null\r\n                }\r\n\r\n            </React.Fragment>\r\n        )\r\n\r\n        return toRender;\r\n    }\r\n}\r\n","import React, { Component } from 'react';\r\nimport { Button } from '@material-ui/core';\r\nimport { AbmBase } from '../../Entities/WorldObjects/Bases/AbmBase';\r\nimport { GameLogic } from '../../Game/GameLogic';\r\nimport { UIComponent } from '../GameButton';\r\n\r\ninterface props {\r\n    base: AbmBase;\r\n}\r\n\r\ninterface state {\r\n}\r\n\r\nexport class AbmBaseComponent extends Component<props, state> {\r\n\r\n    constructor(props: props, state: state) {\r\n        super(props, state);\r\n\r\n        this.state = {\r\n        }\r\n\r\n    }\r\n\r\n\r\n    componentDidMount() {\r\n\r\n        console.log(`AbmBaseComponent: componentDidMount: state and props:`, { state: this.state, props: this.props });\r\n\r\n    }\r\n\r\n    private activateAbmBase() {\r\n        GameLogic.activateAbmBase({ forBase: this.props.base });\r\n        this.forceUpdate();\r\n    }\r\n\r\n    render() {\r\n\r\n        const {base} = this.props;\r\n\r\n        const readyToActivateMarkup =\r\n            <React.Fragment>\r\n                <UIComponent.GameButton onClick={() => this.activateAbmBase()}>\r\n                    Enable Active Tracking\r\n                </UIComponent.GameButton>\r\n            </React.Fragment>;\r\n\r\n        const isTrackingMarkup =\r\n            <React.Fragment>\r\n                <span>\r\n                    {\r\n                        `Actively tracking incoming missiles and bombers, ${base.totalMissiles} missiles remain in arsenal.`\r\n                    }\r\n                </span>\r\n            </React.Fragment>;\r\n\r\n        const isNotReceivingOrdersMarkup =\r\n            <React.Fragment>\r\n                <span>Spinning up...</span>\r\n            </React.Fragment>;\r\n\r\n        const wrapper = (toWrap: JSX.Element) => {\r\n            return (\r\n                <div>\r\n                    <span>{`${base.WorldObjectLabel}: ${base.Name}`}</span>\r\n                    {toWrap}\r\n                </div>\r\n            )\r\n        };\r\n\r\n        const wasDestroyedMarkup = \r\n            <React.Fragment>\r\n                <span>ABM base ${base.Name} was destroyed.</span>\r\n            </React.Fragment>\r\n\r\n        if (base.wasDestroyed) { return wasDestroyedMarkup }\r\n\r\n        return (\r\n\r\n            this.props.base.isReceivingOrders\r\n                ? (\r\n                    this.props.base.isTracking ? wrapper(isTrackingMarkup) : wrapper(readyToActivateMarkup)\r\n                )\r\n                : wrapper(isNotReceivingOrdersMarkup)\r\n        );\r\n\r\n    };\r\n\r\n\r\n}\r\n","import React, { Component } from 'react';\r\nimport { RadarBase } from '../../Entities/WorldObjects/Bases/RadarBase';\r\nimport { Button } from '@material-ui/core';\r\nimport { GameLogic } from '../../Game/GameLogic';\r\nimport { MapLocation } from '../../Entities/MapObjects/MapLocation';\r\nimport { MapUtil } from '../../Utils/MapUtils';\r\nimport { UIComponent } from '../GameButton';\r\n\r\ninterface props {\r\n    base: RadarBase\r\n}\r\n\r\ninterface state {\r\n    didActivate: boolean;\r\n}\r\n\r\nexport class RadarBaseComponent extends Component<props, state> {\r\n\r\n    constructor(props: props, state: state) {\r\n        super(props, state);\r\n\r\n        this.state = {\r\n            didActivate: false\r\n        }\r\n\r\n    }\r\n\r\n    componentDidMount() {\r\n        console.log(`RadarBaseComponent: componentDidMount: state and props:`, { state: this.state, props: this.props });\r\n    }\r\n\r\n    render() {\r\n\r\n        const { base } = this.props;\r\n\r\n        const setMode = (args: { mode: \"Active\" | \"Passive\" }) => {\r\n            base.setModeOfOperation(args);\r\n            this.setState({ didActivate: true });\r\n            this.handleRaderPulser({ forBase: base });\r\n            GameLogic.activateRadarBase({ forBase: base });\r\n        }\r\n\r\n        const readyToActivateMarkup =\r\n            <React.Fragment>\r\n                <UIComponent.GameButton onClick={() => setMode({ mode: \"Active\" })}>Go Active</UIComponent.GameButton>\r\n                <UIComponent.GameButton onClick={() => setMode({ mode: \"Passive\" })}>Go Passive</UIComponent.GameButton>\r\n            </React.Fragment>;\r\n\r\n        const isActivatedMarkup =\r\n            <React.Fragment>\r\n                <span>Mode: {base.modeOfOperation} Tracking</span>\r\n            </React.Fragment>\r\n\r\n        const isNotReceivingOrdersMarkup =\r\n            <React.Fragment>\r\n                <span>Warming up...</span>\r\n            </React.Fragment>;\r\n\r\n        const wrapper = (toWrap: JSX.Element) => {\r\n            return (\r\n                <div>\r\n                    <span>{`${base.WorldObjectLabel}: ${base.Name}`}</span>\r\n                    {toWrap}\r\n                </div>\r\n            )\r\n        };\r\n\r\n        const wasDestroyedMarkup =\r\n            <React.Fragment>\r\n                <span>Radar base ${base.Name} was destroyed.</span>\r\n            </React.Fragment>\r\n\r\n        if (base.wasDestroyed) { return wasDestroyedMarkup }\r\n\r\n        return (\r\n            this.props.base.isReceivingOrders\r\n                ? (\r\n                    this.props.base.modeOfOperation === \"Inactive\" ? wrapper(readyToActivateMarkup) : wrapper(isActivatedMarkup)\r\n                )\r\n                : wrapper(isNotReceivingOrdersMarkup)\r\n        );\r\n    };\r\n\r\n    private handleRaderPulser(args: { forBase: RadarBase }) {\r\n\r\n        const mapLocElement = document.getElementById(MapUtil.getMapLocationHtmlID(args.forBase.myMapLocation));\r\n\r\n        const { modeOfOperation } = args.forBase;\r\n\r\n        const pulseUp = `${modeOfOperation === \"Active\" ? \"active\" : \"passive\"}RadarPulseUp`;\r\n        const pulseDown = `${modeOfOperation === \"Active\" ? \"active\" : \"passive\"}RadarPulseDown`;\r\n\r\n        setInterval(() => {\r\n            if (mapLocElement) {\r\n\r\n                mapLocElement.classList.remove(pulseUp);\r\n                mapLocElement.classList.remove(pulseDown);\r\n\r\n                mapLocElement.classList.add(pulseUp);\r\n\r\n                setTimeout(() => {\r\n                    mapLocElement.classList.add(pulseDown);\r\n                }, 3000);\r\n\r\n            }\r\n        }, 6000);\r\n\r\n    }\r\n\r\n\r\n}\r\n","import React from 'react';\r\nimport { Constants } from '../Game/constants';\r\nimport { MissileBase } from '../Entities/WorldObjects/Bases/MissileBase';\r\nimport { GameLogic, GamestateWatcher, gameStateChangeDetails } from '../Game/GameLogic';\r\nimport { targetMissileResult } from './MapComponents/MapComponent';\r\nimport { NavyBase } from '../Entities/WorldObjects/Bases/NavyBase';\r\nimport { AirBase } from '../Entities/WorldObjects/Bases/AirBase';\r\nimport { Game } from '../Entities/gameEntity';\r\n\r\nexport interface props { \r\n    parentBase: MissileBase | NavyBase | AirBase;\r\n    ordnanceLabel: string;\r\n    targetingCompleteCallback: () => void;\r\n}\r\n\r\nexport interface state { }\r\n\r\nexport class OrdnanceTargetingComponent extends React.Component<props, state> implements GamestateWatcher{\r\n\r\n    private nextUIKey: number = 0;\r\n\r\n    constructor(props: props, state: state) {\r\n        super(props, state);\r\n\r\n    }\r\n\r\n    private uiKey() { return `OrdnanceTargetingComponent_${this.nextUIKey++}` }\r\n\r\n    componentDidMount() {\r\n        GameLogic.registerGamestateWatcher({ watcher: this });\r\n    }\r\n\r\n    public handleGamestateChange(args: { details: gameStateChangeDetails }) {\r\n\r\n        // console.log(`MapComponent: handleGamestateChange: Got a game state change:`, args);\r\n    \r\n        if (args.details.changeLabel === \"Location Nuked\") {\r\n          this.forceUpdate();\r\n        }\r\n      }\r\n    \r\n    render() {\r\n\r\n        const {ordnanceLabel } = this.props;\r\n\r\n        const dragStartMarkup = (args: { dragEvent: React.DragEvent, missileIndex: number }) => {\r\n            console.log(`OrdnanceTargetingComponent: tacticalOptionsMarkup: onDragStart: e, index:`,\r\n                {\r\n                    e: args.dragEvent,\r\n                    manifestIndex: args.missileIndex\r\n                });\r\n\r\n            args.dragEvent.dataTransfer.setData(\"dropType\", Constants.TARGET_MISSILE_DROP);\r\n            args.dragEvent.dataTransfer.setData(\"missileIndex\", args.missileIndex.toString());\r\n\r\n            (window as any)[Constants.NOTIFY_TARGET_RESULT_CALLBACK_NAME] = this.handleDropResult.bind(this);\r\n\r\n\r\n        }\r\n\r\n        const targetedMarkup = (args: { forMissileIndex: number}) => {\r\n            return (\r\n                <div key={this.uiKey()}>\r\n                    {`${ordnanceLabel} ${args.forMissileIndex} is targeted.`}\r\n                </div>\r\n            )\r\n        }\r\n\r\n        const wasInterceptedMarkup = (args: {forMissileIndex: number}) => {\r\n            return (\r\n                <div key={this.uiKey()}>\r\n                    {`${ordnanceLabel} ${args.forMissileIndex} was shot down.`}\r\n                </div>\r\n            )\r\n        }\r\n\r\n        const consumedMarkup = (args: { forMissileIndex: number}) => {\r\n            return (\r\n                <div key={this.uiKey()}>\r\n                    {`${ordnanceLabel} ${args.forMissileIndex} hit its target.`}\r\n                </div>\r\n            )\r\n        }\r\n\r\n        const toTargetMarkup = (args: { forMissileIndex: number }) => {\r\n            return (\r\n                    <div key={this.uiKey()}\r\n                        draggable\r\n                        onDragStart={(e) => dragStartMarkup({ dragEvent: e, missileIndex: args.forMissileIndex })}\r\n                    >\r\n                        {`${ordnanceLabel} ${args.forMissileIndex}.`}\r\n                </div>\r\n            )\r\n        };\r\n\r\n        return (\r\n            this.props.parentBase.ordnance.map( (m, idx) => {\r\n\r\n                // console.log(`OrdnanceTargetComponent: mapping ordnance for render:`, {currentMissile: m});\r\n\r\n                if (m.wasIntercepted) { return wasInterceptedMarkup({forMissileIndex: idx})}\r\n                \r\n                if (m.wasConsumed) { return consumedMarkup({forMissileIndex: idx}) }\r\n\r\n                if (m.myTarget !== null) {\r\n                    return targetedMarkup({forMissileIndex: idx});\r\n                }\r\n\r\n                return toTargetMarkup({forMissileIndex: idx});\r\n            })\r\n        );\r\n\r\n    }\r\n\r\n    private handleDropResult(args: { result: targetMissileResult }) {\r\n        console.log(`OrdnanceTargetingComponent: handleDropResult: drop finished, result:`, args.result);\r\n\r\n        const currentPlayerType = this.props.parentBase.myMapLocation.myMap.owner;\r\n\r\n        GameLogic.handleMissileTargeted(\r\n            {\r\n                attackingPlayer: currentPlayerType === \"Computer\" ? Game.getInstance().computerPlayer : Game.getInstance().humanPlayer,\r\n                atMapLocation: args.result.targetedLocation, \r\n                targetingOrdnance: this.props.parentBase.ordnance[args.result.missileIndex]\r\n            });\r\n        \r\n        if (this.props.parentBase.isAllOrdnanceTargeted()) {\r\n            this.props.targetingCompleteCallback();\r\n        }\r\n        else {\r\n        this.forceUpdate();\r\n        }\r\n        \r\n    }\r\n\r\n}\r\n","import React, { Component } from 'react';\r\nimport { Button } from '@material-ui/core';\r\nimport { NavyBase } from '../../Entities/WorldObjects/Bases/NavyBase';\r\nimport { GameLogic } from '../../Game/GameLogic';\r\nimport { OrdnanceTargetingComponent } from '../OrdnanceTargetingComponent';\r\nimport { UIComponent } from '../GameButton';\r\n\r\ninterface props {\r\n    base: NavyBase;\r\n}\r\n\r\ninterface state {\r\n    isTargetingMissiles: boolean;\r\n}\r\n\r\nexport class NavyBaseComponent extends Component<props, state> {\r\n\r\n    constructor(props: props, state: state) {\r\n        super(props, state);\r\n\r\n        this.state = {\r\n            isTargetingMissiles: false\r\n        }\r\n\r\n    }\r\n\r\n    private activateNavyBase() {\r\n        console.log(`NavyBaseComponent: activateNavyBase: entering.`);\r\n        // GameLogic.activateNavyBase({ forBase: this.props.base });\r\n        this.setState({ isTargetingMissiles: true });\r\n    }\r\n\r\n    render() {\r\n\r\n        const { ordnance } = this.props.base;\r\n        const { base } = this.props;\r\n\r\n        const isTargetingMarkup =\r\n            <React.Fragment>\r\n                <span>{`Targeting ${ordnance.length} missiles.`}<br /></span>\r\n                <OrdnanceTargetingComponent\r\n                    ordnanceLabel={\"Submarine missile\"}\r\n                    parentBase={this.props.base}\r\n                    targetingCompleteCallback={() => this.setState({ isTargetingMissiles: false })}\r\n                />\r\n            </React.Fragment>;\r\n\r\n\r\n        const readyToActivateMarkup =\r\n            <React.Fragment>\r\n                <UIComponent.GameButton onClick={() => this.activateNavyBase()}>\r\n                    {`Target ${ordnance.length} Missiles`}\r\n                </UIComponent.GameButton>\r\n            </React.Fragment>;\r\n\r\n        const allTargetedMarkup =\r\n            <React.Fragment>\r\n                <span>\r\n                    {\r\n                        `${ordnance.length} en route.`\r\n                    }\r\n                </span>\r\n            </React.Fragment>;\r\n\r\n\r\n        const isNotReceivingOrdersMarkup =\r\n            <React.Fragment>\r\n                <span>Setting sail...</span>\r\n            </React.Fragment>;\r\n\r\n        const wrapper = (toWrap: JSX.Element) => {\r\n            return (\r\n                <React.Fragment>\r\n                    <span>{`${base.WorldObjectLabel}: ${base.Name}`}</span>\r\n                    {toWrap}\r\n                </React.Fragment>\r\n            )\r\n        };\r\n\r\n        const wasDestroyedMarkup =\r\n            <React.Fragment>\r\n                <span>Nave Base ${base.Name} was destroyed.</span>\r\n            </React.Fragment>\r\n\r\n\r\n        if (base.wasDestroyed) { return wasDestroyedMarkup }\r\n        if (this.state.isTargetingMissiles) { return wrapper(isTargetingMarkup); }\r\n        if (!base.isReceivingOrders) { return wrapper(isNotReceivingOrdersMarkup); }\r\n        if (base.isAllOrdnanceTargeted()) { return wrapper(allTargetedMarkup); }\r\n\r\n        return wrapper(readyToActivateMarkup);\r\n\r\n    };\r\n}\r\n","\r\nimport React, { Component } from 'react';\r\nimport { GameLogic } from '../../Game/GameLogic';\r\nimport { MissileBase } from '../../Entities/WorldObjects/Bases/MissileBase';\r\nimport { Button } from '@material-ui/core';\r\nimport { OrdnanceTargetingComponent } from '../OrdnanceTargetingComponent';\r\nimport { UIComponent } from '../GameButton';\r\n\r\ninterface props {\r\n    base: MissileBase;\r\n}\r\n\r\ninterface state {\r\n    isTargetingMissiles: boolean;\r\n}\r\n\r\nexport class MissileBaseComponent extends Component<props, state> {\r\n\r\n    constructor(props: props, state: state) {\r\n        super(props, state);\r\n\r\n        this.state = {\r\n            isTargetingMissiles: false\r\n        }\r\n\r\n    }\r\n\r\n    componentDidMount() {\r\n\r\n        console.log(`MissileBaseComponent: componentDidMount: state and props:`, { state: this.state, props: this.props });\r\n\r\n    }\r\n\r\n    private activateMissileBase() {\r\n        console.log(`MissileBaseComponent: activateMissileBase: entering.`);\r\n        GameLogic.activateMissileBase({ forBase: this.props.base });\r\n        this.setState({ isTargetingMissiles: true });\r\n    }\r\n\r\n    render() {\r\n\r\n        const {base} = this.props;\r\n\r\n        const isTargetingMarkup =\r\n            <React.Fragment>\r\n                <span>{`Targeting ${base.ordnance.length} missiles.`}<br /></span>\r\n                <OrdnanceTargetingComponent\r\n                    ordnanceLabel={\"ICBM\"}\r\n                    parentBase={base}\r\n                    targetingCompleteCallback={() => this.setState({ isTargetingMissiles: false })}\r\n                />\r\n            </React.Fragment>;\r\n\r\n        const readyToActivateMarkup =\r\n            <React.Fragment>\r\n                <UIComponent.GameButton onClick={() => this.activateMissileBase()}>\r\n                    {`Target ${base.ordnance.length} Missiles`}\r\n                </UIComponent.GameButton>\r\n            </React.Fragment>;\r\n\r\n        const allTargetedMarkup =\r\n            <React.Fragment>\r\n                <span>\r\n                    {\r\n                        `${base.ordnance.length} en route.`\r\n                    }\r\n                </span>\r\n            </React.Fragment>;\r\n\r\n\r\n        const isNotReceivingOrdersMarkup =\r\n            <React.Fragment>\r\n                <span>Fueling missiles...</span>\r\n            </React.Fragment>;\r\n\r\n        const wrapper = (toWrap: JSX.Element) => {\r\n            return (\r\n                <div>\r\n                    <span>{`${base.WorldObjectLabel}: ${base.Name}`}</span>\r\n                    {toWrap}\r\n                </div>\r\n            )\r\n        };\r\n\r\n        const wasDestroyedMarkup = \r\n            <React.Fragment>\r\n                <span>Missile base ${base.Name} was destroyed.</span>\r\n            </React.Fragment>\r\n\r\n\r\n        if (base.wasDestroyed) { return wasDestroyedMarkup }\r\n        if (this.state.isTargetingMissiles) { return wrapper(isTargetingMarkup); }\r\n        if (!base.isReceivingOrders) { return wrapper(isNotReceivingOrdersMarkup); }\r\n        if (base.isAllOrdnanceTargeted()) { return wrapper(allTargetedMarkup); }\r\n\r\n        return wrapper(readyToActivateMarkup);\r\n\r\n    };\r\n\r\n}\r\n","import React, { Component } from 'react';\r\nimport { AirBase } from '../../Entities/WorldObjects/Bases/AirBase';\r\nimport { Button } from '@material-ui/core';\r\nimport { GameLogic } from '../../Game/GameLogic';\r\nimport { OrdnanceTargetingComponent } from '../OrdnanceTargetingComponent';\r\nimport { UIComponent } from '../GameButton';\r\n\r\ninterface props {\r\n    base: AirBase;\r\n}\r\n\r\ninterface state {\r\n    isTargetingBombers: boolean;\r\n}\r\n\r\nexport class AirBaseComponent extends Component<props, state> {\r\n\r\n    constructor(props: props, state: state) {\r\n        super(props, state);\r\n\r\n        this.state = {\r\n            isTargetingBombers: false\r\n        }\r\n\r\n    }\r\n\r\n\r\n    componentDidMount() {\r\n\r\n        console.log(`AirBaseComponent: componentDidMount: state and props:`, { state: this.state, props: this.props });\r\n\r\n    }\r\n\r\n    private activateAirBase() {\r\n        console.log(`AirbaseComponent: activateAirBase: entering.`);\r\n        // GameLogic.activateAirBase({ forBase: this.props.base });\r\n        this.setState({ isTargetingBombers: true });\r\n    }\r\n\r\n    private handleAllOrdnanceTargeted() {\r\n        this.setState({\r\n            isTargetingBombers: false\r\n        })\r\n    }\r\n\r\n    render() {\r\n\r\n        console.log(`AirBaseComponent: render: entering with state and props:`, { state: this.state, props: this.props });\r\n\r\n        const {base} = this.props;\r\n\r\n        const isTargetingMarkup =\r\n            <React.Fragment>\r\n                <span>{`Targeting ${base.ordnance.length} bombers.`}<br /></span>\r\n                <OrdnanceTargetingComponent\r\n                    ordnanceLabel={\"Bomber\"}\r\n                    parentBase={base}\r\n                    targetingCompleteCallback={() => this.setState({ isTargetingBombers: false })}\r\n                />\r\n            </React.Fragment>;\r\n\r\n        const readyToActivateMarkup =\r\n            <React.Fragment>\r\n                <UIComponent.GameButton onClick={() => this.activateAirBase()}>\r\n                    {`Scramble ${base.totalFighters} fighters and ${base.ordnance.length} bombers.`}\r\n                </UIComponent.GameButton>\r\n            </React.Fragment>;\r\n\r\n        const isFlyingMarkup =\r\n            <React.Fragment>\r\n                <span>\r\n                    {\r\n                        `${base.totalFighters} on patrol. ${base.ordnance.length} bombers en route to their target.`\r\n                    }\r\n                </span>\r\n            </React.Fragment>;\r\n\r\n\r\n        const isNotReceivingOrdersMarkup =\r\n            <React.Fragment>\r\n                <span>Flight crews prepping...</span>\r\n            </React.Fragment>;\r\n\r\n        const wrapper = (toWrap: JSX.Element) => {\r\n            return (\r\n                <div>\r\n                    <span>{`${base.WorldObjectLabel}: ${base.Name}`}</span>\r\n                    {toWrap}\r\n                </div>\r\n            )\r\n        };\r\n\r\n        const wasDestroyedMarkup = \r\n            <React.Fragment>\r\n                <span>Air base ${base.Name} was destroyed.</span>\r\n            </React.Fragment>\r\n\r\n        if (base.wasDestroyed) { return wasDestroyedMarkup }\r\n        if (this.state.isTargetingBombers) { return wrapper(isTargetingMarkup); }\r\n        if (!base.isReceivingOrders) { return wrapper(isNotReceivingOrdersMarkup); }\r\n        if (base.isAllOrdnanceTargeted()) { return wrapper(isFlyingMarkup); }\r\n\r\n        return wrapper(readyToActivateMarkup);\r\n\r\n    };\r\n\r\n}\r\n","import React, { Component } from 'react';\r\nimport { Button } from '@material-ui/core';\r\nimport { ArmyBase } from '../../Entities/WorldObjects/Bases/ArmyBase';\r\nimport { GameLogic } from '../../Game/GameLogic';\r\nimport { UIComponent } from '../GameButton';\r\n\r\ninterface props {\r\n    base: ArmyBase;\r\n}\r\n\r\ninterface state {\r\n}\r\n\r\nexport class ArmyBaseComponent extends Component<props, state> {\r\n\r\n    constructor(props: props, state: state) {\r\n        super(props, state);\r\n\r\n        this.state = {\r\n        }\r\n\r\n    }\r\n\r\n\r\n    componentDidMount() {\r\n\r\n        console.log(`ArmyBaseComponent: componentDidMount: state and props:`, { state: this.state, props: this.props });\r\n\r\n    }\r\n\r\n    private decampArmy() {\r\n        GameLogic.activateArmyBase({ forBase: this.props.base });\r\n        this.forceUpdate();\r\n    }\r\n\r\n    render() {\r\n\r\n        const {base} = this.props;\r\n\r\n        const readyToActivateMarkup =\r\n            <React.Fragment>\r\n                <UIComponent.GameButton onClick={() => this.decampArmy()}>\r\n                    Decamp\r\n                </UIComponent.GameButton>\r\n            </React.Fragment>;\r\n\r\n        const isDecampedMarkup =\r\n            <React.Fragment>\r\n                <span>\r\n                    {\r\n                        `Operating...`\r\n                    }\r\n                </span>\r\n            </React.Fragment>;\r\n\r\n        const isNotReceivingOrdersMarkup =\r\n            <React.Fragment>\r\n                <span>Organizing...</span>\r\n            </React.Fragment>;\r\n\r\n        const wrapper = (toWrap: JSX.Element) => {\r\n            return (\r\n                <div>\r\n                    <span>{`${base.WorldObjectLabel}: ${base.Name}`}</span>\r\n                    {toWrap}\r\n                </div>\r\n            )\r\n        };\r\n\r\n        const wasDestroyedMarkup = \r\n            <React.Fragment>\r\n                <span>Army base ${base.Name} was destroyed.</span>\r\n            </React.Fragment>\r\n\r\n\r\n        if (base.wasDestroyed) { return wasDestroyedMarkup }\r\n\r\n        return (\r\n            base.isReceivingOrders\r\n                ? (\r\n                    base.isDecamped ? wrapper(isDecampedMarkup) : wrapper(readyToActivateMarkup)\r\n                )\r\n                : wrapper(isNotReceivingOrdersMarkup)\r\n        );\r\n\r\n    };\r\n\r\n\r\n}\r\n","import React, { Component } from 'react';\r\nimport { HumanPlayer } from '../Game/HumanPlayer';\r\nimport { MapLocation } from '../Entities/MapObjects/MapLocation';\r\nimport { MilitaryBaseTypes } from '../Entities/WorldObjects/Bases/MilitaryBaseTypes';\r\nimport { GamestateWatcher, GameLogic, gameStateChangeDetails } from '../Game/GameLogic';\r\nimport { AbmBaseComponent } from './MilitaryBaseComponents/AbmBaseComponent';\r\nimport { RadarBaseComponent } from './MilitaryBaseComponents/RadarBaseComponent';\r\nimport { NavyBaseComponent } from './MilitaryBaseComponents/NavyBaseComponent';\r\nimport { MissileBaseComponent } from './MilitaryBaseComponents/MissileBaseComponent';\r\nimport { AirBaseComponent } from './MilitaryBaseComponents/AirBaseComponent';\r\nimport { ArmyBaseComponent } from './MilitaryBaseComponents/ArmyBaseComponent';\r\nimport { RadarBase } from '../Entities/WorldObjects/Bases/RadarBase';\r\nimport { AirBase } from '../Entities/WorldObjects/Bases/AirBase';\r\nimport { AbmBase } from '../Entities/WorldObjects/Bases/AbmBase';\r\nimport { ArmyBase } from '../Entities/WorldObjects/Bases/ArmyBase';\r\nimport { MissileBase } from '../Entities/WorldObjects/Bases/MissileBase';\r\nimport { NavyBase } from '../Entities/WorldObjects/Bases/NavyBase';\r\nimport { AbstractMilitaryBase } from '../Entities/WorldObjects/Bases/AbstractMilitaryBase';\r\nimport { MapUtil } from '../Utils/MapUtils';\r\n\r\ninterface props {\r\n    player: HumanPlayer;\r\n    registerForHumanPlayerMapClicks: (args: { ui: BaseActivatorComponent }) => void;\r\n}\r\n\r\ntype baseComponent = AbmBaseComponent |\r\n    AirBaseComponent |\r\n    MissileBaseComponent |\r\n    ArmyBaseComponent |\r\n    NavyBaseComponent |\r\n    RadarBaseComponent;\r\n\r\ninterface initializedBase {\r\n    baseEntity: Exclude<MilitaryBaseTypes, null>;\r\n    ui: baseComponent;\r\n}\r\n\r\ninterface state {\r\n    isWaitingForSelection: boolean;\r\n    activeBases: initializedBase[];\r\n    inactiveBases: initializedBase[];\r\n    destroyedBases: initializedBase[];\r\n}\r\n\r\nexport class BaseActivatorComponent extends Component<props, state> implements GamestateWatcher {\r\n\r\n    private uiKeyNbr: number = 0;\r\n\r\n    constructor(props: props, state: state) {\r\n        super(props, state);\r\n\r\n        this.state = {\r\n            isWaitingForSelection: false,\r\n            activeBases: [],\r\n            inactiveBases: [],\r\n            destroyedBases: []\r\n        }\r\n\r\n        GameLogic.registerGamestateWatcher({ watcher: this });\r\n\r\n    }\r\n\r\n    public handleGamestateChange(args: { details: gameStateChangeDetails }) {\r\n\r\n        if (args.details.changeLabel === \"Location Nuked\") {\r\n\r\n            const destroyedBases1 = this.state.activeBases.filter(ab => ab.baseEntity.wasDestroyed);\r\n            const destroyedBases2 = this.state.inactiveBases.filter(ib => ib.baseEntity.wasDestroyed);\r\n\r\n            this.setState({\r\n                destroyedBases: this.state.destroyedBases.concat(destroyedBases1).concat(destroyedBases2),\r\n                activeBases: this.state.activeBases.filter(ab => ! ab.baseEntity.wasDestroyed),\r\n                inactiveBases: this.state.inactiveBases.filter(ib => ! ib.baseEntity.wasDestroyed)\r\n            })\r\n        }\r\n\r\n        if (args.details.changeLabel === \"Tick\") {\r\n\r\n            if (this.state.inactiveBases.length > 0) {\r\n\r\n                this.state.inactiveBases[0].baseEntity.activate();\r\n                this.handleBaseActivatedAnimation({forBase: this.state.inactiveBases[0]});\r\n\r\n                this.setState({\r\n                    activeBases: this.state.activeBases.concat(this.state.inactiveBases[0]),\r\n                    inactiveBases: this.state.inactiveBases.slice(1)\r\n                })\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    private handleBaseActivatedAnimation(args: {forBase: initializedBase}) {\r\n        const mapLocElement = document.getElementById(MapUtil.getMapLocationHtmlID(args.forBase.baseEntity.myMapLocation));\r\n        if (mapLocElement) {\r\n            mapLocElement.classList.remove(\"activatedBase\");\r\n            mapLocElement.classList.add(\"activatedBase\");\r\n        }\r\n\r\n    }\r\n\r\n    componentDidMount() {\r\n\r\n        this.props.registerForHumanPlayerMapClicks({ ui: this });\r\n\r\n        const getInitializeBased = (base: Exclude<MilitaryBaseTypes,null>) => { \r\n            return ( \r\n                {\r\n                    baseEntity: base as any,\r\n                    ui: this.getBaseUI({forBase: base}) as any\r\n                } as initializedBase\r\n            )\r\n         }\r\n\r\n         const allPlayerMilitaryBases = this.props.player.map.getAllMilitaryBases();\r\n\r\n         const initializedBases = allPlayerMilitaryBases.map(b => getInitializeBased(b));\r\n\r\n         this.setState({\r\n             inactiveBases: initializedBases\r\n         });\r\n\r\n    }\r\n\r\n    private uiKey() { return `BaseActivatorComponent_${this.uiKeyNbr++}` }\r\n\r\n    public handlePlayerMapClick(args: { location: MapLocation }) {\r\n        console.log(`BaseActivatorComponent: handlePlayerMapClick: Got a click! args:`, { args: args });\r\n    }\r\n\r\n    render() {\r\n\r\n        console.log(`BaseActivatorComponent: render: Entering with props and state:`, { props: this.props, state: this.state });\r\n\r\n        const baseActivationOptions = (args: { forBase: Exclude<MilitaryBaseTypes, null> }) => {\r\n\r\n            if (args.forBase.WorldObjectLabel === \"ABM\") return <AbmBaseComponent key={this.uiKey()} base={args.forBase as AbmBase} />;\r\n            if (args.forBase.WorldObjectLabel === \"Army\") return <ArmyBaseComponent key={this.uiKey()} base={args.forBase as ArmyBase} />;\r\n            if (args.forBase.WorldObjectLabel === \"Air\") return <AirBaseComponent key={this.uiKey()} base={args.forBase as AirBase} />;\r\n            if (args.forBase.WorldObjectLabel === \"Missile\") return <MissileBaseComponent key={this.uiKey()} base={args.forBase as MissileBase} />;\r\n            if (args.forBase.WorldObjectLabel === \"Navy\") return <NavyBaseComponent key={this.uiKey()} base={args.forBase as NavyBase} />;\r\n            if (args.forBase.WorldObjectLabel === \"Radar\") return <RadarBaseComponent key={this.uiKey()} base={args.forBase as RadarBase} />;\r\n\r\n        };\r\n\r\n        const toRender = (\r\n            <div className=\"baseActivatorContainer\">\r\n\r\n                <div>\r\n                    There exists a state of war.\r\n                </div>\r\n                \r\n                <div><h5>Active bases ({this.state.activeBases.length})</h5></div>\r\n                {\r\n                    this.state.activeBases.map(activeBase => activeBase.ui)\r\n                }\r\n\r\n                <div><h5>Inactive bases ({this.state.inactiveBases.length})</h5></div>\r\n                {\r\n                    this.state.inactiveBases.map(inactiveBase => inactiveBase.ui)\r\n                }\r\n\r\n                <div><h5>Destroyed bases ({this.state.destroyedBases.length})</h5></div>\r\n                {\r\n                    this.state.destroyedBases.map(destroyedBase => destroyedBase.ui)\r\n                }\r\n\r\n            </div>\r\n        )\r\n\r\n        return toRender;\r\n    }\r\n\r\n    private getBaseUI = (args: { forBase: Exclude<MilitaryBaseTypes, null> }) => {\r\n\r\n        const { WorldObjectLabel } = args.forBase;\r\n\r\n        if (WorldObjectLabel === \"ABM\") return <AbmBaseComponent key={this.uiKey()} base={args.forBase as AbmBase} />;\r\n        else if (WorldObjectLabel === \"Army\") return <ArmyBaseComponent key={this.uiKey()} base={args.forBase as ArmyBase} />;\r\n        else if (WorldObjectLabel === \"Air\") return <AirBaseComponent key={this.uiKey()} base={args.forBase as AirBase} />;\r\n        else if (WorldObjectLabel === \"Missile\") return <MissileBaseComponent key={this.uiKey()} base={args.forBase as MissileBase} />;\r\n        else if (WorldObjectLabel === \"Navy\") return <NavyBaseComponent key={this.uiKey()} base={args.forBase as NavyBase} />;\r\n        else return <RadarBaseComponent key={this.uiKey()} base={args.forBase as RadarBase} />;\r\n\r\n    };\r\n\r\n\r\n}\r\n","import React, { Component } from 'react';\r\nimport { GameRules, strategicMoveOptions, tacticalMoveOptions } from \"../Game/GameRules\";\r\nimport { GameLogic, GamestateWatcher, gameStateChangeDetails } from '../Game/GameLogic';\r\nimport { Button, withStyles } from '@material-ui/core';\r\nimport { TickerComponent } from './TickerComponent';\r\nimport { BuildManifestComponent } from './BuildManifestComponent';\r\nimport { HumanPlayer } from '../Game/HumanPlayer';\r\nimport { BaseActivatorComponent } from './BaseActivatorComponent';\r\nimport { playerMapClickListener } from './Game';\r\nimport { MapLocation } from '../Entities/MapObjects/MapLocation';\r\nimport { Game } from '../Entities/gameEntity';\r\nimport { UIComponent } from './GameButton';\r\n\r\n\r\nexport interface state {\r\n    isMakingStrategicChoice: boolean;\r\n    isMakingTacticalChoice: boolean;\r\n    isSelectingLocation: boolean;\r\n    isBuilding: boolean;\r\n    tacticalChoice: tacticalMoveOptions;\r\n    strategicChoice: strategicMoveOptions | null;\r\n    isWaitingForMyTurn: boolean;\r\n    isActivating: boolean;\r\n}\r\n\r\nexport interface props {\r\n    player: HumanPlayer;\r\n    mapClickListener: playerMapClickListener;\r\n    registerMapListener: (args: {forUserComponent: UserActionsComponent}) => void;\r\n}\r\n\r\ninterface actionHandlerMappings {\r\n    playerChoice: strategicMoveOptions | tacticalMoveOptions;\r\n    actionHandler: () => void;\r\n}\r\n\r\nexport class UserActionsComponent extends Component<props, state> implements GamestateWatcher, playerMapClickListener {\r\n\r\n    private uiIdx: number = 0;\r\n    private readonly uiKey = () => `useractions${this.uiIdx++}`;\r\n\r\n    private baseActivatorComponent: BaseActivatorComponent | null = null;\r\n\r\n    private readonly actionHandlers: actionHandlerMappings[] = [\r\n        {\r\n            actionHandler: this.handleFinishTurn,\r\n            playerChoice: \"Skip\"\r\n        },\r\n        {\r\n            actionHandler: this.handleBuild,\r\n            playerChoice: \"Build\"\r\n        },\r\n        {\r\n            actionHandler: this.handleDeclareWar,\r\n            playerChoice: \"Declare War\"\r\n        },\r\n        {\r\n            actionHandler: this.handleActivate,\r\n            playerChoice: \"Activate\"\r\n        },\r\n        {\r\n            actionHandler: this.handleActivate,\r\n            playerChoice: \"Activate Base\"\r\n        },\r\n        {\r\n            actionHandler: this.handleSpy,\r\n            playerChoice: \"Spy\"\r\n        },\r\n        {\r\n            actionHandler: this.notYetImplemented,\r\n            playerChoice: \"Sue for Peace\"\r\n        },\r\n        {\r\n            actionHandler: this.notYetImplemented,\r\n            playerChoice: \"Surrender\"\r\n        },\r\n        {\r\n            actionHandler: this.notYetImplemented,\r\n            playerChoice: \"ABM\"\r\n        },\r\n        {\r\n            actionHandler: this.notYetImplemented,\r\n            playerChoice: \"Air\"\r\n        },\r\n        {\r\n            actionHandler: this.notYetImplemented,\r\n            playerChoice: \"Army\"\r\n        },\r\n        {\r\n            actionHandler: this.notYetImplemented,\r\n            playerChoice: \"Missile\"\r\n        },\r\n        {\r\n            actionHandler: this.notYetImplemented,\r\n            playerChoice: \"Navy\"\r\n        },\r\n        {\r\n            actionHandler: this.notYetImplemented,\r\n            playerChoice: \"Radar\"\r\n        }\r\n    ];\r\n\r\n    constructor(props: props, state: state) {\r\n        super(props, state);\r\n\r\n        this.state = {\r\n            isSelectingLocation: false,\r\n            isMakingStrategicChoice: true,\r\n            isMakingTacticalChoice: false,\r\n            isBuilding: false,\r\n            tacticalChoice: null,\r\n            strategicChoice: null,\r\n            isWaitingForMyTurn: false,\r\n            isActivating: false\r\n        };\r\n\r\n        GameLogic.registerGamestateWatcher({watcher: this});\r\n\r\n    }\r\n\r\n    public handlePlayerMapClick(args: {location: MapLocation}) {\r\n        console.log(`UserActionsComponent: handlePlayerMapClick: Got a click! args:`, {args: args});\r\n\r\n        if (this.baseActivatorComponent) this.baseActivatorComponent.handlePlayerMapClick(args);\r\n    }\r\n\r\n    private getMoveChoiceLabels() {\r\n        return GameRules.getAllowedMoves();\r\n    }\r\n\r\n    private setInitialState() {\r\n        this.setState({\r\n            isBuilding: false,\r\n            isMakingStrategicChoice: true,\r\n            isMakingTacticalChoice: false,\r\n            isSelectingLocation: false,\r\n            tacticalChoice: null,\r\n            strategicChoice: null,\r\n            isWaitingForMyTurn: false\r\n        });\r\n    }\r\n\r\n    public componentDidMount() {\r\n        this.props.registerMapListener({forUserComponent: this});\r\n    }\r\n\r\n    public handleGamestateChange(args: { details: gameStateChangeDetails }) {\r\n\r\n        if (args.details.changeLabel === \"Advance Turn\") {\r\n            this.setInitialState();\r\n        }\r\n\r\n        if (args.details.changeLabel === \"Computer Playing Its Turn\") {\r\n            this.setState({isWaitingForMyTurn: true});\r\n        }\r\n\r\n        if (args.details.changeLabel === \"War Declared\") {\r\n            this.setState(\r\n                {\r\n                    isActivating: true,\r\n                    isMakingStrategicChoice: false,\r\n                    isMakingTacticalChoice: true\r\n                });\r\n        }\r\n    }\r\n\r\n    render() {\r\n\r\n        const strategicOptions = this.getMoveChoiceLabels().strategicOptions.map(c => this.getChoiceButtonMarkup({forChoice: c}));\r\n        const tacticalOptions = this.getMoveChoiceLabels().tacticalOptions.map(c => this.getChoiceButtonMarkup({forChoice: c}));\r\n\r\n        const waitingMarkup = () => (\r\n            <TickerComponent tickerInterval={10} tickerMessage=\"Waiting for the computer to finish its move...\"/>\r\n        )\r\n\r\n        if (this.state.isWaitingForMyTurn) { return waitingMarkup()}\r\n\r\n        if (this.state.isMakingStrategicChoice) {\r\n            return strategicOptions;\r\n        }\r\n\r\n        if (this.state.isBuilding) {\r\n            return (\r\n                <BuildManifestComponent \r\n                    allowedBasesToBuild={this.getMoveChoiceLabels().tacticalOptions} \r\n                    totalAllowedToBuild={GameRules.getTotalBasesAllowedToBuild({basedOnStrategicChoice: this.state.strategicChoice})}\r\n                />\r\n            )\r\n        }\r\n\r\n        if (this.state.isActivating) {\r\n            return (\r\n                <BaseActivatorComponent \r\n                    player={this.props.player} \r\n                    registerForHumanPlayerMapClicks={(\r\n                        args: {ui: BaseActivatorComponent}) => this.baseActivatorComponent = args.ui}/>\r\n            );\r\n        }\r\n\r\n        else {\r\n            return tacticalOptions;\r\n        }\r\n\r\n    }\r\n\r\n    private getChoiceButtonMarkup(args: {forChoice: strategicMoveOptions | tacticalMoveOptions}) {\r\n\r\n        const actionHandler = this.actionHandlers.filter(ah => ah.playerChoice === args.forChoice)[0];\r\n\r\n        if (! actionHandler) {\r\n            const err = {\r\n                msg: \"UserActionsComponent: getChoiceButtonMarkup: Error: failed to get an action handler for the provided choice.\",\r\n                args: args\r\n            };\r\n\r\n            console.error(err);\r\n            throw err;\r\n        }\r\n\r\n        return (\r\n            <UIComponent.GameButton key={this.uiKey()} onClick={actionHandler.actionHandler.bind(this)}>\r\n                {/* <TickerComponent tickerInterval={50} tickerMessage={args.forChoice as string}/> */}\r\n                {args.forChoice}\r\n            </UIComponent.GameButton>\r\n        )\r\n    }\r\n\r\n    private handleDeclareWar() {\r\n        \r\n        console.log(`UserActionsComponent: handleDeclareWar: Entering.`);\r\n\r\n        GameLogic.declareWar({declaringPlayer: this.props.player});\r\n\r\n        this.setState(\r\n            {\r\n                isActivating: true,\r\n                isMakingStrategicChoice: false,\r\n                isMakingTacticalChoice: true\r\n            });\r\n\r\n    }\r\n\r\n    private handleBuild() {\r\n\r\n        console.log(`UserActionsComponent: handleBuild: Entering.`);\r\n\r\n        GameLogic.spyOnPlayer({targetPlayer: Game.getInstance().computerPlayer, spyLevel: 2});\r\n\r\n        this.setState({\r\n            isMakingTacticalChoice: true,\r\n            isMakingStrategicChoice: false,\r\n            isBuilding: true,\r\n            strategicChoice: \"Build\",\r\n            tacticalChoice: null\r\n        });\r\n\r\n    }\r\n\r\n    private handleActivate() {\r\n        this.setState(\r\n            {\r\n                isActivating: true,\r\n                isMakingStrategicChoice: false,\r\n                isMakingTacticalChoice: true\r\n            });\r\n    }\r\n\r\n    private handleSpy() {\r\n\r\n        GameLogic.spyOnPlayer({targetPlayer: Game.getInstance().computerPlayer, spyLevel: 2});\r\n\r\n        this.setState({\r\n            isMakingTacticalChoice: true,\r\n            isMakingStrategicChoice: false,\r\n            isBuilding: true,\r\n            strategicChoice: \"Spy\",\r\n            tacticalChoice: null\r\n        });\r\n\r\n    }\r\n\r\n    private handleFinishTurn() {\r\n\r\n        this.setState({\r\n            isSelectingLocation: false,\r\n            isMakingStrategicChoice: true,\r\n            isMakingTacticalChoice: false,\r\n            isBuilding: false\r\n        })\r\n\r\n        GameLogic.finishHumanTurn();\r\n\r\n    }\r\n\r\n    private notYetImplemented() {\r\n\r\n        console.log(`UserActionComponent: notYetImplemented: entering, advancing turn.`);\r\n\r\n        GameLogic.advanceTurn();\r\n\r\n        this.setState({\r\n            isSelectingLocation: false,\r\n            isMakingStrategicChoice: true,\r\n            isMakingTacticalChoice: false,\r\n            isBuilding: false\r\n        })\r\n    }\r\n}\r\n","\r\nimport React, { Component } from 'react';\r\nimport { Paper } from \"@material-ui/core\";\r\nimport { GamestateWatcher, gameStateChangeDetails, GameLogic, gameStateChangeType } from '../Game/GameLogic';\r\nimport { TickerComponent } from './TickerComponent';\r\n\r\ninterface gameMessage {\r\n    msg: string;\r\n}\r\n\r\ninterface props { }\r\n\r\ninterface state {\r\n    oldMessages: string[];\r\n    currentMessage: string;\r\n}\r\n\r\nexport class GameLogComponent extends Component<props, state> implements GamestateWatcher {\r\n\r\n    private nextUIKeyVal: number = 0;\r\n    private uiKey = () => `GLC_${this.nextUIKeyVal++}`;\r\n\r\n    private ignoreChangeLabels: gameStateChangeType[];\r\n\r\n    private queuedMessages: string[] = [];\r\n\r\n    constructor(props: props, state: state) {\r\n        super(props, state);\r\n\r\n        this.state = {\r\n            oldMessages: [],\r\n            currentMessage: \"\"\r\n        }\r\n\r\n        this.ignoreChangeLabels = [\"Tick\"];\r\n    }\r\n\r\n    componentDidMount() {\r\n        GameLogic.registerGamestateWatcher({ watcher: this });\r\n\r\n        this.setState({\r\n            currentMessage: \"Initialzing...\"\r\n        })\r\n    }\r\n\r\n    private onTickerCompleted() {\r\n        // console.log(`GameLogComponent: onTickerCompleted: Entering.`);\r\n\r\n        // Move the current message to history\r\n        this.setState({\r\n            oldMessages: [this.state.currentMessage].concat(this.state.oldMessages)\r\n        })\r\n\r\n        // if there are any queued messages, then process them\r\n        if (this.queuedMessages.length > 0) {\r\n            this.setState({\r\n                currentMessage: this.queuedMessages.shift() as string\r\n            })\r\n\r\n            return;\r\n        }\r\n\r\n        // If there's no queued message, then we're done.\r\n        this.setState({\r\n            currentMessage: \"\"\r\n        });\r\n\r\n    }\r\n\r\n    private loggableMessageFromGameStateChange(args: {gsc: gameStateChangeDetails}) : string {\r\n\r\n        if (args.gsc.changeLabel === \"Computer Playing Its Turn\") {\r\n            return args.gsc.miscDetails + \" is playing its turn.\";\r\n        }\r\n        else if (args.gsc.changeLabel === \"New base constructed\") {\r\n            if (args.gsc.relatedBase) {\r\n            const baseLabel = args.gsc.relatedBase.WorldObjectLabel;\r\n            const baseName = args.gsc.relatedBase.Name;\r\n            return `Constructed a new ${baseLabel} base: ${baseName}`;\r\n            }\r\n            else {\r\n                return `Cosntructed a new base but I don't know what kind!`;\r\n            }\r\n        }\r\n        else if (args.gsc.changeLabel === \"Location Nuked\") {\r\n\r\n            const loc = args.gsc.relatedLocation;\r\n\r\n            if (loc) {\r\n                const msgStart = \r\n                    (loc.myMap.owningPlayer.isHuman\r\n                        ? \"An enemy missile evaded your defenses! \"\r\n                        : \"One of your missiles evaded the enemy's defenses. \"\r\n                    ) +\r\n                    `${ args.gsc.miscDetails} citizens were killed. `;\r\n\r\n                const b = args.gsc.relatedBase;\r\n                if (b) {\r\n                    return `${msgStart} The ${b.WorldObjectLabel} base there (${b.Name}) ${b.wasDestroyed ? \"was\" : \"was not\"} destroyed.` \r\n                }\r\n                else {\r\n                    return msgStart;\r\n                }\r\n            }\r\n            else {\r\n                return \"A location was nuked.\";\r\n            }\r\n        }        \r\n\r\n        return args.gsc.changeLabel;\r\n    }\r\n\r\n    public handleGamestateChange(args: { details: gameStateChangeDetails }) {\r\n\r\n        const doIgnore = this.ignoreChangeLabels.filter(igcl => igcl === args.details.changeLabel).length > 0;\r\n        if (doIgnore) { return; }\r\n\r\n        // add the message we just got to the queue\r\n        // this.queuedMessages = this.queuedMessages.concat(args.details.changeLabel);\r\n        this.queuedMessages = this.queuedMessages.concat(this.loggableMessageFromGameStateChange({gsc : args.details}));\r\n\r\n        // if we're already processing a message, do nothing\r\n        if (this.state.currentMessage.length > 0) {\r\n            return;\r\n        }\r\n\r\n        // Otherwise, the queue was empty, so process this one.\r\n        // Take the first item from the queue and make it current.\r\n        this.setState({\r\n            currentMessage: this.queuedMessages ? this.queuedMessages.shift() as string : \"\"\r\n        });\r\n\r\n    }\r\n\r\n    render() {\r\n\r\n        return (\r\n            <div className=\"gameLogContainer\">\r\n                <div>\r\n                    <br/>\r\n                    -- Activities Log --\r\n                </div>\r\n                <div>\r\n                    {this.state.currentMessage && this.state.currentMessage.length > 0\r\n                        ?\r\n                        <TickerComponent\r\n                            tickerInterval={25}\r\n                            tickerMessage={this.state.currentMessage}\r\n                            onRenderCompleteCallback={this.onTickerCompleted.bind(this)} />\r\n                        :\r\n                        null\r\n                    }\r\n\r\n                </div>\r\n                <div key={this.uiKey()}>\r\n                    {\r\n                        this.state.oldMessages.map(m => <div key={this.uiKey()}>{m}</div>)\r\n                    }\r\n                </div>\r\n            </div>\r\n        )\r\n\r\n    }\r\n}\r\n","\r\nimport React, { Component } from 'react';\r\nimport { MapLocation } from '../../Entities/MapObjects/MapLocation';\r\nimport { MapUtil } from '../../Utils/MapUtils';\r\n\r\nexport interface state {\r\n\r\n}\r\n\r\nexport interface props {\r\n    mapItem: MapLocation\r\n}\r\n\r\nexport class MapItemComponent extends React.Component<props, state> {\r\n\r\n    constructor(props: props, state: state) {\r\n        super(props, state);\r\n        // console.log(`MapItemComponent: Entering with props and state:`, { props: props, state: state });\r\n    }\r\n\r\n    componentDidMount() {\r\n    }\r\n\r\n    render() {\r\n\r\n        const { mapItem } = this.props;\r\n\r\n        const nuclearDamageIndicator = () => {\r\n            const {nuclearStrikes} = this.props.mapItem;\r\n\r\n            if (nuclearStrikes === 1) return \"*\";\r\n            if (nuclearStrikes === 2) return \"**\";\r\n            if (nuclearStrikes === 3) return \"***\";\r\n\r\n            return \"\";\r\n\r\n        }\r\n        return (\r\n            <React.Fragment>\r\n\r\n                {MapUtil.GetMapLocationSingleCharacterCode({forMapLocation: mapItem})}\r\n                {/* <span className=\"visibilityCount\">{mapItem.enemyVisibility}</span> */}\r\n                {nuclearDamageIndicator()}\r\n                \r\n            </React.Fragment>\r\n        );\r\n\r\n    }\r\n}\r\n\r\n","\r\nimport React, { Component } from 'react';\r\nimport { CountryMap } from '../../Entities/WorldObjects/CountryMap';\r\nimport { countrySummary, MapUtil } from '../../Utils/MapUtils';\r\nimport { GamestateWatcher, gameStateChangeDetails, GameLogic } from '../../Game/GameLogic';\r\nimport Odometer from 'react-odometerjs'\r\n// import 'odometer/themes/odometer-theme-default.css';\r\nimport 'odometer/themes/odometer-theme-train-station.css';\r\nimport { Game } from '../../Entities/gameEntity';\r\n\r\n\r\nexport interface state {\r\n    summarizedMap: countrySummary;\r\n}\r\n\r\nexport interface props {\r\n    mapToSummarize: CountryMap;\r\n}\r\n\r\nexport class MapSummaryComponent extends React.Component<props, state> implements GamestateWatcher {\r\n\r\n    constructor(props: props, state: state) {\r\n        super(props, state);\r\n\r\n        this.state = {\r\n            summarizedMap: MapUtil.initialSummary\r\n        }\r\n\r\n        // console.log(`MapSummaryComponent: Entering with props and state:`, { props: props, state: state });\r\n    }\r\n\r\n    componentDidMount() {\r\n\r\n        GameLogic.registerGamestateWatcher({ watcher: this });\r\n\r\n        this.setState(\r\n            {\r\n                summarizedMap: MapUtil.getMapSummary({ forMap: this.props.mapToSummarize })\r\n            });\r\n\r\n    }\r\n\r\n    render() {\r\n\r\n        // const summarizedMap = MapUtil.getMapSummary({ forMap: this.props.mapToSummarize });\r\n        const { summarizedMap } = this.state;\r\n\r\n        const ordnanceMarkup = () => {\r\n            return (\r\n                <div>\r\n                    Ordnance:\r\n                    A: <Odometer format=\"d\" duration={5000} value={summarizedMap.totalAbmMissilesOnLine}/> \r\n                    | B: <Odometer format=\"d\" duration={5000} value={summarizedMap.totalBombersInFlight}/>\r\n                    | S: <Odometer format=\"d\" duration={5000} value={summarizedMap.totalSubMissilesOnLine}/>\r\n                    | F: <Odometer format=\"d\" duration={5000} value={summarizedMap.totalFightersOnPatrol}/>\r\n                    | M: <Odometer format=\"d\" duration={5000} value={summarizedMap.totalICBMsOnLine}/>\r\n                </div>\r\n            );\r\n        }\r\n        \r\n        const warTimeMarkup = () => {\r\n            return ( Game.getInstance().isWartime ? ordnanceMarkup() : null)\r\n        }\r\n\r\n        const playerNameMarkup = (args: {playerName: string}) => {\r\n            const maxWidth = 44;\r\n            const dashes = \"- - - - - - - - - - - - - - - - - - \";\r\n\r\n            if (args.playerName.length >= maxWidth) return args.playerName;\r\n            \r\n            const idx = 0.5 * (maxWidth - args.playerName.length);\r\n\r\n            return (\r\n                dashes.substring(0,idx) + \" \" + args.playerName + \" \" + dashes.substr(0,idx)\r\n            );\r\n\r\n        }\r\n\r\n        return (\r\n            <div className=\"mapSummaryContainer\">\r\n                <div className=\"playerName\">\r\n                    {playerNameMarkup({playerName: this.props.mapToSummarize.owningPlayer.Name})}\r\n                    {/* {this.props.mapToSummarize.owningPlayer.Name} */}\r\n                </div>\r\n                <div>\r\n                    Population: <Odometer format=\"(,ddd)\" duration={5000} value={summarizedMap.totalPopulation}/>\r\n                    &nbsp;\r\n                    Casualties: <Odometer format=\"(,ddd)\" duration={5000} value={this.props.mapToSummarize.owningPlayer.totalCausualties}/>\r\n                </div>\r\n                <div>\r\n                    Bases:\r\n                    A: <Odometer format=\"d\" duration={5000} value={summarizedMap.allAbmBases.length}/>\r\n                    | R: <Odometer format=\"d\" duration={5000} value={summarizedMap.allRadarBases.length}/>\r\n                    | B: <Odometer format=\"d\" duration={5000} value={summarizedMap.allAirBases.length}/>\r\n                    | T: <Odometer format=\"d\" duration={5000} value={summarizedMap.allArmyBases.length}/>\r\n                    | M: <Odometer format=\"d\" duration={5000} value={summarizedMap.allMissileBases.length}/>\r\n                    | N: <Odometer format=\"d\" duration={5000} value={summarizedMap.allNavyBases.length}/>\r\n\r\n                </div>\r\n                { warTimeMarkup() }\r\n            </div>\r\n        );\r\n\r\n    }\r\n\r\n    public handleGamestateChange(args: { details: gameStateChangeDetails }) {\r\n\r\n        if (args.details.changeLabel === \"Base Activated\" \r\n        || args.details.changeLabel === \"Advance Turn\"\r\n        || args.details.changeLabel === \"Location Nuked\"\r\n            ) {\r\n            console.log(`MapSummaryComponent: handleGameStateChange: got a game state change, Base Activated.`);\r\n\r\n            this.setState({\r\n                summarizedMap: MapUtil.getMapSummary({ forMap: this.props.mapToSummarize })\r\n            })\r\n            // this.forceUpdate();\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\n","\r\nimport React, { Component } from 'react';\r\nimport { MapLocation } from '../../Entities/MapObjects/MapLocation';\r\n\r\nexport type hoverListenerFunc = ((args: {onMapLocation: MapLocation}) => void);\r\nexport type hoverListenerRegistrationFunction = (args: {hoverListener: hoverListenerFunc}) => void;\r\n\r\nexport interface state {\r\n    hoverMapLocation: MapLocation | null\r\n}\r\n\r\nexport interface props {\r\n    registerHoverListener: hoverListenerRegistrationFunction;\r\n}\r\n\r\nexport class MapItemHoverComponent extends React.Component<props, state> {\r\n\r\n    constructor(props: props, state: state) {\r\n        super(props, state);\r\n\r\n        this.state = {\r\n            hoverMapLocation: null\r\n        };\r\n\r\n        // console.log(`MapItemHoverComponent: Entering with props and state:`, { props: props, state: state });\r\n    }\r\n\r\n    private handleMapLocationHover: hoverListenerFunc = (args: {onMapLocation: MapLocation}) => {\r\n        // console.log(`MapItemHoverComponent: handleMapLocationHover: Entering with args:`, args);\r\n        this.setState({hoverMapLocation: args.onMapLocation})\r\n    }\r\n\r\n    componentDidMount() {\r\n\r\n        // console.log(`MapItemHoverComponent: componentDidMount: my props and state:`, {props: this.props, state: this.state});\r\n        // console.log(`MapItemHoverComponent: componentDidMount: registering my map location hover handler.`);\r\n\r\n        this.props.registerHoverListener({hoverListener: this.handleMapLocationHover.bind(this)});\r\n    }\r\n\r\n    render() {\r\n\r\n        // console.log(`MapItemHoverLocation: render: entering.`);\r\n\r\n        if (! this.state.hoverMapLocation) {\r\n            return null;\r\n        }\r\n\r\n        return (\r\n            <React.Fragment>\r\n            <p>map location: {this.state.hoverMapLocation.uniqueID}</p>\r\n            <p>map pop: {this.state.hoverMapLocation.population}</p>\r\n            <p>map location: {this.state.hoverMapLocation.Contents.Name}</p>\r\n            </React.Fragment>\r\n        )\r\n    }\r\n}\r\n\r\n","\r\nimport React, { Component, SyntheticEvent } from 'react';\r\nimport { CountryMap } from '../../Entities/WorldObjects/CountryMap';\r\nimport { MapLocation } from '../../Entities/MapObjects/MapLocation';\r\nimport { GameRules } from '../../Game/GameRules';\r\nimport { Constants } from '../../Game/constants';\r\nimport { MilitaryBaseFactory } from '../../Factories/MilitaryBaseFactory';\r\nimport { MilitaryBaseTypeLabels } from '../../Entities/WorldObjects/Bases/MilitaryBaseTypes';\r\nimport { GamestateWatcher, gameStateChangeDetails, GameLogic } from '../../Game/GameLogic';\r\nimport { MapItemComponent } from './MapItemComponent';\r\nimport { MapSummaryComponent } from './MapSummaryComponent';\r\nimport { MapUtil } from '../../Utils/MapUtils';\r\nimport { Table, TableBody, TableCell } from '@material-ui/core';\r\nimport { MapItemHoverComponent, hoverListenerFunc } from './MapItemHoverComponent';\r\n\r\nexport interface buildBaseResult {\r\n  manifestIndex: number;\r\n  didSucceed: boolean;\r\n  message: string;\r\n}\r\n\r\nexport interface targetMissileResult {\r\n  missileIndex: number;\r\n  didSucceed: boolean;\r\n  message: string;\r\n  targetedLocation: MapLocation;\r\n}\r\n\r\nexport type notifyBuildDragResult = (args: { result: buildBaseResult }) => void;\r\nexport type notifyTargetDragResult = (args: { result: targetMissileResult }) => void;\r\n\r\nexport interface state {\r\n}\r\n\r\nexport interface props {\r\n  countryMap: CountryMap;\r\n  playerMapClickListener?: (args: { location: MapLocation }) => void\r\n}\r\n\r\nexport class MapComponent extends React.Component<props, state> implements GamestateWatcher {\r\n\r\n  private uiIdx: number = 0;\r\n\r\n  private notifyMapLocationHoveredOver!: hoverListenerFunc;\r\n\r\n  constructor(props: props, state: state) {\r\n    super(props, state);\r\n\r\n    this.state = {};\r\n\r\n    console.log(`MapComponent: Entering with props and state:`, { props: props, state: state });\r\n\r\n    GameLogic.registerGamestateWatcher({ watcher: this });\r\n\r\n  }\r\n\r\n  // This is passed as an argument down to the map item hover component.\r\n  // When it mounts, it invokes this and passes in the hover listener function to invoke when the user hovers their mouse over a map location.\r\n  private registerHoverListener(args: {hoverListener: hoverListenerFunc}) {\r\n    console.log(`MapComponent: hoverListenerRegistrationFunc: Entering with args:`, args);\r\n    this.notifyMapLocationHoveredOver = args.hoverListener;\r\n  }\r\n  \r\n  render() {\r\n\r\n    // console.log(`MapComponent.tsx: rendering a map:`, this.props.countryMap);\r\n\r\n    const mapRow = (mapRow: MapLocation[]) => {\r\n\r\n      const result =\r\n        <tr key={this.uiIdx++}>\r\n          {\r\n\r\n            mapRow.map(cell => (\r\n\r\n              <td key={this.uiIdx++}\r\n                className=\"mapCell\"\r\n                id={`${this.getMapLocationHtmlID(cell)}`}\r\n\r\n                onMouseOver={\r\n                  (e: any) => {\r\n                    console.log(`MapComponent: onMousOver: entering, hover listener:`, this.notifyMapLocationHoveredOver);\r\n                    if (this.notifyMapLocationHoveredOver) {\r\n                      console.log(`MapComponent: onMousOver: notifying listener.`);\r\n                      this.notifyMapLocationHoveredOver({onMapLocation: cell});\r\n                    }\r\n                  }\r\n                }\r\n\r\n                onClick={() => {if (this.props.playerMapClickListener) this.props.playerMapClickListener({ location: cell });}}\r\n\r\n                onDrop={\r\n                  (e: SyntheticEvent<HTMLTableDataCellElement>) => {\r\n                    e.preventDefault();\r\n                    this.handleDrop({ dropEvent: e, cell: cell });\r\n                  }\r\n                }\r\n\r\n                onDragLeave={\r\n                  (e: any) => {\r\n                    this.handleLocationDragEvent({ doLoc: cell, eventType: \"leave\" });\r\n                    e.preventDefault();\r\n                  }\r\n                }\r\n\r\n                onDragOver={\r\n                  (e: any) => {\r\n                    this.handleLocationDragEvent({ doLoc: cell, eventType: \"over\" });\r\n                    e.preventDefault();\r\n                    // console.log(`MapComponent: render: onDragOver: e:`, { e: e, cell: cell });\r\n                  }\r\n                }\r\n\r\n\r\n              >\r\n\r\n                <MapItemComponent mapItem={cell} key={this.uiIdx++} />\r\n                {cell.isTargeted ? <span>[T]</span> : null}\r\n              </td>\r\n            ))\r\n          }\r\n\r\n        </tr>\r\n        ;\r\n\r\n      return result;\r\n\r\n    }\r\n\r\n    const mapAsHtmlTable = () => {\r\n\r\n      return (\r\n        <React.Fragment>\r\n          <table className=\"mapContainer\">\r\n            <tbody>\r\n              {this.props.countryMap.map.map(row => mapRow(row))}\r\n            </tbody>\r\n          </table>\r\n\r\n          <MapItemHoverComponent registerHoverListener={this.registerHoverListener.bind(this)}/>\r\n\r\n        </React.Fragment>\r\n      )\r\n    }\r\n\r\n    return (\r\n      <div className=\"playerMapContainer\">\r\n        <MapSummaryComponent mapToSummarize={this.props.countryMap} />\r\n        {mapAsHtmlTable()}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  public handleGamestateChange(args: { details: gameStateChangeDetails }) {\r\n\r\n    // console.log(`MapComponent: handleGamestateChange: Got a game state change:`, args);\r\n\r\n    const { changeLabel } = args.details;\r\n\r\n    if (changeLabel === \"Advance Turn\") {\r\n      this.forceUpdate();\r\n    }\r\n\r\n    else if (changeLabel === \"Map Location Targeted\") {\r\n      this.handleLocationTargeted({ targetedLocation: args.details.relatedLocation });\r\n    }\r\n\r\n    else if (changeLabel === \"Base Activated\") {\r\n\r\n      console.log(`MapComponent.tsx: handleGameStateChange: got a Base Activate updated, details:`, args);\r\n\r\n      const { relatedBase } = args.details;\r\n\r\n      if (relatedBase) {\r\n        this.handleBaseActivated({ nukedLocation: relatedBase.myMapLocation })\r\n      }\r\n    }\r\n    else if (args.details.changeLabel === \"Location Nuked\") {\r\n      this.handleLocationNuked({ nukedLocation: args.details.relatedLocation });\r\n    }\r\n    else if (args.details.changeLabel === \"ICBM Intercepted\" ||\r\n      args.details.changeLabel === \"Submarine Missile Shot Down By ABM\" ||\r\n      args.details.changeLabel === \"Bomber was shot down by ABM\" ||\r\n      args.details.changeLabel === \"Bomber was shot down by Fighter\") {\r\n      this.handleLocationDetargeted({ detargetedLocation: args.details.relatedLocation });\r\n    }\r\n\r\n  }\r\n\r\n  private handleBaseActivated(args: { nukedLocation: MapLocation | undefined }) {\r\n    if (args.nukedLocation) {\r\n      const mapLocElement = document.getElementById(this.getMapLocationHtmlID(args.nukedLocation));\r\n\r\n      if (mapLocElement) {\r\n        mapLocElement.classList.add(\"activatedBase\");\r\n      }\r\n    }\r\n  }\r\n\r\n  private handleLocationTargeted(args: { targetedLocation: MapLocation | undefined }) {\r\n    if (args.targetedLocation) {\r\n      const mapLocElement = document.getElementById(this.getMapLocationHtmlID(args.targetedLocation));\r\n\r\n      if (mapLocElement) {\r\n        mapLocElement.classList.add(\"targetedMapLocation\");\r\n      }\r\n    }\r\n  }\r\n\r\n  private handleLocationDetargeted(args: { detargetedLocation: MapLocation | undefined }) {\r\n    if (args.detargetedLocation) {\r\n      const mapLocElement = document.getElementById(this.getMapLocationHtmlID(args.detargetedLocation));\r\n\r\n      if (mapLocElement) {\r\n        mapLocElement.classList.remove(\"targetedMapLocation\");\r\n      }\r\n    }\r\n  }\r\n\r\n  private handleLocationNuked(args: { nukedLocation: MapLocation | undefined }) {\r\n\r\n    // console.log(`MapComponent.ts: handleLocationNuked: Entering, args:`, args);\r\n\r\n    if (args.nukedLocation) {\r\n\r\n      // console.log(`MapComponent.ts: handleLocationNuked: Got a nuked location OK.`);\r\n\r\n      const mapLocElement = document.getElementById(this.getMapLocationHtmlID(args.nukedLocation));\r\n\r\n      if (mapLocElement) {\r\n        // console.log(`MapComponent.ts: handleLocationNuked: fiddling with nuke classes.`);\r\n\r\n        const nukeClasses = [\"nukedOnce\", \"nukedTwice\", \"nukedThrice\"];\r\n        const { nukedLocation } = args;\r\n\r\n        mapLocElement.classList.add(nukeClasses[nukedLocation.nuclearStrikes >= 3 ? 2 : nukedLocation.nuclearStrikes - 1]);\r\n\r\n        this.handleLocationDetargeted({ detargetedLocation: args.nukedLocation });\r\n      }\r\n    }\r\n  }\r\n\r\n  private handleLocationDragEvent(args: { doLoc: MapLocation, eventType: \"over\" | \"leave\" }) {\r\n\r\n    console.log(`MapComponent.ts: handleLocationDraggedOver: Entering, args:`, args);\r\n\r\n    if (args.doLoc) {\r\n\r\n      console.log(`MapComponent.ts: handleLocationDraggedOver: Got a nuked location OK.`);\r\n\r\n      const mapLocElement = document.getElementById(this.getMapLocationHtmlID(args.doLoc));\r\n\r\n      if (mapLocElement) {\r\n        console.log(`MapComponent.ts: handleLocationDraggedOver: fiddling with nuke classes.`);\r\n\r\n        if (args.eventType === \"over\") {\r\n          mapLocElement.classList.add(\"mapLocationDraggedOver\");\r\n        }\r\n        else {\r\n          mapLocElement.classList.remove(\"mapLocationDraggedOver\");\r\n        }\r\n\r\n      }\r\n    }\r\n  }\r\n\r\n  private handleDrop(args: { dropEvent: any /* SyntheticEvent<HTMLTableCellElement>*/, cell: MapLocation }) {\r\n\r\n    console.log(`MapComponent.tsx: handleDrop: Got a drop event on a cell:`, {\r\n      event: args.dropEvent,\r\n      cell: args.cell,\r\n      baseType: args.dropEvent.dataTransfer.getData(\"baseType\"),\r\n      manifestIndex: args.dropEvent.dataTransfer.getData(\"manifestIndex\"),\r\n      dropType: args.dropEvent.dataTransfer.getData(\"dropType\")\r\n    }\r\n    );\r\n\r\n    if (args.dropEvent.dataTransfer.getData(\"dropType\") === Constants.BUILD_DROP) {\r\n      this.handleBuildDrop(args);\r\n      this.forceUpdate();\r\n    }\r\n    else if (args.dropEvent.dataTransfer.getData(\"dropType\") === Constants.TARGET_MISSILE_DROP) {\r\n      this.handleTargetDrop(args);\r\n    }\r\n    else {\r\n      console.log(`MapComponent: handleDrop: got an unknown drop type:`, args.dropEvent.dataTransfer.getData(\"dropType\"));\r\n    }\r\n\r\n  }\r\n\r\n  private handleTargetDrop(args: { dropEvent: any, cell: MapLocation }) {\r\n\r\n    const notifyDragResultCallack: notifyTargetDragResult = (window as any)[Constants.NOTIFY_TARGET_RESULT_CALLBACK_NAME];\r\n\r\n    console.log(`MapComponent.tsx: handleTargetDrop: Got a drop event on a cell:`, {\r\n      event: args.dropEvent,\r\n      cell: args.cell,\r\n      baseType: args.dropEvent.dataTransfer.getData(\"baseType\"),\r\n      manifestIndex: args.dropEvent.dataTransfer.getData(\"manifestIndex\")\r\n    }\r\n    );\r\n\r\n    this.handleLocationDragEvent({ doLoc: args.cell, eventType: \"leave\" }); // clears any class artifact.\r\n\r\n    notifyDragResultCallack(\r\n      {\r\n        result: {\r\n          didSucceed: true,\r\n          missileIndex: parseInt(args.dropEvent.dataTransfer.getData(\"missileIndex\")),\r\n          message: `Successfully targeted enemy sector ${args.cell.uniqueID}.`,\r\n          targetedLocation: args.cell\r\n        }\r\n      });\r\n\r\n  }\r\n\r\n  private handleBuildDrop(args: { dropEvent: any, cell: MapLocation }) {\r\n\r\n    const notifyDragResultCallack: notifyBuildDragResult = (window as any)[Constants.NOTIFY_BUILD_RESULT_CALLBACK_NAME];\r\n\r\n    console.log(`MapComponent.tsx: handleBuildDrop: Got a drop event on a cell:`, {\r\n      event: args.dropEvent,\r\n      cell: args.cell,\r\n      baseType: args.dropEvent.dataTransfer.getData(\"baseType\"),\r\n      manifestIndex: args.dropEvent.dataTransfer.getData(\"manifestIndex\")\r\n    }\r\n    );\r\n\r\n    const isOK = args.cell.Contents !== null && GameRules.canPlaceItemAtMapLocation(\r\n      {\r\n        atLocation: args.cell,\r\n        itemToCheck: args.cell.Contents.WorldObjectLabel,\r\n        map: this.props.countryMap\r\n      });\r\n\r\n    if (isOK) {\r\n\r\n      const newBase = MilitaryBaseFactory.getInstance().createNewBase(\r\n        {\r\n          baseType: (args.dropEvent.dataTransfer.getData(Constants.BASETYPE) as MilitaryBaseTypeLabels),\r\n          atLocation: args.cell\r\n        });\r\n\r\n      if (newBase) {\r\n        args.cell.placeItem({ itemToPlace: newBase });\r\n\r\n        notifyDragResultCallack(\r\n          {\r\n            result: {\r\n              didSucceed: true,\r\n              manifestIndex: parseInt(args.dropEvent.dataTransfer.getData(\"manifestIndex\")),\r\n              message: `${newBase.WorldObjectLabel} base ${newBase.Name} slated for construction.`\r\n            }\r\n          });\r\n\r\n          GameLogic.notifyNewBaseConstructed({forBaseType: newBase});\r\n\r\n      }\r\n      else {\r\n        notifyDragResultCallack(\r\n          {\r\n            result: {\r\n              didSucceed: true,\r\n              manifestIndex: parseInt(args.dropEvent.dataTransfer.getData(\"manifestIndex\")),\r\n              message: `unknown base type!.`\r\n            }\r\n          });\r\n      }\r\n    }\r\n    else {\r\n      console.log(`MapComponent: handleBuildDrop: You can't place an object there because of rules or it's not an empty location.`);\r\n      notifyDragResultCallack(\r\n        {\r\n          result: {\r\n            didSucceed: false,\r\n            manifestIndex: parseInt(args.dropEvent.dataTransfer.getData(\"manifestIndex\")),\r\n            message: \"You cannot build a base there because it is already occupied by another base or large population area.\"\r\n          }\r\n        });\r\n    }\r\n\r\n  }\r\n\r\n  private getMapLocationHtmlID(forMapLocation: MapLocation) {\r\n    return MapUtil.getMapLocationHtmlID(forMapLocation);\r\n  }\r\n\r\n}\r\n\r\n","export class BuildVersion { public static readonly BUILD_VERSION = \"56 at 12:47:29.88 on Fri 04/17/2020\"; } \r\n","import React, { Component } from 'react';\r\nimport { GameHeaderComponent } from \"./GameHeaderComponent\";\r\nimport { UserActionsComponent } from \"./UserActionsComponent\";\r\nimport { GameLogComponent } from \"./GameLogComponent\";\r\nimport { Grid, Paper, createMuiTheme, MuiThemeProvider } from '@material-ui/core';\r\nimport { Game } from '../Entities/gameEntity';\r\nimport { MapLocation } from '../Entities/MapObjects/MapLocation';\r\nimport { MapComponent } from './MapComponents/MapComponent';\r\nimport { BuildVersion } from '../Game/BuildVersion';\r\n\r\nexport interface playerMapClickListener {\r\n    handlePlayerMapClick: (args: { location: MapLocation }) => void;\r\n}\r\n\r\nexport class GameComponent extends Component {\r\n\r\n    componentDidMount() {\r\n\r\n        const gameEntity = Game.getInstance();\r\n\r\n        gameEntity.startGame();\r\n    }\r\n\r\n    private userActionsComponent: UserActionsComponent | null = null;\r\n\r\n    private registerMapListener(args: { forUserComponent: UserActionsComponent }) {\r\n        this.userActionsComponent = args.forUserComponent;\r\n    }\r\n\r\n    private playerMapClickListener(args: { location: MapLocation }) {\r\n        console.log(`Game.tsx: playerMapClickListener: player clicked on a map location:`, args.location);\r\n\r\n        if (this.userActionsComponent) { this.userActionsComponent.handlePlayerMapClick(args) }\r\n    }\r\n\r\n    render() {\r\n\r\n        const gameEntity = Game.getInstance();\r\n\r\n        const format1 = () => (\r\n            <React.Fragment>\r\n                <Grid item xs={12}>\r\n                    <GameHeaderComponent />\r\n                </Grid>\r\n\r\n                <Grid item xs={12}>\r\n                    <UserActionsComponent\r\n                        player={gameEntity.humanPlayer}\r\n                        mapClickListener={this.playerMapClickListener.bind(this)}\r\n                        registerMapListener={this.registerMapListener.bind(this)}\r\n                    />\r\n                </Grid>\r\n\r\n                <Grid item xs={6}>\r\n                    <MapComponent countryMap={gameEntity.humanPlayer.map} playerMapClickListener={this.playerMapClickListener.bind(this)} />\r\n                </Grid>\r\n                <Grid item xs={6}>\r\n                    <div className=\"xcomputerMapContainer\">\r\n                        <MapComponent countryMap={gameEntity.computerPlayer.map} />\r\n                    </div>\r\n                </Grid>\r\n                <Grid item xs={12}>\r\n                    <GameLogComponent />\r\n                </Grid>\r\n            </React.Fragment>\r\n\r\n        );\r\n\r\n        const format2 = () => (\r\n            <React.Fragment>\r\n                <Grid item xs={12}>\r\n                    <GameHeaderComponent />\r\n                </Grid>\r\n\r\n                <Grid item xs={4}>\r\n                    <Paper>\r\n                        Human<br />\r\n                        <MapComponent countryMap={gameEntity.humanPlayer.map} playerMapClickListener={this.playerMapClickListener.bind(this)} />\r\n                    </Paper>\r\n                </Grid>\r\n                <Grid item xs={4}>\r\n                    <UserActionsComponent\r\n                        player={gameEntity.humanPlayer}\r\n                        mapClickListener={this.playerMapClickListener.bind(this)}\r\n                        registerMapListener={this.registerMapListener.bind(this)}\r\n                    />\r\n                </Grid>\r\n\r\n                <Grid item xs={4}>\r\n                    <Paper>\r\n                        {gameEntity.computerPlayer.Name}<br />\r\n                        <MapComponent countryMap={gameEntity.computerPlayer.map} />\r\n                    </Paper>\r\n                </Grid>\r\n                <Grid item xs={12}>\r\n                    <GameLogComponent />\r\n                </Grid>\r\n            </React.Fragment>\r\n\r\n        );\r\n\r\n        const format3 = () => (\r\n            <Grid container className=\"gameDefaults gameContainer\" alignContent=\"center\">\r\n\r\n                <Grid item xs={12}>\r\n                    <GameHeaderComponent />\r\n                </Grid>\r\n\r\n                <Grid item xs={4} className=\"gameUILeftZone\">\r\n                    <Grid container alignContent=\"center\">\r\n                        <MapComponent countryMap={gameEntity.humanPlayer.map} playerMapClickListener={this.playerMapClickListener.bind(this)} />\r\n                    </Grid>\r\n                </Grid>\r\n                <Grid item xs={4} className=\"gameUIMiddleZone\">\r\n                    <UserActionsComponent\r\n                        player={gameEntity.humanPlayer}\r\n                        mapClickListener={this.playerMapClickListener.bind(this)}\r\n                        registerMapListener={this.registerMapListener.bind(this)}\r\n                    />\r\n                    <GameLogComponent />\r\n                </Grid>\r\n\r\n                <Grid item xs={4} className=\"gameUIRightZone\">\r\n                    <MapComponent countryMap={gameEntity.computerPlayer.map} />\r\n                </Grid>\r\n\r\n                <span className=\"gameBuildInformation\">\r\n                    Build version: {BuildVersion.BUILD_VERSION}\r\n                    <br/>\r\n                    View the source: <a href=\"https://github.com/pagalvin/rpsn5\" target=\"github\">https://github.com/pagalvin/rpsn5</a>\r\n                </span>\r\n            </Grid>\r\n\r\n        );\r\n\r\n        return format3();\r\n    }\r\n}\r\n","import React, { Component } from 'react';\r\nimport './App.css';\r\nimport { GameComponent } from './Components/Game';\r\nimport { Grid, Paper } from '@material-ui/core';\r\n\r\nclass App extends Component {\r\n\r\n  render() {\r\n\r\n    return (\r\n      <Paper>\r\n        <Grid container justify=\"center\"><GameComponent/></Grid>\r\n      </Paper>\r\n    );\r\n\r\n  }\r\n}\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read http://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\ntype Config = {\r\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\r\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\r\n};\r\n\r\nexport function register(config?: Config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(\r\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\r\n      window.location.href\r\n    );\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl: string, config?: Config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: http://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}